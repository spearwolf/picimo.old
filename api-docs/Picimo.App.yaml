---
  name: "Picimo.App"
  type: "programming-interface"
  interfaces:
    -
      name: "Picimo.App"
      description: |
        This is your starting point.

        Der Anfang von allem. Das ist der __Main Controller__ deiner App.
        Der einfachste Weg eine App Instanz zu erzeugen ist mittels

        `let app = new Picimo.App;`

        #### Options are optional

        Options werden einfach an den Constructor als erstes Argument überreicht ..

        `let app = new Picimo({ canvas: document.getElementById('myCanvas') });`

        #### Canvas Setup

        Picimo benötigt ein `<canvas>` Element zur Anzeige. Dieses kann mittels `canvas` option
        oder einfach als ersten Parameter an den Constructor übergeben werden.

        `let app = new Picimo.App(myCanvas/* , options */);`

        Wird kein Canvas angegeben, erzeugt die App instance einfach selbst einen eigenen Canvas.
        Dieser wird unterhalb `document.body` eingehängt oder alternativ kann der Container mit der Option `appendTo` bestimmt werden.

        Dieser automatisch erzeugte Canvas richtet seine Größe dynamisch an seinem Container Element (parentNode) aus.
        Der Container sollte also eine eigene Größe haben.

        Im Gegensatz dazu wird die Canvas Element Größe *niemals* von der App verändert,
        wenn ein schon bestehendes Canvas (zB. per `canvas` option) verwendet wird.

        #### Background (color/transparency)

        Mit der Option `alpha: true` kann ein transparenter Canvas erzeugt werden. Mit `backgroundColor` kann alternativ
        eine Hintergrundfarbe bestimmt werden.

        #### Events and State Changes

        While registering function callbacks with `app.on()` you can hook into the different app state changes
        (like *init*, *resize* or *renderFrame* .. )

        #### glx/gl/renderer states

        TODO

        #### assets/shader/texture/sprite factories/helpers

        TODO

        #### timing/frameNo state

        TODO

        #### scene graph root

        TODO

        #### plugin support

        - `App.on('create')`


      extends: Picimo.events.CustomEvent
      attributes:
        -
          name: "scene"
          type: "Picimo.graph.Scene"
          readonly: true
          description: "The *root* scene of the picimo scene graph."
        -
          separator: true
          title: time/frame info
        -
          name: "now"
          type: "number"
          description: "The number of seconds from application start."
          readonly: true
        -
          name: "frameNo"
          type: "number"
          description: "The current frame number."
          readonly: true
        -
          separator: true
          title: Factories and helpers
        -
          name: "spriteFactory"
          type: "Picimo.sprites.SpriteFactory"
          readonly: true
        -
          name: "texture"
          type: "Picimo.render.TextureManager"
          readonly: true
        -
          name: "shader"
          type: "Picimo.render.ShaderManager"
          readonly: true
        -
          name: "assetBaseUrl"
          type: "string"
          nullable: true
          description: |
            The base url for all assets. *Maybe* be undefined. The base url can be set via the __assetBaseUrl__
            *option* or via the global var `PICIMO_ASSET_BASE_URL` (will override the option).
            If unspecified the base url will be calculated from `locaation.href`
        -
          separator: true
          title: The webgl/rendering context
        -
          name: "canvas"
          type: "HTMLCanvasElement"
          readonly: true
          description: "The `<canvas>` dom element."
        -
          name: "backgroundColor"
          type: "Picimo.utils.Color"
          description: "The default background color is _black_ or if you set the __alpha__ option then _transparent_ is used."
        -
          name: "width"
          type: "number"
          readonly: true
          description: "The _device_ pixel width."
        -
          name: "height"
          type: "number"
          readonly: true
          description: "The _device_ pixel height."
        -
          name: "gl"
          type: "WebGlRenderingContext"
          description: "The webgl rendering context."
          readonly: true
        -
          name: "glx"
          type: "Picimo.render.WebGlContext"
          readonly: true
          description: "A thin wrapper around the WebGlRenderingContext."
        -
          name: "renderer"
          type: "Picimo.render.WebGlRenderer"
          readonly: true
          description: "The internal rendering context."


      functions:
        -
          separator: true
          title: "Texture helpers"
        -
          name: "loadTextureAtlas"
          args:
            -
              name: "url"
              type: "string"
          returns: "Promise<Picimo.core.TextureAtlas>"
        -
          name: "loadTexture"
          args:
            -
              name: "url"
              type: "string"
          returns: "Promise<Picimo.core.Texture>"
        -
          separator: true
          title: "URL helpers"
        -
          name: "getAssetUrl"
          args:
            -
              name: "url"
              type: "string"
          returns: "string"
        -
          name: "joinAssetUrl"
          args:
            -
              name: "baseUrl"
              type: "string"
            -
              name: "url"
              type: "string"
          returns: "string"
        -
          separator: true
          title: "sprites"
        -
          name: "defineSprite"
          args:
            -
              name: "constructor"
              type: "function"
            -
              name: "options"
              type: "object"
            -
              name: "proto"
              type: "object"
          returns: "Picimo.core.VertexObjectDescriptor"

      constructor:
        args:
          -
            name: "canvas"
            type: "HTMLCanvasElement"
            nullable: true
            optional: true
          -
            name: "options"
            type: "Picimo.App.Options"
            nullable: true
            optional: true

      events:
        -
          name: init
          description: |
            Will be called right after app creation time.
        -
          name: resize
          description: |
            Canvas resized.
        -
          name: frameBegin
          description: |
            The frame begins.
        -
          name: frame
          description: |
            On frame event. The renderer has been initialized,
            but this is before the scene graph is rendered.
        -
          name: renderFrame
          description: |
            On frame event. The renderer has been initialized
            and the scene graph is executed but the renderer is not yet finished,
            so this is the last call to create render commands if wanted.
        -
          name: frameEnd
          description: |
            The frame ends.

  dictionaries:
    -
      name: "Picimo.App.Options"
      attributes:
        -
          name: "alpha"
          type: "boolean"
          default: "false"
          required: false
        -
          name: "antialias"
          type: "boolean"
          default: "false"
        -
          name: "canvas"
          type: "HTMLCanvasElement"
          default: "null"
        -
          name: "appendTo"
          type: "HTMLElement"
          default: "null"
        -
          name: "bgColor"
          type:
            - "string"
            - "Picimo.utils.Color"
          default: "'#000000'"
        -
          name: "assetBaseUrl"
          type: "string"
          default: "null"

