!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Picimo=t.Picimo||{})}(this,function(t){"use strict";function e(t){function n(){return++h.lastCallbackId}function r(t,e){return t.prio!==e.prio?e.prio-t.prio:t.id-e.id}function i(t){if(t){var e=h.boundObjects.indexOf(t);return e===-1&&h.boundObjects.push(t),t}}function o(t,n,r){var i,o,a,u;for(o in r)r.hasOwnProperty(o)&&(a=n[o],"function"==typeof a&&(i=r[o],Array.isArray(i)?(u=i[0],i=i[1]):u=e.PRIO_DEFAULT,t.on(i,u,a)));return t}function l(t,n,r){function i(){var e,n,i;if(f)for(e=0;e<f;e++)n=h.boundObjects[e],i=n[t],"function"==typeof i?r(i,n):n[xe]&&r(null,n)}if(!(c.silenced||c.off.indexOf(t)>=0)){var o,a,u,s=h.callbacks[t],l=h.callbacks[_e],f=h.boundObjects.length,p=!1;if(s||l.length)for(s=s?s.concat(l):l,a=s.length,o=0;o<a;o++)u=s[o],!p&&u&&u.prio<e.PRIO_DEFAULT&&(i(),p=!0),n(u);p||i()}}if(t[xe])return t;var h={lastCallbackId:0,callbacks:{},boundObjects:[]};h.callbacks[_e]=[];var c=u({},{silenced:!1,off:[]});return s(t,xe,c),void 0===e.PRIO_DEFAULT&&u(e,{PRIO_MAX:Number.POSITIVE_INFINITY,PRIO_A:1e9,PRIO_B:1e7,PRIO_C:1e5,PRIO_DEFAULT:0,PRIO_LOW:-1e5,PRIO_MIN:Number.NEGATIVE_INFINITY}),t.on=function(t,i,o){var s=arguments.length;if(0===s)return void(c.silenced&&(a(c,"silenced",!1),c.off.length=0));var l;if(1===s){if("string"==typeof t)return l=c.off.indexOf(t),void(l>=0&&c.off.splice(l,1));if("object"!=typeof t&&"function"!=typeof t)return void(ye&&console.warn(be,".on() called with insufficient arguments!",arguments));o=t,t=_e,i=e.PRIO_DEFAULT}2===s&&(o=i,i=e.PRIO_DEFAULT);var f=h.callbacks,p=f[t]||(f[t]=[]),d=n(),v=u({},{id:d,fn:o,prio:"number"!=typeof i?e.PRIO_DEFAULT:i,isFunction:"function"==typeof o});return p.push(v),p.sort(r),d},t.once=function(n,r,i){var o=arguments.length;if(!o||o>3)return void(ye&&console.warn(be,".once() called with insufficient arguments!",arguments));1===o?(i=n,n=_e,r=e.PRIO_DEFAULT):2===o&&(i=r,r=e.PRIO_DEFAULT);var a=t.on(n,r,function(){var e=i.apply(this,arguments);return t.off(a),e});return a},t.off=function(t){if(0===arguments.length)return void(c.silenced||(a(c,"silenced",!0),c.off.length=0));if("string"==typeof t)return void(c.off.indexOf(t)===-1&&c.off.push(t));var e,n,r,i,o,u=h.callbacks,s="object"==typeof t;if("number"==typeof t||"function"==typeof t||s)for(o=Object.keys(u),r=0;r<o.length;r++)for(i=u[o[r]],n=0;n<i.length;n++)if(e=i[n],(e.id===t||e.fn===t)&&(i.splice(n,1),!s))return;s&&(n=h.boundObjects.indexOf(t),n>=0&&h.boundObjects.splice(n,1))},t.connect=function(t,e){var n=arguments.length;return 1===n?i(t):2===n?o(this,t,e):void(ye&&console.warn(be,".connect() called with insufficient arguments!",arguments))},t.emit=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var n,r,i,o=this;t.length>1&&"string"!=typeof t[0]&&"string"==typeof t[1]?(r=t.shift(),n=t.shift(),t[t.length-1]=r,i=t):(n=t.shift(),i=t.concat([o])),l(n,function(e){if(e.isFunction)e.fn.apply(o,t);else{var r=e.fn[n];"function"==typeof r?r.apply(e.fn,i):e.fn[xe]&&e.fn.emit.apply(e.fn,[n].concat(t))}},function(t,e){t?t.apply(e,i):e.emit.apply(e,[o,n].concat(i))})},t.emitReduce=function(){function t(t){void 0!==t&&(r=t)}for(var e=new Array(arguments.length),n=0;n<e.length;++n)e[n]=arguments[n];var r,i=e.shift();0===e.length?(r={},e.push(r)):t(e[0]);var o=this,a=[i].concat(e),u=e.concat([o]);return l(i,function(n){if(n.isFunction)e[0]=r,t(n.fn.apply(o,e));else{var s=n.fn[i];"function"==typeof s?(u[0]=r,t(s.apply(n.fn,u))):n.fn[xe]&&(a[1]=r,t(n.fn.emitReduce.apply(n.fn,a)))}},function(e,n){e&&(u[0]=r,t(e.apply(n,u)))}),r},t.from=function(t,e){var n=this;return new e(function(e){var r=n.on(t,function(t){e.next(t)});return function(){n.off(r)}})},t.subscribe=function(t,e,n,r){var i=this;return t.subscribe(function(t){i.emit(e,t)},n?function(t){i.emit(n,t)}:void 0,r?function(t){i.emit(r,t)}:void 0)},t}function n(t,n){var i=("string"==typeof t||"symbol"==typeof t)&&t||r(),o=e({}),u=!(!n||!n.replace),l=function(t){a(o,Me,t)},h=function(t){return function(e){t.apply(o,e)}}(o.emit);return s(o,"events",[]),a(o,"id",i),o.collect=function(){return o[Me]!==Fe&&l(Fe),o},o.emit=function(){var t,e=new Array(arguments.length);for(t=0;t<e.length;++t)e[t]=arguments[t];if(o[Me]===Se)h(e);else{if(u){var n,r=e[0];for(t=0,n=o.events.length;t<n;t++)if(o.events[t][0]===r)return void(o.events[t]=e)}o.events.push(e)}},o.play=function(){return o[Me]!==Se&&(l(Se),o.events.forEach(h),o.events.length=0),o},o.toggle=function(){return o[Me]!==Se?o.play():o.collect()},o.play()}function r(){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)});return ge?Symbol(t):t}function i(){return"undefined"!=typeof Symbol}function o(){return"undefined"!=typeof Map}function a(t,e,n){return Object.defineProperty(t,e,{value:n,configurable:!0,enumerable:!0}),t}function u(t,e){var n,r=Object.keys(e);for(n=r.length;n--;)a(t,r[n],e[r[n]]);return t}function s(t,e,n){return Object.defineProperty(t,e,{value:n,configurable:!0}),t}function l(t,e){return e={exports:{}},t(e,e.exports),e.exports}function h(t,e,n){return Object.defineProperty(t,e,{value:n,configurable:!0,enumerable:!0}),t}function c(t,e,n){return Object.defineProperty(t,e,{value:n,writable:!0}),t}function f(t,e,n){return Object.defineProperty(t,e,{value:n}),t}function p(t,e){for(var n in e)Object.hasOwnProperty.call(e,n)&&Object.defineProperty(t,n,{value:e[n],configurable:!0,enumerable:!0});return t}function d(t,e){for(var n in e)Object.hasOwnProperty.call(e,n)&&Object.defineProperty(t,n,{value:e[n]});return t}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";"userSelect"in t.style?t.style.userSelect=e:("webkitUserSelect"in t.style&&(t.style.webkitUserSelect=e),"mozUserSelect"in t.style&&(t.style.mozUserSelect=e),"msUserSelect"in t.style&&(t.style.msUserSelect=e))}function m(t,e,n){function r(n,r,i){var o=t[r];if(i||(i=r),"function"==typeof o){if(null!=e[i])throw new Error("delegateMethods() panic! could not override property "+i);e[i]=o.bind(t)}else if(n)throw new Error("delegateMethods() panic! "+r+" is not a function!")}if(Array.isArray(n))n.forEach(function(t){r(!0,t,t)});else if("string"==typeof n)r(!0,n);else if("object"===("undefined"==typeof n?"undefined":Ae(n)))Object.keys(n).forEach(function(t){r(!0,t,n[t])});else for(var i=Object.keys(t),o=Array.isArray(i),a=0,i=o?i:i[Symbol.iterator]();;){var u;if(o){if(a>=i.length)break;u=i[a++]}else{if(a=i.next(),a.done)break;u=a.value}var s=u;r(!1,s)}}function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,c=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,d=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1,m=arguments.length>16&&void 0!==arguments[16]?arguments[16]:Be,g=m||function(t){return t+""};return"mat4("+g(t)+", "+g(e)+", "+g(n)+", "+g(r)+", "+g(i)+", "+g(o)+", "+g(a)+", "+g(u)+", "+g(s)+", "+g(l)+", "+g(h)+", "+g(c)+", "+g(f)+", "+g(p)+", "+g(d)+", "+g(v)+")"}function y(t,e){if(Ne(t)&&Ne(e))return t*e;if(Ne(t))switch(t){case 0:return 0;case 1:return e;default:return t+" * "+e}else{if(!Ne(e))return t+" * "+e;switch(e){case 0:return 0;case 1:return t;default:return t+" * "+e}}}function x(t,e){if(Ue(t)&&Ue(e))return t+e;if(Ue(t))switch(t){case 0:return e;default:return t+" + "+e}else{if(!Ue(e))return t+" + "+e;switch(e){case 0:return t;default:return t+" + "+e}}}function _(t,e){if(ke(t)&&ke(e))return t-e;if(ke(t))switch(t){case 0:return"-"+e;default:return t+" - "+e}else{if(!ke(e))return t+" - "+e;switch(e){case 0:return t;default:return t+" - "+e}}}function b(t){return"return "+t+";"}function M(t){return t.setValue=function(t,e){var n=null!=t.serial;e&&console.log("setValue(): hasSerial=",n,"valueChanged=",this.valueChanged,"val!==this.value",t!==this.value,"val.serial=",t.serial,"this.valueSerial=",this.valueSerial,"val.serial!==this.valueSerial=",t.serial!==this.valueSerial),this.valueChanged||(this.valueChanged=t!==this.value,!this.valueChanged&&n&&(this.valueChanged=t.serial!==this.valueSerial)),n&&(this.valueSerial=t.serial),this.value=t},t.value=null,t.valueSerial=0,t.valueChanged=!1,t}function S(t){t.info.type===t.program.glx.gl.SAMPLER_2D?(t.isSampler2d=!0,t._texUnit=-1,Object.defineProperties(t,{texUnit:{get:function(){return this._texUnit},set:function(t){this._texUnit!==t&&(this._texUnit=t,this.valueChanged=!0)}}})):t.isSampler2d=!1}function F(t,e,n){this.program=t,this.glProgram=e,this.glx=n,w(this),Object.freeze(this)}function w(t){var e=t.glx.gl,n=e.getProgramParameter(t.glProgram,e.ACTIVE_UNIFORMS);t.uniformNames=[],t.uniform={};var r,i;for(r=0;r<n;++r)i=e.getActiveUniform(t.glProgram,r),t.uniform[i.name]=new Xe(t,i),t.uniformNames.push(i.name);Object.freeze(t.uniform);var o=e.getProgramParameter(t.glProgram,e.ACTIVE_ATTRIBUTES);t.attribNames=[],t.attrib={};var a;for(r=0;r<o;++r)a=e.getActiveAttrib(t.glProgram,r),t.attrib[a.name]=new He(t,a),t.attribNames.push(a.name);Object.freeze(t.attrib)}function D(t){var e=function(){},n=!1,r=e;return Object.defineProperties(t,{ready:{get:function(){return n},set:function(t){!n&&t?(n=!0,r()):n&&!t&&console.error("Oops.. readyPromise transition true => false")},enumerable:!0},promise:{value:new Promise(function(i){var o=i.bind(t,t);n?o():r=function(){r=e,o()}}),enumerable:!0}}),t}function I(t){for(var e=1;t>e;)e<<=1;return e}function A(t){return 0!==t&&0===(t&t-1)}function E(t,e){t._domElement=e,t.image=e?R(e):null,t.ready=!!e}function R(t){if(A(t.width)&&A(t.height))return t;var e=I(t.width),n=I(t.height),r=document.createElement("canvas");return r.width=e,r.height=n,r.getContext("2d").drawImage(t,0,0),r}function P(t){return"string"==typeof t?JSON.parse(t):t}function C(t,e){return void 0!==t.imageUrl?t.imageUrl:t.app.joinAssetUrl(t.url,e)}function T(t){this.texture=new rn,this.texture.width=t.meta.size.w,this.texture.height=t.meta.size.h,this.texture.image=new en(this.app).load(C(this,t.meta.image)),this.frameNames=[],this.frames=new Map;var e,n;for(e in t.frames)t.frames.hasOwnProperty(e)&&(this.frameNames.push(e),n=t.frames[e].frame,this.frames.set(e,new rn(this.texture,n.x,n.y,n.w,n.h)))}function O(t,e){if(void 0===this.descriptor){var n=t?t:e?e.descriptor:null;if(!n)throw new Error("VertexObject#descriptor is null!");f(this,"descriptor",n);var r=e?e:t.createVertexArray();if(c(this,"vertexArray",r),this.descriptor!==this.vertexArray.descriptor&&(this.descriptor.vertexCount!==this.vertexArray.descriptor.vertexCount||this.descriptor.vertexAttrCount!==this.vertexArray.descriptor.vertexAttrCount))throw new Error("Incompatible vertex object descriptors!")}}function z(t,e,n,r,i){this.vertexObjectConstructor=j(t),this.vertexObjectConstructor.prototype=Object.create(O.prototype),this.vertexObjectConstructor.prototype.constructor=this.vertexObjectConstructor,this.vertexCount=parseInt(e,10),this.vertexAttrCount=parseInt(n,10),this.attr={};var o,a,u;if(Array.isArray(r)){for(o=0,u=0;u<r.length;++u){if(a=r[u],void 0===a.size)throw new Error("vertex object attribute descriptor has no size property!");void 0!==a.name&&(this.attr[a.name]=new B(a.name,a.size,o,!!a.uniform,a.attrNames)),o+=a.size}if(o>this.vertexAttrCount)throw new Error("vertexAttrCount is too small (offset="+o+")")}var s;if(void 0!==i)for(s in i)i.hasOwnProperty(s)&&(a=i[s],"string"==typeof a?(a=this.attr[a],void 0!==a&&(this.attr[s]=a)):this.attr[s]=new B(s,a.size,a.offset,!!a.uniform,a.attrNames));this.propertiesObject={};for(s in this.attr)this.attr.hasOwnProperty(s)&&(a=this.attr[s],a.defineProperties(s,this.propertiesObject,this));this.vertexObjectPrototype=Object.create(this.vertexObjectConstructor.prototype,this.propertiesObject),Object.freeze(this.attr),Object.freeze(this)}function j(t){return"function"==typeof t?t.name?t:function(){return t.call(this)}:function(){}}function B(t,e,n,r,i){this.name=t,this.size=e,this.offset=n,this.uniform=r,this.attrNames=i,Object.freeze(this)}function N(t){return function(e){return this.vertexArray.vertices[t+e]}}function U(t,e,n,r){return function(){var i=this.vertexArray.vertices,o=void 0,a=void 0;for(o=0;o<e;++o)for(a=0;a<t;++a)i[o*n+r+a]=arguments[a]}}function k(t){return function(){return this.vertexArray.vertices[t]}}function L(t,e,n,r){return function(){var i=this.vertexArray.vertices,o=void 0,a=void 0;for(o=0;o<e;++o)for(a=0;a<t;++a)i[o*n+r+a]=arguments[o*t+a]}}function W(t,e,n){return function(r){for(var i=this.vertexArray.vertices,o=0;o<t;++o)i[o*e+n]=r}}function G(t){return t[0].toUpperCase()+t.substr(1)}function V(t,e,n){p(this,{descriptor:t,capacity:e,vertexArray:n?n:t.createVertexArray(e),ZERO:t.create(),NEW:t.create()}),Y(this)}function Y(t){t.availableVOs=[];var e,n,r;for(r=0;r<t.capacity;r++)e=t.vertexArray.subarray(r),n=t.descriptor.create(e),n.destroy=t.free.bind(t,n),t.availableVOs.push(n);t.usedVOs=[]}function q(t,e){return"string"==typeof e?e:"function"==typeof e?e(t):Array.isArray(e)?Ke.map(e,q.bind(null,t)).join("\n"):e+""}function H(t,e,n){this.glx=t,this.width=0,this.height=0,this.isFlipY=e===!0,this.isRepeatable=n===!0,this.image=null,X(this),Object.seal(this)}function X(t){t.glId=0,t.needsInit=!0,t.needsConf=!0,t.needsUpload=!0,t.texUnit=-1}function $(t){t.needsInit&&(t.glId=t.glx.gl.createTexture(),t.needsInit=!1)}function Z(t){if(t.glId||$(t),t.needsConf&&t.canConf){t.bind();var e=t.glx.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.isFlipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);var n=t.isRepeatable?e.REPEAT:e.CLAMP_TO_EDGE;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,e.UNSIGNED_BYTE,null),t.needsConf=!1}}function Q(t){var e=t.gl;p(t,{MAX_TEXTURE_SIZE:e.getParameter(e.MAX_TEXTURE_SIZE),MAX_TEXTURE_IMAGE_UNITS:e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)})}function K(t){t.OES_element_index_uint=t.gl.getExtension("OES_element_index_uint"),t.OES_element_index_uint||console.error("WebGL don't support the OES_element_index_uint extension!")}function J(t,e){var n,r,i,o,a,u,s=t.app.gl,l=t.program,h=!1;t.currentProgram&&t.currentProgram===l||(t.currentProgram=l,l.use(),h=!0);var c;for(i=0,o=l.uniformNames.length;i<o;i++){a=l.uniformNames[i],u=t.program.uniform[a],c=t.uniforms.get(a),null!=c&&(c=c.value),t.debugOutFrame&&(console.groupCollapsed("%cuniform","font-weight:bold;color:#26f",a),console.debug("value",c),console.debug("program->uniform",u),console.debug("renderer->uniformStack",t.uniforms.get(a)));try{u.setValue(c,t.debugOutFrame)}catch(e){t.debugOutFrame&&(console.error("uniform.setValue panic!",e),console.debug("name",a,"value",c),console.debug(".. program->uniform",u),console.debug(".. renderer->uniformStack",t.uniforms.get(a)))}t.debugOutFrame&&(h&&console.log("programChanged",h),console.groupEnd(a)),h&&(u.valueChanged=!0);try{u.upload(s)}catch(e){t.debugOutFrame&&console.error("[draw_elements] uniform upload panic:",a,u)}}for(i=0,o=l.attribNames.length;i<o;i++)a=l.attribNames[i],n=t.program.attrib[a],n.setValue(t.attributes.get(a)),h&&(n.valueChanged=!0),n.upload(s);r=e.elementType||s.TRIANGLES,e.buffer.bindBuffer().drawElements(r,e.count,e.offset)}function tt(t,e){var n;void 0!==e.blendMode&&(e.blendMode===!1?n=t.defaultBlendMode:null!=e.blendMode&&(n=e.blendMode),t.activateBlendMode(n)),void 0!==e.renderToTexture&&(e.renderToTexture!==!1?(t.renderToTexture=e.renderToTexture,t.renderToTexture.activate()):(t.renderToTexture.deactivate(),t.renderToTexture=null));var r,i;if(e.uniforms)for(r in e.uniforms)e.uniforms.hasOwnProperty(r)&&(i=t.uniforms.get(r),i||(i=new dn,t.uniforms.set(r,i)),i.exec(e.uniforms[r]));if(e.attributes)for(r in e.attributes)e.attributes.hasOwnProperty(r)&&t.attributes.set(r,e.attributes[r]);var o;if(e.program&&"string"==typeof e.program){if(o=t.app.getProgram(e.program),!o)return void et("unknown program:",e.program);t.program=t.app.glx.glProgram(o)}e.drawElements&&J(t,e.drawElements)}function et(){console.warn.apply(console,["[Picimo.render.WebGlRenderer#renderCommand]"].concat(Array.prototype.slice.apply(arguments)))}function nt(t){var e=t.app.gl,n=t.app.backgroundColor;e.clearColor(n.getRed(),n.getGreen(),n.getBlue(),n.getAlpha()),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function rt(t){t.cmdQueue.clear(),t.currentPipeline=null,t.renderToTexture=null,t.currentProgram=null,t.debugOutFrame=120===t.app.frameNo}function it(t){t.cmdQueue=new pn,t._renderCmd=null,t.uniforms=new Map,t.attributes=new Map,t.program=null,t.currentProgram=null,t.currentPipeline=null,t.defaultBlendMode=t.app.getBlendMode("default"),t.currentBlendMode=null,t.renderToTexture=null,t.debugOutFrame=!1}function ot(t){t.pipeline=new Map,t.pipelines=[]}function at(t){lt(t,"finish"),t.debugOutFrame&&(console.groupCollapsed("Picimo.render.WebGlRenderer Command Queue ("+t.cmdQueue.length+")"),st(t)),ut(t),t.debugOutFrame&&(console.debug("WebGlRenderer",t),console.groupEnd())}function ut(t){var e=t._renderCmd;e||(e=t._renderCmd=tt.bind(t,t)),t.cmdQueue.forEach(e)}function st(t){t.cmdQueue.forEach(function(t){"id"in t?console.debug("cmd{"+t.id+"}",t):console.debug("cmd",t)})}function lt(t,e){var n,r,i;for(n=t.pipelines.length;n--;)r=t.pipelines[n],i=r[e],i&&i.call(r)}function ht(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bn,i=r.createDescriptor(t,e.constructor,e.vertexCount,e.vertexAttrCount,e.attributes,e.aliases);return n&&Object.assign(i.proto,n),i}function ct(t,e,n){return{isDrag:e,translateX:t.movementX*n,translateY:-t.movementY*n}}function ft(t){t.picimo.canvas.addEventListener("contextmenu",pt,!1),t.picimo.canvas.addEventListener("mousedown",t.mouseDown.bind(t),!1),document.addEventListener("mousemove",t.mouseMove.bind(t),!1),document.addEventListener("mouseup",t.mouseUp.bind(t),!1),document.addEventListener("mousewheel",t.mouseWheel.bind(t),!1)}function pt(t){return t.preventDefault(),!1}function dt(t){return this instanceof dt?(this.value=0|t,void Object.seal(this)):new dt(t)}function vt(t,e){var n=!!e,r=null;Object.defineProperty(t,"readyFunc",{get:function(){return r},set:function(t){r=t===!1?function(){return!1}:t===!0?null:"function"==typeof t?t:null}}),Object.defineProperty(t,"ready",{get:function(){return n&&this.state.isNot(dt.ERROR|dt.DESTROYED)&&(null===r||!!r())},set:function(t){n=!!t}})}function mt(t,e){return Number(isNaN(t)?isNaN(e)?0:e:t)}function gt(t,e){return"boolean"==typeof t?t:void 0===t?!!e:!!t}function yt(t,e){return null!=t?String(t):e}function xt(t,e){var n=mt(e,Tn);Object.defineProperty(t,"renderPrio",{get:function(){return n},set:function(t){var e=mt(t,Tn);e!==n&&(n=e,this.parentNode&&this.parentNode.emit("childrenUpdated"))},enumerable:!0})}function _t(){if(!this.state.is(dt.DESTROYED)){for(var t=0;t<this.children.length;++t)this.children[t].destroy();if(this.initGlDone)try{this.emit("destroyGl")}catch(t){console.error("[destroyGl]",t)}if(this.initDone)try{this.emit("destroy")}catch(t){console.error("[destroy]",t)}this.state.set(dt.DESTROYED),this.parentNode&&this.parentNode.removeChild(this)}}function bt(){if(this.ready&&!this.state.is(dt.DESTROYED)&&(this.state.is(dt.CREATE)&&Mt(this),this.state.is(dt.READY)&&this.display)){try{this.emit("frame"),this.emit("renderFrame")}catch(t){return console.error("[frame,renderFrame]",t),void(this.ready=!1)}for(var t=0;t<this.children.length;++t)this.children[t].renderFrame();try{this.emit("frameEnd")}catch(t){console.error("[frameEnd]",t),this.ready=!1}}}function Mt(t){t.state.set(dt.INIT);var e=[];try{t.emit("init",wt(e,t)),Promise.all(e).then(St.bind(t,t),Dt.bind(t,t))}catch(t){console.error("[init]",t),this.ready=!1}}function St(t){if(h(t,"initDone",!0),t.ready){var e=[];try{t.emit("initGl",wt(e,t)),Promise.all(e).then(Ft.bind(t,t),Dt.bind(t,t))}catch(t){console.error("[initGl]",t),this.ready=!1}}}function Ft(t){h(t,"initGlDone",!0),t.ready&&t.state.set(dt.READY)}function wt(t){return function(e){e&&("function"==typeof e&&(e=new Promise(e)),t.push(e))}}function Dt(t){t.ready&&t.state.set(dt.ERROR)}function It(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)throw new Error("[Picimo.graph.Node] app should not be undefined!");h(this,"app",t),this.name=yt(e.name),this.state=new dt(dt.CREATE),this.display=gt(e.display,!0),vt(this,e.ready!==!1),Object.defineProperties(this,{initDone:{value:!1,configurable:!0,enumerable:!0},initGlDone:{value:!1,configurable:!0,enumerable:!0}}),xt(this,e.renderPrio),At(this,e.parentNode),this.children=[],we(this),this.on("childrenUpdated",we.PRIO_MAX,Et),this.connect(e,{onInit:"init",onInitGl:"initGl",onFrame:"frame",onRenderFrame:"renderFrame",onFrameEnd:"frameEnd",onDestroyGl:"destroyGl",onDestroy:"destroy",onChildrenUpdated:"childrenUpdated"})}function At(t,e){Object.defineProperty(t,"parentNode",{value:e instanceof It?e:null,configurable:!0})}function Et(){this.children=this.children.sort(Rt)}function Rt(t,e){return-t.renderPrio- -e.renderPrio}function Pt(t,e,n){var r=t.parentNode,i=t.texture;t.sprite.tx=e+(zn(t.posX,r.width,i.width,i.height,r.width,r.height)||0),t.sprite.ty=n+(zn(t.posY,r.height,i.width,i.height,r.width,r.height)||0)}function Ct(t){t.webGlBuffer||(t.webGlBuffer=mn.fromVertexArray(t.app.glx,t.pool.descriptor,{drawType:t.app.gl.DYNAMIC_DRAW,vertexArray:t.pool.vertexArray}),t.indexArray=un.Generate(t.pool.capacity,[0,1,2,0,2,3]),t.webGlIndexBuffer=mn.fromVertexIndexArray(t.app.glx,t.indexArray))}function Tt(t){t.renderCmd||(t.renderCmd=new Bn(function(){var e,n={program:t.program,uniforms:{tex:t.webGlTexture},attributes:{},drawElements:{buffer:t.webGlIndexBuffer,elementType:t.app.gl.TRIANGLES,count:0,offset:0}},r=t.pool.descriptor.attr;for(e in r)r.hasOwnProperty(e)&&(n.attributes[e]={offset:r[e].offset,size:r[e].size,stride:t.pool.descriptor.vertexAttrCount,buffer:t.webGlBuffer});return Object.seal(n),n}))}function Ot(t){t.webGlBuffer||(t.webGlBuffer=mn.fromVertexArray(t.app.glx,t.pool.descriptor,{drawType:t.app.gl.DYNAMIC_DRAW,vertexArray:t.pool.vertexArray}),t.indexArray=un.Generate(t.pool.capacity,[0,1,2,0,2,3]),t.webGlIndexBuffer=mn.fromVertexIndexArray(t.app.glx,t.indexArray))}function zt(t){if(!t.renderCmd){t.renderCmd={program:t.program,uniforms:{tex:t.app.textureManager.findOrCreateWebGlTexture(t.texture)},attributes:{},drawElements:{buffer:t.webGlIndexBuffer,elementType:t.app.gl.TRIANGLES}};var e,n=t.pool.descriptor.attr;for(e in n)n.hasOwnProperty(e)&&(t.renderCmd.attributes[e]={offset:n[e].offset,size:n[e].size,stride:t.pool.descriptor.vertexAttrCount,buffer:t.webGlBuffer});Object.seal(t.renderCmd)}}function jt(t){t.pipeline||Bt(t)}function Bt(t){var e=t.app.renderer.filterPipelineByInstanceof(Nn),n=t.sprite.descriptor,r=t.texture,i=t.program;if(e=Ke.filter(e,function(t){return t.texture===r}),e=Ke.filter(e,function(t){return t.program===i}),e=Ke.filter(e,function(t){return t.pool.descriptor===n}),e=Ke.filter(e,function(t){return t.pool.availableCount}),!e.length){var o=new V(n,Nn.DEFAULT_CAPACITY),a=new Nn(t.app,o,r,i);e.push(a),a.onInitGl(),t.app.renderer.addPipeline(a)}t.pipeline=e[0],t.pipelineSprite=t.pipeline.pool.alloc()}function Nt(t){jn(t),t.pipeline.render(t.sprite)}function Ut(t,e){t.texture=null,t.readyFunc=!1,Promise.resolve(e.promise||e).then(function(e){return t.texture=e,t.texture.setTexCoords(t.sprite),e.image.promise}).then(function(){t.readyFunc=!0})}function kt(t){var e=t.dimension,n=t.ctx;t.clearColor?(n.fillStyle=t.clearColor,n.fillRect(e.x,e.y,e.width,e.height)):n.clearRect(e.x,e.y,e.width,e.height)}function Lt(t,e,n){Object.defineProperties(t,{canvas:{value:e,enumerable:!0},ctx:{value:e.getContext("2d",{alpha:n}),enumerable:!0}})}function Wt(t){if("number"==typeof t.canvasSize)return new tn(0,0,parseInt(t.canvasSize,10),parseInt(t.canvasSize,10));if(Array.isArray(t.canvasSize))return new tn(0,0,parseInt(t.canvasSize[0],10),parseInt(t.canvasSize[1],10));if("object"===Ae(t.canvasSize))return new tn(parseInt(t.canvasSize.x,10),parseInt(t.canvasSize.y,10),parseInt(t.canvasSize.width,10),parseInt(t.canvasSize.height,10));if(t.canvas)return new tn(0,0,t.canvas.width,t.canvas.height);throw new Error("Picimo.graph.Canvas panic! couldn't determinate canvas size!")}function Gt(t){var e=document.createElement("canvas");return e.width=I(t.x+t.width),e.height=I(t.y+t.height),e}function Vt(t,e){var n=rn.fromCanvas(t);return(e.x||e.y||e.width!==n.width||e.height!==n.height)&&(n=new rn(n,e.x,e.y,e.width,e.height)),n}function Yt(t,e){void 0===e&&(e={}),It.call(this,t,e),Xt(this,e.textureAtlas),this.program=e.program||"picimo.sprite",this.spriteDescriptor=t.spriteFactory.getDescriptor(e.sprites||"default"),this.pipeline=null,this.defaultSpriteWidth=e.defaultWidth||0,this.defaultSpriteHeight=e.defaultHeight||e.defaultWidth,qt(this,this.spriteDescriptor,e.capacity||1e3),this.on("initGl",$t.bind(this,this)),this.on("renderFrame",Zt.bind(this,this))}function qt(t,e,n){t.pool=new V(e,n);var r=t.pool.NEW;e.hasAttribute("scale",1)?r.scale=1:e.hasAttribute("scale",2)&&r.setScale(1,1),e.hasAttribute("opacity")&&(r.opacity=1),Ht(t)}function Ht(t){t.hasDefaultSpriteSize&&t.pool.NEW.setSize(t.defaultSpriteWidth,t.defaultSpriteHeight)}function Xt(t,e){t.textureAtlas=null,t.readyFunc=!1,Promise.resolve(e).then(function(e){return t.textureAtlas=e,e.promise}).then(function(t){return t.texture.image.promise}).then(function(){t.readyFunc=!0})}function $t(t){t.pipeline=new Un(t.app,t.program,t.pool,t.textureAtlas),t.pipeline.onInitGl(),t.app.renderer.addPipeline(t.pipeline)}function Zt(t){t.pipeline.render()}function Qt(t,e,n){return e.appendChild(t),n&&t.connect(n),t}function Kt(){this.hasOwnProjection&&(ne(this),le(this)),ee(this),te(this)}function Jt(){this.app.renderer.addRenderCommand(this.renderPostCmd,null)}function te(t){var e=t.renderCmd;e.uniforms.renderPrio=t.renderPrio,t.app.renderer.addRenderCommand(e,null)}function ee(t){var e=t.width,n=t.height,r=t.pixelRatio,i=t.renderCmd.uniforms;e===t.prevWidth&&n===t.prevHeight&&r===t.prevPixelRatio||(t.prevWidth=e,t.prevHeight=n,t.prevPixelRatio=r,i.sceneInfo[0]=t.width,i.sceneInfo[1]=t.height,i.sceneInfo[2]=t.pixelRatio,t.emit("resize",e,n,r))}function ne(t){var e=t.scene||t.app;e.width===t.parentResolution.width&&e.height===t.parentResolution.height&&e.pixelRatio===t.parentResolution.pixelRatio&&e.devicePixelRatio===t.parentResolution.devicePixelRatio||(t.parentResolution.width=t.parentResolution.width,t.parentResolution.height=t.parentResolution.height,t.parentResolution.pixelRatio=t.parentResolution.pixelRatio,t.parentResolution.devicePixelRatio=t.parentResolution.devicePixelRatio,t.projectionNeedsUpdate=!0)}function re(){var t=this,e=t.rootRenderCmd.uniforms,n=t.app;e.iGlobalTime=n.now,e.iFrameNo=n.frameNo,e.iResolution[0]=n.width,e.iResolution[1]=n.height,n.renderer.addRenderCommand(t.rootRenderCmd)}function ie(t){t.transform=new pr,t.viewMatrixUniform=new mr(!0,oe.bind(null,t,new pr)),t.hasOwnProjection&&t.on("init",we.PRIO_A,function(){this.projectionNeedsUpdate=!0,le(this)})}function oe(t,e,n){return!n||t.hasOwnProjection?t.computeViewMatrix(e):e.multiply(n,t.transform),e}function ae(t){p(t,{projection:null,hasOwnProjection:!1,projectionNeedsUpdate:!1}),Object.defineProperties(t,{width:{get:function(){var t=this.scene;return t?t.width:this.app.width},enumerable:!0},height:{get:function(){var t=this.scene;return t?t.height:this.app.height},enumerable:!0},pixelRatio:{get:function(){var t=this.scene;return t?t.pixelRatio:this.app.devicePixelRatio},enumerable:!0},devicePixelRatio:{get:function(){var t=this.scene;return t?t.devicePixelRatio:this.app.devicePixelRatio},enumerable:!0}})}function ue(t){t.rootRenderCmd={uniforms:{iGlobalTime:0,iFrameNo:0,iResolution:[0,0]}},t.on("frame",re)}function se(t,e){p(t,{projection:new pr,hasOwnProjection:!0}),t.projectionNeedsUpdate=!0,t._desiredPixelRatio=e.pixelRatio?parseFloat(e.pixelRatio):t.isRootNode?1:0,t._desiredWidth=e.width?parseFloat(e.width):0,t._desiredHeight=e.height?parseFloat(e.height):0,Object.defineProperties(t,{width:{get:function(){return this._computedWidth?this._computedWidth:this._desiredWidth},set:function(t){var e=parseFloat(t);this._desiredWidth!==e&&(this._desiredWidth=e,e&&(this._desiredPixelRatio=0),this.projectionNeedsUpdate=!0)},enumerable:!0},height:{get:function(){return this._computedHeight?this._computedHeight:this._desiredHeight},set:function(t){var e=parseFloat(t);this._desiredHeight!==e&&(this._desiredHeight=e,e&&(this._desiredPixelRatio=0),this.projectionNeedsUpdate=!0)},enumerable:!0},pixelRatio:{get:function(){if(this._computedPixelRatio)return this._computedPixelRatio;if(this._desiredPixelRatio)return this._desiredPixelRatio;var t=this.scene;return t?t.pixelRatio:0},set:function(t){var e=parseFloat(t);this._desiredPixelRatio!==e&&(this._desiredPixelRatio=e,e&&(this._computedPixelRatio=0,this._desiredWidth=0,this._desiredHeight=0),this.projectionNeedsUpdate=!0)},enumerable:!0},sizeFit:{get:function(){return this._sizeFit},set:function(t){var e="cover"===t?"cover":"contain";this._sizeFit!==e&&(this._sizeFit=e,this.projectionNeedsUpdate=!0)},enumerable:!0}}),le(t)}function le(t){if(t.hasOwnProjection&&t.projectionNeedsUpdate){var e;if(t._desiredWidth||t._desiredHeight){var n=t.app.height/t.app.width,r=t._desiredHeight/t._desiredWidth,i=t._desiredWidth&&t._desiredHeight&&"cover"===t.sizeFit;!t._desiredWidth&&t._desiredHeight||n<r?(t._computedWidth=t._desiredHeight/t.app.height*t.app.width,t._computedHeight=t._desiredHeight,i&&(e=t._desiredWidth/t._computedWidth,t._computedWidth*=e,t._computedHeight*=e)):t._desiredWidth&&!t._desiredHeight||n>r?(t._computedWidth=t._desiredWidth,t._computedHeight=t._desiredWidth/t.app.width*t.app.height,i&&(e=t._desiredHeight/t._computedHeight,t._computedWidth*=e,t._computedHeight*=e)):(t._computedWidth=t._desiredWidth,t._computedHeight=t._desiredHeight),t._computedPixelRatio=t.app.width/t._computedWidth/t.app.devicePixelRatio}else if(t._desiredPixelRatio){var o=t.scene,a=o?o:t.app,u=o?o.pixelRatio:t.app.devicePixelRatio;e=t._desiredPixelRatio*u,t._computedWidth=a.width/e,t._computedHeight=a.height/e}t.devicePixelRatio=t.app.width/t._computedWidth,t.projectionNeedsUpdate=!1,t.projection.ortho(t.width,t.height),t.emit("projectionUpdated",t.projection)}}function he(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};It.call(this,t,e),this._sizeFit="cover"===e.sizeFit?"cover":"contain",e.projection?se(this,e):ae(this),ie(this),this.prevWidth=null,this.prevHeight=null,this.prevPixelRatio=null,this.parentResolution={width:null,height:null,pixelRatio:null,devicePixelRatio:null},this.renderCmd={uniforms:{sceneInfo:[0,0,0],viewMatrix:this.viewMatrixUniform}},this.renderPostCmd={uniforms:{viewMatrix:this.renderCmd.uniforms.viewMatrix.restoreCmd}},this.blendMode=e.blendMode,this.hasOwnProjection&&(this.renderCmd.uniforms.projectionMatrix=new mr(!0,this.projection),this.renderPostCmd.uniforms.projectionMatrix=this.renderCmd.uniforms.projectionMatrix.restoreCmd),this.isRootNode&&ue(this),this.on("frame",Kt),this.on("frameEnd",Jt),this.connect(e,{onResize:"resize",onProjectionUpdated:"projectionUpdated"
})}function ce(t){return"/"===t[t.length-1]?t:_r.exec(t)[1]}function fe(t){var e;return e=void 0===this.assetBaseUrl?t:yr.test(t)?"/"===t[0]&&"/"===this.assetBaseUrl[this.assetBaseUrl.length-1]?this.assetBaseUrl+t.substr(1):this.assetBaseUrl+t:t}function pe(t,e){return xr.test(e)?e:this.getAssetUrl(ce(t?t:this.assetBaseUrl)+e)}function de(t){return new on(this).load(t).promise}function ve(t){var e=new en(this).load(t),n=new rn;return n.image=e,e.promise.then(function(){return n})}var me=o(),ge=i(),ye="undefined"!=typeof console,xe=ge?function(){return Symbol.eventize||(Symbol.eventize=Symbol("eventize")),Symbol.eventize}():"@@eventize",_e="*",be="[eventize.js]";e.is=function(t){return!(!t||!t[xe])},s(e,"EventizeNamespace",xe),s(e,"queues",me?new Map:{}),e.queue=function(t){var r,i,o=arguments.length;return o>=1&&("object"==typeof t&&2!==o||(r=me?e.queues.get(t):e.queues[t]),2===o?i=arguments[1]:1===o&&"object"==typeof t&&(i=t)),r||(r=n(t,i),me?e.queues.set(r.id,r):e.queues[r.id]=r),r};var Me="state",Se="play",Fe="collect",we=e,De="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ie=l(function(t){if("undefined"==typeof e)var e={};e.brehaut||(e.brehaut={}),function(){function t(t,e){t=t.toString();for(var n=[],r=0,i=Math.max(e-t.length,0);r<i;r++)n.push("0");return n.push(t),n.join("")}function n(t){return t.slice(0,1).toUpperCase()+t.slice(1)}function r(t){return t.replace(/^\s+|\s+$/g,"")}function i(t){return function(){var e=this.clone();return t.apply(e,arguments),e}}function o(t,e){function r(t){return function(){return t.apply(this[s](),arguments)}}function i(){}function o(){return new i}var a=x(c),u=[],s="to"+n(t);for(var l in e)if(e.hasOwnProperty(l)){a[l]=e[l];var h=a[l];if("_"==l.slice(0,1))continue;if(l in c||"function"!=typeof h){if("function"!=typeof h){u.push(l);var f="get"+n(l),p="set"+n(l);c[f]=r(a[f]=function(t){return function(){return this[t]}}(l)),c[p]=r(a[p]=function(t){return function(e){var n=this.clone();return n[t]=e,n}}(l))}}else c[l]=r(h)}return i.prototype=a,y[t]=o,a.clone=function(){for(var t=o(),e=0,n=u.length;e<n;e++){var r=u[e];t[r]=this[r]}return t},c[s]=function(){return o()},g.push(a),a}function a(t){return c.fromObject(t)}var u={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370D8",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#D87093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},s="(?:\\+|-)?\\d+",l="(?:\\+|-)?\\d*\\.\\d+",h="(?:"+s+")|(?:"+l+")";s="("+s+")",l="("+l+")",h="("+h+")";var c,f=h+"%",p="\\s*?",d=new RegExp(["^hsl(a?)\\(",h,",",f,",",f,"(,(",h,"))?\\)$"].join(p)),v=new RegExp(["^rgb(a?)\\(",s,",",s,",",s,"(,(",h,"))?\\)$"].join(p)),m=new RegExp(["^rgb(a?)\\(",f,",",f,",",f,"(,(",h,"))?\\)$"].join(p)),g=[],y={};this.object||(this.object=function(t){function e(){}return e.prototype=t,new e});var x=this.object;c={fromObject:function(t){if(!t)return x(c);for(var e=0,n=g.length;e<n;e++){var r=g[e].fromObject(t);if(r)return r}return x(c)},toString:function(){return this.toCSS()}};var _=null;o("RGB",{red:0,green:0,blue:0,alpha:0,getLuminance:function(){return.2126*this.red+.7152*this.green+.0722*this.blue},blend:function(t,e){t=t.toRGB(),e=Math.min(Math.max(e,0),1);var n=this.clone();return n.red=n.red*(1-e)+t.red*e,n.green=n.green*(1-e)+t.green*e,n.blue=n.blue*(1-e)+t.blue*e,n.alpha=n.alpha*(1-e)+t.alpha*e,n},fromObject:function(t){return t instanceof Array?this._fromRGBArray(t):"string"==typeof t?this._fromCSS(r(t)):t.hasOwnProperty("red")&&t.hasOwnProperty("green")&&t.hasOwnProperty("blue")?this._fromRGB(t):void 0},_stringParsers:[function(t){function e(e,n){var r=t.match(e);if(!r||!!r[1]+!!r[5]===1)return null;var i=y.RGB();return i.red=Math.min(1,Math.max(0,r[2]/n)),i.green=Math.min(1,Math.max(0,r[3]/n)),i.blue=Math.min(1,Math.max(0,r[4]/n)),i.alpha=r[5]?Math.min(Math.max(parseFloat(r[6]),0),1):1,i}t=r(t);var n=e(v,255);return n?n:e(m,100)},function(t){var e=t.toLowerCase();if(e in u&&(t=u[e]),t.match(/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/)){t=t.replace(/^#/,"");var n=t.length/3,r=Math.pow(16,n)-1,i=y.RGB();return i.red=parseInt(t.slice(0,n),16)/r,i.green=parseInt(t.slice(1*n,2*n),16)/r,i.blue=parseInt(t.slice(2*n),16)/r,i.alpha=1,i}},function(t){if("transparent"===t.toLowerCase())return _}],_fromCSS:function(t){for(var e=null,n=0,r=this._stringParsers.length;n<r;n++)if(e=this._stringParsers[n](t))return e},_fromRGB:function(t){var e=y.RGB();return e.red=t.red,e.green=t.green,e.blue=t.blue,e.alpha=t.hasOwnProperty("alpha")?t.alpha:1,e},_fromRGBArray:function(t){var e=y.RGB();return e.red=Math.max(0,Math.min(1,t[0]/255)),e.green=Math.max(0,Math.min(1,t[1]/255)),e.blue=Math.max(0,Math.min(1,t[2]/255)),e.alpha=void 0!==t[3]?Math.max(0,Math.min(1,t[3])):1,e},toCSSHex:function(e){e=e||2;var n=Math.pow(16,e)-1,r=["#",t(Math.round(this.red*n).toString(16).toUpperCase(),e),t(Math.round(this.green*n).toString(16).toUpperCase(),e),t(Math.round(this.blue*n).toString(16).toUpperCase(),e)];return r.join("")},toCSS:function(t){if(1===this.alpha)return this.toCSSHex(t);var e=255,n=["rgba(",Math.max(0,Math.min(e,Math.round(this.red*e))),",",Math.max(0,Math.min(e,Math.round(this.green*e))),",",Math.max(0,Math.min(e,Math.round(this.blue*e))),",",Math.max(0,Math.min(1,this.alpha)),")"];return n.join("")},toHSV:function(){var t,e,n,r=y.HSV();return t=Math.min(this.red,this.green,this.blue),e=Math.max(this.red,this.green,this.blue),r.value=e,n=e-t,0==n?r.hue=r.saturation=0:(r.saturation=n/e,this.red==e?r.hue=(this.green-this.blue)/n:this.green==e?r.hue=2+(this.blue-this.red)/n:r.hue=4+(this.red-this.green)/n,r.hue=(60*r.hue+360)%360),r.alpha=this.alpha,r},toHSL:function(){return this.toHSV().toHSL()},toRGB:function(){return this.clone()}}),_=c.fromObject({red:0,blue:0,green:0,alpha:0}),o("HSV",{hue:0,saturation:0,value:1,alpha:1,shiftHue:i(function(t){var e=(this.hue+t)%360;e<0&&(e=(360+e)%360),this.hue=e}),devalueByAmount:i(function(t){this.value=Math.min(1,Math.max(this.value-t,0))}),devalueByRatio:i(function(t){this.value=Math.min(1,Math.max(this.value*(1-t),0))}),valueByAmount:i(function(t){this.value=Math.min(1,Math.max(this.value+t,0))}),valueByRatio:i(function(t){this.value=Math.min(1,Math.max(this.value*(1+t),0))}),desaturateByAmount:i(function(t){this.saturation=Math.min(1,Math.max(this.saturation-t,0))}),desaturateByRatio:i(function(t){this.saturation=Math.min(1,Math.max(this.saturation*(1-t),0))}),saturateByAmount:i(function(t){this.saturation=Math.min(1,Math.max(this.saturation+t,0))}),saturateByRatio:i(function(t){this.saturation=Math.min(1,Math.max(this.saturation*(1+t),0))}),schemeFromDegrees:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=this.clone();i.hue=(this.hue+t[n])%360,e.push(i)}return e},complementaryScheme:function(){return this.schemeFromDegrees([0,180])},splitComplementaryScheme:function(){return this.schemeFromDegrees([0,150,320])},splitComplementaryCWScheme:function(){return this.schemeFromDegrees([0,150,300])},splitComplementaryCCWScheme:function(){return this.schemeFromDegrees([0,60,210])},triadicScheme:function(){return this.schemeFromDegrees([0,120,240])},clashScheme:function(){return this.schemeFromDegrees([0,90,270])},tetradicScheme:function(){return this.schemeFromDegrees([0,90,180,270])},fourToneCWScheme:function(){return this.schemeFromDegrees([0,60,180,240])},fourToneCCWScheme:function(){return this.schemeFromDegrees([0,120,180,300])},fiveToneAScheme:function(){return this.schemeFromDegrees([0,115,155,205,245])},fiveToneBScheme:function(){return this.schemeFromDegrees([0,40,90,130,245])},fiveToneCScheme:function(){return this.schemeFromDegrees([0,50,90,205,320])},fiveToneDScheme:function(){return this.schemeFromDegrees([0,40,155,270,310])},fiveToneEScheme:function(){return this.schemeFromDegrees([0,115,230,270,320])},sixToneCWScheme:function(){return this.schemeFromDegrees([0,30,120,150,240,270])},sixToneCCWScheme:function(){return this.schemeFromDegrees([0,90,120,210,240,330])},neutralScheme:function(){return this.schemeFromDegrees([0,15,30,45,60,75])},analogousScheme:function(){return this.schemeFromDegrees([0,30,60,90,120,150])},fromObject:function(t){if(t.hasOwnProperty("hue")&&t.hasOwnProperty("saturation")&&t.hasOwnProperty("value")){var e=y.HSV();return e.hue=t.hue,e.saturation=t.saturation,e.value=t.value,e.alpha=t.hasOwnProperty("alpha")?t.alpha:1,e}return null},_normalise:function(){this.hue%=360,this.saturation=Math.min(Math.max(0,this.saturation),1),this.value=Math.min(Math.max(0,this.value)),this.alpha=Math.min(1,Math.max(0,this.alpha))},toRGB:function(){this._normalise();var t,e,n,r,i,o=y.RGB();if(0===this.saturation)return o.red=this.value,o.green=this.value,o.blue=this.value,o.alpha=this.alpha,o;var a=this.hue/60;switch(t=Math.floor(a),e=a-t,n=this.value*(1-this.saturation),r=this.value*(1-this.saturation*e),i=this.value*(1-this.saturation*(1-e)),t){case 0:o.red=this.value,o.green=i,o.blue=n;break;case 1:o.red=r,o.green=this.value,o.blue=n;break;case 2:o.red=n,o.green=this.value,o.blue=i;break;case 3:o.red=n,o.green=r,o.blue=this.value;break;case 4:o.red=i,o.green=n,o.blue=this.value;break;default:o.red=this.value,o.green=n,o.blue=r}return o.alpha=this.alpha,o},toHSL:function(){this._normalise();var t=y.HSL();t.hue=this.hue;var e=(2-this.saturation)*this.value,n=this.saturation*this.value;return e&&2-e&&(n/=e<=1?e:2-e),e/=2,t.saturation=n,t.lightness=e,t.alpha=this.alpha,t},toHSV:function(){return this.clone()}}),o("HSL",{hue:0,saturation:0,lightness:0,alpha:1,darkenByAmount:i(function(t){this.lightness=Math.min(1,Math.max(this.lightness-t,0))}),darkenByRatio:i(function(t){this.lightness=Math.min(1,Math.max(this.lightness*(1-t),0))}),lightenByAmount:i(function(t){this.lightness=Math.min(1,Math.max(this.lightness+t,0))}),lightenByRatio:i(function(t){this.lightness=Math.min(1,Math.max(this.lightness*(1+t),0))}),fromObject:function(t){return"string"==typeof t?this._fromCSS(t):t.hasOwnProperty("hue")&&t.hasOwnProperty("saturation")&&t.hasOwnProperty("lightness")?this._fromHSL(t):void 0},_fromCSS:function(t){var e=r(t).match(d);if(!e||!!e[1]+!!e[5]===1)return null;var n=y.HSL();return n.hue=(e[2]%360+360)%360,n.saturation=Math.max(0,Math.min(parseInt(e[3],10)/100,1)),n.lightness=Math.max(0,Math.min(parseInt(e[4],10)/100,1)),n.alpha=e[5]?Math.max(0,Math.min(1,parseFloat(e[6]))):1,n},_fromHSL:function(t){var e=y.HSL();return e.hue=t.hue,e.saturation=t.saturation,e.lightness=t.lightness,e.alpha=t.hasOwnProperty("alpha")?t.alpha:1,e},_normalise:function(){this.hue=(this.hue%360+360)%360,this.saturation=Math.min(Math.max(0,this.saturation),1),this.lightness=Math.min(Math.max(0,this.lightness)),this.alpha=Math.min(1,Math.max(0,this.alpha))},toHSL:function(){return this.clone()},toHSV:function(){this._normalise();var t=y.HSV();t.hue=this.hue;var e=2*this.lightness,n=this.saturation*(e<=1?e:2-e);return t.value=(e+n)/2,t.saturation=2*n/(e+n)||0,t.alpha=this.alpha,t},toRGB:function(){return this.toHSV().toRGB()}}),a.isValid=function(t){var e,n=a(t),r=0;for(e in n)n.hasOwnProperty(e)&&r++;return r>0},e.brehaut.Color=a}.call(e.brehaut),t.exports=e.brehaut.Color}),Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Re=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Pe=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Ce=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Te=function(){function t(e,n,r,i,o,a){Ee(this,t),this.depthTest=!!e,this.depthTest?(this.depthMask=n,this.depthFunc=r):(i=n,o=r,a=i),this.blend=!!i,this.blend&&(this.blendFuncSrc=o,this.blendFuncDst=a),Object.freeze(this)}return t.prototype.activate=function(t){this.depthTest?(t.enable(t.DEPTH_TEST),t.depthMask(this.depthMask),t.depthFunc(t[this.depthFunc])):t.disable(t.DEPTH_TEST),this.blend?(t.enable(t.BLEND),t.blendFunc(t[this.blendFuncSrc],t[this.blendFuncDst])):t.disable(t.BLEND)},t}(),Oe=function(t){f(t,"predefinedBlendModes",new Map),t.getBlendMode=function(t){return this.predefinedBlendModes.get(t)},t.setBlendMode=function(t,e){this.predefinedBlendModes.set(t,e)},t.setBlendMode("default",new Te(!0,!0,"ALWAYS",!0,"SRC_ALPHA","ONE_MINUS_SRC_ALPHA"))},ze=function(t){var e=void 0;return Object.defineProperties(t,{glx:{set:function(t){e=t,Object.defineProperty(this,"gl",{value:"object"===("undefined"==typeof t?"undefined":Ae(t))?t.gl:void 0,configurable:!0})},get:function(){return e}}}),t},je=function(t,e,n){if(h(t,"canvasIsPredefined",void 0!==e),e=t.canvasIsPredefined?e:document.createElement("canvas"),h(t,"canvas",e),!t.canvasIsPredefined){e.style.boxSizing="border-box",e.style.margin="0",e.style.padding="0",e.style.border="0",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.bottom="0",e.style.right="0",e.style.touchAction="none",v(e);var r=void 0,i=void 0;i=document.createElement("div"),i.style.position="relative",i.style.boxSizing="border-box;",i.style.margin="0",i.style.padding="0",i.style.border="0",i.style.overflow="hidden",i.style.width="100%",i.style.height="100%",i.style.touchAction="none",v(i),i.appendChild(e),r=n||document.body,r.appendChild(i)}},Be=function(t){var e=(t+"").trim();return e.match(/^[0-9]+$/)?e+".0":e},Ne=function(t){return"number"==typeof t},Ue=function(t){return"number"==typeof t},ke=function(t){return"number"==typeof t},Le=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rotate",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return["mat4 "+t+"(float angle) {","float s = sin(angle);","float c = cos(angle);","float oc = 1.0 - c;",b(g(x(y("oc",e*e),"c"),_(y("oc",e*n),y(r,"s")),x(y("oc",r*e),y(n,"s")),0,x(y("oc",e*n),y(r,"s")),x(y("oc",n*n),"c"),_(y("oc",n*r),y(e,"s")),0,_(y("oc",r*e),y(n,"s")),x(y("oc",n*r),y(e,"s")),x(y("oc",r*r),"c"))),"}"]},We=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rotateZ";return Le(t,0,0,1)},Ge=["attribute vec2 xwyh;","attribute vec2 size;","attribute vec2 scale;","attribute vec2 pos;","attribute vec2 rot_texUnit;","attribute vec2 texCoords;","attribute vec4 color;","uniform mat4 viewMatrix;","uniform float renderPrio;","varying vec2 v_texCoords;","varying vec2 v_texUnit;","varying vec4 v_color;",We(),"void main(void)","{","    mat4 rotationMatrix = rotateZ(rot_texUnit.x);","    vec2 pos2d = xwyh * size * scale;","    gl_Position = viewMatrix * ((rotationMatrix * vec4( pos2d, renderPrio, 1.0 )) + vec4(pos.xy, 0.0, 1.0));","    v_texCoords = texCoords;","    v_texUnit = vec2(rot_texUnit.y, 0);","    v_color = color;","}"],Ve=["precision mediump float;","varying vec2 v_texCoords;","varying vec2 v_texUnit;","varying vec4 v_color;","uniform sampler2D tex;","void main(void)","{","    vec4 texColor;","    texColor = texture2D(tex, v_texCoords);","    gl_FragColor = v_color * texColor;","}"],Ye=["\n    attribute vec2 pos2d;\n    attribute float posZ;\n    attribute vec2 uv;\n    attribute vec2 translate;\n    attribute float rotate;\n    attribute float scale;\n    attribute float opacity;\n\n    uniform mat4 viewMatrix;\n\n    varying vec4 vTextureCoordScaleOpacity;",Le("rotateZ",0,0,1),"\n    void main(void)\n    {\n        mat4 rotationMatrix = rotateZ(rotate);\n        gl_Position = viewMatrix * ((rotationMatrix * (vec4(scale, scale, scale, 1.0) * vec4(pos2d.xy, posZ, 1.0))) + vec4(translate.xy, 0.0, 0.0));\n        vTextureCoordScaleOpacity = vec4(uv.xy, opacity, 0.0);\n    }\n"],qe=["\n    precision mediump float;\n\n    varying vec4 vTextureCoordScaleOpacity;\n    uniform sampler2D tex;\n\n    void main(void) {\n        gl_FragColor = vTextureCoordScaleOpacity.z * texture2D(tex, vec2(vTextureCoordScaleOpacity.s, vTextureCoordScaleOpacity.t));\n    }\n"],He=function(){function t(e,n){Ee(this,t),p(this,{program:e,info:n,location:e.glx.gl.getAttribLocation(e.glProgram,n.name)}),e.glx.gl.enableVertexAttribArray(this.location),M(this),Object.seal(this)}return t.prototype.upload=function(){if(this.valueChanged){var t=this.value;t.buffer.bindBuffer().vertexAttribPointer(this.location,t.size,t.stride,t.offset),this.valueChanged=!1}},t}(),Xe=function(){function t(e,n){Ee(this,t),p(this,{program:e,info:n,location:e.glx.gl.getUniformLocation(e.glProgram,n.name)}),M(this),S(this),Object.seal(this)}return t.prototype.upload=function(t){if(this.isSampler2d&&(this.texUnit=this.value.upload().bind()),this.valueChanged){switch(this.info.type){case t.FLOAT:t.uniform1f(this.location,this.value);break;case t.FLOAT_VEC2:t.uniform2f(this.location,this.value[0],this.value[1]);break;case t.FLOAT_VEC3:t.uniform3f(this.location,this.value[0],this.value[1],this.value[2]);break;case t.FLOAT_VEC4:t.uniform4f(this.location,this.value[0],this.value[1],this.value[2],this.value[3]);break;case t.FLOAT_MAT4:t.uniformMatrix4fv(this.location,t.FALSE,this.value.mat4);break;case t.SAMPLER_2D:t.uniform1i(this.location,this.texUnit)}this.valueChanged=!1}},t}();F.prototype.use=function(){this.glx.activeProgram!==this&&(this.glx.activeProgram=this,this.glx.gl.useProgram(this.glProgram))};var $e=0,Ze=function(t){return h(t,"uid",++$e),t},Qe=function(){function t(e,n,r){Ee(this,t),Ze(this),p(this,{name:e,vertexShaderName:n?n:e,fragmentShaderName:r?r:e})}return t.prototype.linkProgram=function(t){var e=t.glx,n=e.gl,r=e.glShader(t.getVertexShader(this.vertexShaderName));if(r){var i=e.glShader(t.getFragmentShader(this.fragmentShaderName));if(i){var o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw new Error("Could not link webgl program: "+this.name);return new F(this,o,e)}}},t}(),Ke=l(function(t,e){(function(){function n(t,e){return t.set(e[0],e[1]),t}function r(t,e){return t.add(e),t}function i(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function o(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function a(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function u(t,e){for(var n=null==t?0:t.length;n--&&e(t[n],n,t)!==!1;);return t}function s(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function l(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function h(t,e){var n=null==t?0:t.length;return!!n&&b(t,e,0)>-1}function c(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function f(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function p(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function d(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function v(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function m(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function g(t){return t.split("")}function y(t){return t.match(Le)||[]}function x(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function _(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function b(t,e,n){return e===e?X(t,e,n):_(t,S,n)}function M(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function S(t){return t!==t}function F(t,e){var n=null==t?0:t.length;return n?E(t,e)/n:Ot}function w(t){return function(e){return null==e?et:e[t]}}function D(t){return function(e){return null==t?et:t[e]}}function I(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function A(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function E(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==et&&(n=n===et?o:n+o)}return n}function R(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function P(t,e){return f(e,function(e){return[e,t[e]]})}function C(t){return function(e){return t(e)}}function T(t,e){return f(e,function(e){return t[e]})}function O(t,e){return t.has(e)}function z(t,e){for(var n=-1,r=t.length;++n<r&&b(e,t[n],0)>-1;);return n}function j(t,e){for(var n=t.length;n--&&b(e,t[n],0)>-1;);return n}function B(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}function N(t){return"\\"+tr[t]}function U(t,e){return null==t?et:t[e]}function k(t){return Yn.test(t)}function L(t){return qn.test(t)}function W(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function G(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function V(t,e){return function(n){return t(e(n))}}function Y(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&a!==st||(t[n]=st,o[i++]=n)}return o}function q(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function H(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function X(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function $(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}function Z(t){return k(t)?K(t):gr(t)}function Q(t){return k(t)?J(t):g(t)}function K(t){for(var e=Gn.lastIndex=0;Gn.test(t);)++e;return e}function J(t){return t.match(Gn)||[]}function tt(t){return t.match(Vn)||[]}var et,nt="4.17.2",rt=200,it="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ot="Expected a function",at="__lodash_hash_undefined__",ut=500,st="__lodash_placeholder__",lt=1,ht=2,ct=4,ft=1,pt=2,dt=1,vt=2,mt=4,gt=8,yt=16,xt=32,_t=64,bt=128,Mt=256,St=512,Ft=30,wt="...",Dt=800,It=16,At=1,Et=2,Rt=3,Pt=1/0,Ct=9007199254740991,Tt=1.7976931348623157e308,Ot=NaN,zt=4294967295,jt=zt-1,Bt=zt>>>1,Nt=[["ary",bt],["bind",dt],["bindKey",vt],["curry",gt],["curryRight",yt],["flip",St],["partial",xt],["partialRight",_t],["rearg",Mt]],Ut="[object Arguments]",kt="[object Array]",Lt="[object AsyncFunction]",Wt="[object Boolean]",Gt="[object Date]",Vt="[object DOMException]",Yt="[object Error]",qt="[object Function]",Ht="[object GeneratorFunction]",Xt="[object Map]",$t="[object Number]",Zt="[object Null]",Qt="[object Object]",Kt="[object Promise]",Jt="[object Proxy]",te="[object RegExp]",ee="[object Set]",ne="[object String]",re="[object Symbol]",ie="[object Undefined]",oe="[object WeakMap]",ae="[object WeakSet]",ue="[object ArrayBuffer]",se="[object DataView]",le="[object Float32Array]",he="[object Float64Array]",ce="[object Int8Array]",fe="[object Int16Array]",pe="[object Int32Array]",de="[object Uint8Array]",ve="[object Uint8ClampedArray]",me="[object Uint16Array]",ge="[object Uint32Array]",ye=/\b__p \+= '';/g,xe=/\b(__p \+=) '' \+/g,_e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39);/g,Me=/[&<>"']/g,Se=RegExp(be.source),Fe=RegExp(Me.source),we=/<%-([\s\S]+?)%>/g,Ie=/<%([\s\S]+?)%>/g,Ae=/<%=([\s\S]+?)%>/g,Ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Re=/^\w*$/,Pe=/^\./,Ce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Te=/[\\^$.*+?()[\]{}|]/g,Oe=RegExp(Te.source),ze=/^\s+|\s+$/g,je=/^\s+/,Be=/\s+$/,Ne=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ke=/,? & /,Le=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,We=/\\(\\)?/g,Ge=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ve=/\w*$/,Ye=/^[-+]0x[0-9a-f]+$/i,qe=/^0b[01]+$/i,He=/^\[object .+?Constructor\]$/,Xe=/^0o[0-7]+$/i,$e=/^(?:0|[1-9]\d*)$/,Ze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qe=/($^)/,Ke=/['\n\r\u2028\u2029\\]/g,Je="\\ud800-\\udfff",tn="\\u0300-\\u036f",en="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",rn=tn+en+nn,on="\\u2700-\\u27bf",an="a-z\\xdf-\\xf6\\xf8-\\xff",un="\\xac\\xb1\\xd7\\xf7",sn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ln="\\u2000-\\u206f",hn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cn="A-Z\\xc0-\\xd6\\xd8-\\xde",fn="\\ufe0e\\ufe0f",pn=un+sn+ln+hn,dn="['’]",vn="["+Je+"]",mn="["+pn+"]",gn="["+rn+"]",yn="\\d+",xn="["+on+"]",_n="["+an+"]",bn="[^"+Je+pn+yn+on+an+cn+"]",Mn="\\ud83c[\\udffb-\\udfff]",Sn="(?:"+gn+"|"+Mn+")",Fn="[^"+Je+"]",wn="(?:\\ud83c[\\udde6-\\uddff]){2}",Dn="[\\ud800-\\udbff][\\udc00-\\udfff]",In="["+cn+"]",An="\\u200d",En="(?:"+_n+"|"+bn+")",Rn="(?:"+In+"|"+bn+")",Pn="(?:"+dn+"(?:d|ll|m|re|s|t|ve))?",Cn="(?:"+dn+"(?:D|LL|M|RE|S|T|VE))?",Tn=Sn+"?",On="["+fn+"]?",zn="(?:"+An+"(?:"+[Fn,wn,Dn].join("|")+")"+On+Tn+")*",jn="\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Bn="\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",Nn=On+Tn+zn,Un="(?:"+[xn,wn,Dn].join("|")+")"+Nn,kn="(?:"+[Fn+gn+"?",gn,wn,Dn,vn].join("|")+")",Ln=RegExp(dn,"g"),Wn=RegExp(gn,"g"),Gn=RegExp(Mn+"(?="+Mn+")|"+kn+Nn,"g"),Vn=RegExp([In+"?"+_n+"+"+Pn+"(?="+[mn,In,"$"].join("|")+")",Rn+"+"+Cn+"(?="+[mn,In+En,"$"].join("|")+")",In+"?"+En+"+"+Pn,In+"+"+Cn,Bn,jn,yn,Un].join("|"),"g"),Yn=RegExp("["+An+Je+rn+fn+"]"),qn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Hn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xn=-1,$n={};$n[le]=$n[he]=$n[ce]=$n[fe]=$n[pe]=$n[de]=$n[ve]=$n[me]=$n[ge]=!0,$n[Ut]=$n[kt]=$n[ue]=$n[Wt]=$n[se]=$n[Gt]=$n[Yt]=$n[qt]=$n[Xt]=$n[$t]=$n[Qt]=$n[te]=$n[ee]=$n[ne]=$n[oe]=!1;var Zn={};Zn[Ut]=Zn[kt]=Zn[ue]=Zn[se]=Zn[Wt]=Zn[Gt]=Zn[le]=Zn[he]=Zn[ce]=Zn[fe]=Zn[pe]=Zn[Xt]=Zn[$t]=Zn[Qt]=Zn[te]=Zn[ee]=Zn[ne]=Zn[re]=Zn[de]=Zn[ve]=Zn[me]=Zn[ge]=!0,Zn[Yt]=Zn[qt]=Zn[oe]=!1;var Qn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Kn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},tr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},er=parseFloat,nr=parseInt,rr="object"==typeof De&&De&&De.Object===Object&&De,ir="object"==typeof self&&self&&self.Object===Object&&self,or=rr||ir||Function("return this")(),ar=e&&!e.nodeType&&e,ur=ar&&!0&&t&&!t.nodeType&&t,sr=ur&&ur.exports===ar,lr=sr&&rr.process,hr=function(){try{return lr&&lr.binding&&lr.binding("util")}catch(t){}}(),cr=hr&&hr.isArrayBuffer,fr=hr&&hr.isDate,pr=hr&&hr.isMap,dr=hr&&hr.isRegExp,vr=hr&&hr.isSet,mr=hr&&hr.isTypedArray,gr=w("length"),yr=D(Qn),xr=D(Kn),_r=D(Jn),br=function t(e){function g(t){if(ss(t)&&!_f(t)&&!(t instanceof K)){if(t instanceof X)return t;if(xh.call(t,"__wrapped__"))return oa(t)}return new X(t)}function D(){}function X(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=et}function K(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=zt,this.__views__=[]}function J(){var t=new K(this.__wrapped__);return t.__actions__=Li(this.__actions__),t.__dir__=this.__dir__,
t.__filtered__=this.__filtered__,t.__iteratees__=Li(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Li(this.__views__),t}function De(){if(this.__filtered__){var t=new K(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Le(){var t=this.__wrapped__.value(),e=this.__dir__,n=_f(t),r=e<0,i=n?t.length:0,o=Ao(0,i,this.__views__),a=o.start,u=o.end,s=u-a,l=r?u:a-1,h=this.__iteratees__,c=h.length,f=0,p=$h(s,this.__takeCount__);if(!n||i<rt||i==s&&p==s)return Mi(t,this.__actions__);var d=[];t:for(;s--&&f<p;){l+=e;for(var v=-1,m=t[l];++v<c;){var g=h[v],y=g.iteratee,x=g.type,_=y(m);if(x==Et)m=_;else if(!_){if(x==At)continue t;break t}}d[f++]=m}return d}function Je(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function tn(){this.__data__=oc?oc(null):{},this.size=0}function en(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function nn(t){var e=this.__data__;if(oc){var n=e[t];return n===at?et:n}return xh.call(e,t)?e[t]:et}function rn(t){var e=this.__data__;return oc?e[t]!==et:xh.call(e,t)}function on(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=oc&&e===et?at:e,this}function an(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function un(){this.__data__=[],this.size=0}function sn(t){var e=this.__data__,n=On(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Th.call(e,n,1),--this.size,!0}function ln(t){var e=this.__data__,n=On(e,t);return n<0?et:e[n][1]}function hn(t){return On(this.__data__,t)>-1}function cn(t,e){var n=this.__data__,r=On(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function fn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function pn(){this.size=0,this.__data__={hash:new Je,map:new(ec||an),string:new Je}}function dn(t){var e=Fo(this,t).delete(t);return this.size-=e?1:0,e}function vn(t){return Fo(this,t).get(t)}function mn(t){return Fo(this,t).has(t)}function gn(t,e){var n=Fo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function yn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new fn;++e<n;)this.add(t[e])}function xn(t){return this.__data__.set(t,at),this}function _n(t){return this.__data__.has(t)}function bn(t){var e=this.__data__=new an(t);this.size=e.size}function Mn(){this.__data__=new an,this.size=0}function Sn(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Fn(t){return this.__data__.get(t)}function wn(t){return this.__data__.has(t)}function Dn(t,e){var n=this.__data__;if(n instanceof an){var r=n.__data__;if(!ec||r.length<rt-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new fn(r)}return n.set(t,e),this.size=n.size,this}function In(t,e){var n=_f(t),r=!n&&xf(t),i=!n&&!r&&Mf(t),o=!n&&!r&&!i&&If(t),a=n||r||i||o,u=a?R(t.length,fh):[],s=u.length;for(var l in t)!e&&!xh.call(t,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||jo(l,s))||u.push(l);return u}function An(t){var e=t.length;return e?t[ri(0,e-1)]:et}function En(t,e){return ea(Li(t),kn(e,0,t.length))}function Rn(t){return ea(Li(t))}function Pn(t,e,n,r){return t===et||Xu(t,mh[n])&&!xh.call(r,n)?e:t}function Cn(t,e,n){(n===et||Xu(t[e],n))&&(n!==et||e in t)||Nn(t,e,n)}function Tn(t,e,n){var r=t[e];xh.call(t,e)&&Xu(r,n)&&(n!==et||e in t)||Nn(t,e,n)}function On(t,e){for(var n=t.length;n--;)if(Xu(t[n][0],e))return n;return-1}function zn(t,e,n,r){return gc(t,function(t,i,o){e(r,t,n(t),o)}),r}function jn(t,e){return t&&Wi(e,Gs(e),t)}function Bn(t,e){return t&&Wi(e,Vs(e),t)}function Nn(t,e,n){"__proto__"==e&&Bh?Bh(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Un(t,e){for(var n=-1,r=e.length,i=oh(r),o=null==t;++n<r;)i[n]=o?et:ks(t,e[n]);return i}function kn(t,e,n){return t===t&&(n!==et&&(t=t<=n?t:n),e!==et&&(t=t>=e?t:e)),t}function Gn(t,e,n,r,i,o){var u,s=e&lt,l=e&ht,h=e&ct;if(n&&(u=i?n(t,r,i,o):n(t)),u!==et)return u;if(!us(t))return t;var c=_f(t);if(c){if(u=Po(t),!s)return Li(t,u)}else{var f=Ec(t),p=f==qt||f==Ht;if(Mf(t))return Ei(t,s);if(f==Qt||f==Ut||p&&!i){if(u=l||p?{}:Co(t),!s)return l?Vi(t,Bn(u,t)):Gi(t,jn(u,t))}else{if(!Zn[f])return i?t:{};u=To(t,f,Gn,s)}}o||(o=new bn);var d=o.get(t);if(d)return d;o.set(t,u);var v=h?l?_o:xo:l?Vs:Gs,m=c?et:v(t);return a(m||t,function(r,i){m&&(i=r,r=t[i]),Tn(u,i,Gn(r,e,n,i,t,o))}),u}function Vn(t){var e=Gs(t);return function(n){return Yn(n,t,e)}}function Yn(t,e,n){var r=n.length;if(null==t)return!r;for(t=hh(t);r--;){var i=n[r],o=e[i],a=t[i];if(a===et&&!(i in t)||!o(a))return!1}return!0}function qn(t,e,n){if("function"!=typeof t)throw new ph(ot);return Cc(function(){t.apply(et,n)},e)}function Qn(t,e,n,r){var i=-1,o=h,a=!0,u=t.length,s=[],l=e.length;if(!u)return s;n&&(e=f(e,C(n))),r?(o=c,a=!1):e.length>=rt&&(o=O,a=!1,e=new yn(e));t:for(;++i<u;){var p=t[i],d=null==n?p:n(p);if(p=r||0!==p?p:0,a&&d===d){for(var v=l;v--;)if(e[v]===d)continue t;s.push(p)}else o(e,d,r)||s.push(p)}return s}function Kn(t,e){var n=!0;return gc(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Jn(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(u===et?a===a&&!xs(a):n(a,u)))var u=a,s=o}return s}function tr(t,e,n,r){var i=t.length;for(n=ws(n),n<0&&(n=-n>i?0:i+n),r=r===et||r>i?i:ws(r),r<0&&(r+=i),r=n>r?0:Ds(r);n<r;)t[n++]=e;return t}function rr(t,e){var n=[];return gc(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function ir(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=zo),i||(i=[]);++o<a;){var u=t[o];e>0&&n(u)?e>1?ir(u,e-1,n,r,i):p(i,u):r||(i[i.length]=u)}return i}function ar(t,e){return t&&xc(t,e,Gs)}function ur(t,e){return t&&_c(t,e,Gs)}function lr(t,e){return l(e,function(e){return is(t[e])})}function hr(t,e){e=Ii(e,t);for(var n=0,r=e.length;null!=t&&n<r;)t=t[na(e[n++])];return n&&n==r?t:et}function gr(t,e,n){var r=e(t);return _f(t)?r:p(r,n(t))}function br(t){return null==t?t===et?ie:Zt:(t=hh(t),jh&&jh in t?Io(t):$o(t))}function Sr(t,e){return t>e}function Fr(t,e){return null!=t&&xh.call(t,e)}function wr(t,e){return null!=t&&e in hh(t)}function Dr(t,e,n){return t>=$h(e,n)&&t<Xh(e,n)}function Ir(t,e,n){for(var r=n?c:h,i=t[0].length,o=t.length,a=o,u=oh(o),s=1/0,l=[];a--;){var p=t[a];a&&e&&(p=f(p,C(e))),s=$h(p.length,s),u[a]=!n&&(e||i>=120&&p.length>=120)?new yn(a&&p):et}p=t[0];var d=-1,v=u[0];t:for(;++d<i&&l.length<s;){var m=p[d],g=e?e(m):m;if(m=n||0!==m?m:0,!(v?O(v,g):r(l,g,n))){for(a=o;--a;){var y=u[a];if(!(y?O(y,g):r(t[a],g,n)))continue t}v&&v.push(g),l.push(m)}}return l}function Ar(t,e,n,r){return ar(t,function(t,i,o){e(r,n(t),i,o)}),r}function Er(t,e,n){e=Ii(e,t),t=Qo(t,e);var r=null==t?t:t[na(Fa(e))];return null==r?et:i(r,t,n)}function Rr(t){return ss(t)&&br(t)==Ut}function Pr(t){return ss(t)&&br(t)==ue}function Cr(t){return ss(t)&&br(t)==Gt}function Tr(t,e,n,r,i){return t===e||(null==t||null==e||!us(t)&&!ss(e)?t!==t&&e!==e:Or(t,e,n,r,Tr,i))}function Or(t,e,n,r,i,o){var a=_f(t),u=_f(e),s=kt,l=kt;a||(s=Ec(t),s=s==Ut?Qt:s),u||(l=Ec(e),l=l==Ut?Qt:l);var h=s==Qt,c=l==Qt,f=s==l;if(f&&Mf(t)){if(!Mf(e))return!1;a=!0,h=!1}if(f&&!h)return o||(o=new bn),a||If(t)?vo(t,e,n,r,i,o):mo(t,e,s,n,r,i,o);if(!(n&ft)){var p=h&&xh.call(t,"__wrapped__"),d=c&&xh.call(e,"__wrapped__");if(p||d){var v=p?t.value():t,m=d?e.value():e;return o||(o=new bn),i(v,m,n,r,o)}}return!!f&&(o||(o=new bn),go(t,e,n,r,i,o))}function zr(t){return ss(t)&&Ec(t)==Xt}function jr(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=hh(t);i--;){var u=n[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){u=n[i];var s=u[0],l=t[s],h=u[1];if(a&&u[2]){if(l===et&&!(s in t))return!1}else{var c=new bn;if(r)var f=r(l,h,s,t,e,c);if(!(f===et?Tr(h,l,ft|pt,r,c):f))return!1}}return!0}function Br(t){if(!us(t)||Lo(t))return!1;var e=is(t)?wh:He;return e.test(ra(t))}function Nr(t){return ss(t)&&br(t)==te}function Ur(t){return ss(t)&&Ec(t)==ee}function kr(t){return ss(t)&&as(t.length)&&!!$n[br(t)]}function Lr(t){return"function"==typeof t?t:null==t?Tl:"object"==typeof t?_f(t)?Hr(t[0],t[1]):qr(t):Ll(t)}function Wr(t){if(!Wo(t))return Hh(t);var e=[];for(var n in hh(t))xh.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Gr(t){if(!us(t))return Xo(t);var e=Wo(t),n=[];for(var r in t)("constructor"!=r||!e&&xh.call(t,r))&&n.push(r);return n}function Vr(t,e){return t<e}function Yr(t,e){var n=-1,r=$u(t)?oh(t.length):[];return gc(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function qr(t){var e=wo(t);return 1==e.length&&e[0][2]?Vo(e[0][0],e[0][1]):function(n){return n===t||jr(n,t,e)}}function Hr(t,e){return No(t)&&Go(e)?Vo(na(t),e):function(n){var r=ks(n,t);return r===et&&r===e?Ws(n,t):Tr(e,r,ft|pt)}}function Xr(t,e,n,r,i){t!==e&&xc(e,function(o,a){if(us(o))i||(i=new bn),$r(t,e,a,n,Xr,r,i);else{var u=r?r(t[a],o,a+"",t,e,i):et;u===et&&(u=o),Cn(t,a,u)}},Vs)}function $r(t,e,n,r,i,o,a){var u=t[n],s=e[n],l=a.get(s);if(l)return void Cn(t,n,l);var h=o?o(u,s,n+"",t,e,a):et,c=h===et;if(c){var f=_f(s),p=!f&&Mf(s),d=!f&&!p&&If(s);h=s,f||p||d?_f(u)?h=u:Zu(u)?h=Li(u):p?(c=!1,h=Ei(s,!0)):d?(c=!1,h=ji(s,!0)):h=[]:ms(s)||xf(s)?(h=u,xf(u)?h=As(u):(!us(u)||r&&is(u))&&(h=Co(s))):c=!1}c&&(a.set(s,h),i(h,s,r,o,a),a.delete(s)),Cn(t,n,h)}function Zr(t,e){var n=t.length;if(n)return e+=e<0?n:0,jo(e,n)?t[e]:et}function Qr(t,e,n){var r=-1;e=f(e.length?e:[Tl],C(So()));var i=Yr(t,function(t,n,i){var o=f(e,function(e){return e(t)});return{criteria:o,index:++r,value:t}});return A(i,function(t,e){return Ni(t,e,n)})}function Kr(t,e){return t=hh(t),Jr(t,e,function(e,n){return Ws(t,n)})}function Jr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],u=hr(t,a);n(u,a)&&li(o,Ii(a,t),u)}return o}function ti(t){return function(e){return hr(e,t)}}function ei(t,e,n,r){var i=r?M:b,o=-1,a=e.length,u=t;for(t===e&&(e=Li(e)),n&&(u=f(t,C(n)));++o<a;)for(var s=0,l=e[o],h=n?n(l):l;(s=i(u,h,s,r))>-1;)u!==t&&Th.call(u,s,1),Th.call(t,s,1);return t}function ni(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;jo(i)?Th.call(t,i,1):xi(t,i)}}return t}function ri(t,e){return t+Wh(Kh()*(e-t+1))}function ii(t,e,n,r){for(var i=-1,o=Xh(Lh((e-t)/(n||1)),0),a=oh(o);o--;)a[r?o:++i]=t,t+=n;return a}function oi(t,e){var n="";if(!t||e<1||e>Ct)return n;do e%2&&(n+=t),e=Wh(e/2),e&&(t+=t);while(e);return n}function ai(t,e){return Tc(Zo(t,e,Tl),t+"")}function ui(t){return An(nl(t))}function si(t,e){var n=nl(t);return ea(n,kn(e,0,n.length))}function li(t,e,n,r){if(!us(t))return t;e=Ii(e,t);for(var i=-1,o=e.length,a=o-1,u=t;null!=u&&++i<o;){var s=na(e[i]),l=n;if(i!=a){var h=u[s];l=r?r(h,s,u):et,l===et&&(l=us(h)?h:jo(e[i+1])?[]:{})}Tn(u,s,l),u=u[s]}return t}function hi(t){return ea(nl(t))}function ci(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=oh(i);++r<i;)o[r]=t[r+e];return o}function fi(t,e){var n;return gc(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function pi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e===e&&i<=Bt){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!xs(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return di(t,e,Tl,n)}function di(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,a=e!==e,u=null===e,s=xs(e),l=e===et;i<o;){var h=Wh((i+o)/2),c=n(t[h]),f=c!==et,p=null===c,d=c===c,v=xs(c);if(a)var m=r||d;else m=l?d&&(r||f):u?d&&f&&(r||!p):s?d&&f&&!p&&(r||!v):!p&&!v&&(r?c<=e:c<e);m?i=h+1:o=h}return $h(o,jt)}function vi(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],u=e?e(a):a;if(!n||!Xu(u,s)){var s=u;o[i++]=0===a?0:a}}return o}function mi(t){return"number"==typeof t?t:xs(t)?Ot:+t}function gi(t){if("string"==typeof t)return t;if(_f(t))return f(t,gi)+"";if(xs(t))return vc?vc.call(t):"";var e=t+"";return"0"==e&&1/t==-Pt?"-0":e}function yi(t,e,n){var r=-1,i=h,o=t.length,a=!0,u=[],s=u;if(n)a=!1,i=c;else if(o>=rt){var l=e?null:wc(t);if(l)return q(l);a=!1,i=O,s=new yn}else s=e?[]:u;t:for(;++r<o;){var f=t[r],p=e?e(f):f;if(f=n||0!==f?f:0,a&&p===p){for(var d=s.length;d--;)if(s[d]===p)continue t;e&&s.push(p),u.push(f)}else i(s,p,n)||(s!==u&&s.push(p),u.push(f))}return u}function xi(t,e){return e=Ii(e,t),t=Qo(t,e),null==t||delete t[na(Fa(e))]}function _i(t,e,n,r){return li(t,e,n(hr(t,e)),r)}function bi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ci(t,r?0:o,r?o+1:i):ci(t,r?o+1:0,r?i:o)}function Mi(t,e){var n=t;return n instanceof K&&(n=n.value()),d(e,function(t,e){return e.func.apply(e.thisArg,p([t],e.args))},n)}function Si(t,e,n){var r=t.length;if(r<2)return r?yi(t[0]):[];for(var i=-1,o=oh(r);++i<r;)for(var a=t[i],u=-1;++u<r;)u!=i&&(o[i]=Qn(o[i]||a,t[u],e,n));return yi(ir(o,1),e,n)}function Fi(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var u=r<o?e[r]:et;n(a,t[r],u)}return a}function wi(t){return Zu(t)?t:[]}function Di(t){return"function"==typeof t?t:Tl}function Ii(t,e){return _f(t)?t:No(t,e)?[t]:Oc(Rs(t))}function Ai(t,e,n){var r=t.length;return n=n===et?r:n,!e&&n>=r?t:ci(t,e,n)}function Ei(t,e){if(e)return t.slice();var n=t.length,r=Eh?Eh(n):new t.constructor(n);return t.copy(r),r}function Ri(t){var e=new t.constructor(t.byteLength);return new Ah(e).set(new Ah(t)),e}function Pi(t,e){var n=e?Ri(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Ci(t,e,r){var i=e?r(G(t),lt):G(t);return d(i,n,new t.constructor)}function Ti(t){var e=new t.constructor(t.source,Ve.exec(t));return e.lastIndex=t.lastIndex,e}function Oi(t,e,n){var i=e?n(q(t),lt):q(t);return d(i,r,new t.constructor)}function zi(t){return dc?hh(dc.call(t)):{}}function ji(t,e){var n=e?Ri(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Bi(t,e){if(t!==e){var n=t!==et,r=null===t,i=t===t,o=xs(t),a=e!==et,u=null===e,s=e===e,l=xs(e);if(!u&&!l&&!o&&t>e||o&&a&&s&&!u&&!l||r&&a&&s||!n&&s||!i)return 1;if(!r&&!o&&!l&&t<e||l&&n&&i&&!r&&!o||u&&n&&i||!a&&i||!s)return-1}return 0}function Ni(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,u=n.length;++r<a;){var s=Bi(i[r],o[r]);if(s){if(r>=u)return s;var l=n[r];return s*("desc"==l?-1:1)}}return t.index-e.index}function Ui(t,e,n,r){for(var i=-1,o=t.length,a=n.length,u=-1,s=e.length,l=Xh(o-a,0),h=oh(s+l),c=!r;++u<s;)h[u]=e[u];for(;++i<a;)(c||i<o)&&(h[n[i]]=t[i]);for(;l--;)h[u++]=t[i++];return h}function ki(t,e,n,r){for(var i=-1,o=t.length,a=-1,u=n.length,s=-1,l=e.length,h=Xh(o-u,0),c=oh(h+l),f=!r;++i<h;)c[i]=t[i];for(var p=i;++s<l;)c[p+s]=e[s];for(;++a<u;)(f||i<o)&&(c[p+n[a]]=t[i++]);return c}function Li(t,e){var n=-1,r=t.length;for(e||(e=oh(r));++n<r;)e[n]=t[n];return e}function Wi(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var u=e[o],s=r?r(n[u],t[u],u,n,t):et;s===et&&(s=t[u]),i?Nn(n,u,s):Tn(n,u,s)}return n}function Gi(t,e){return Wi(t,Ic(t),e)}function Vi(t,e){return Wi(t,Ac(t),e)}function Yi(t,e){return function(n,r){var i=_f(n)?o:zn,a=e?e():{};return i(n,t,So(r,2),a)}}function qi(t){return ai(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:et,a=i>2?n[2]:et;for(o=t.length>3&&"function"==typeof o?(i--,o):et,a&&Bo(n[0],n[1],a)&&(o=i<3?et:o,i=1),e=hh(e);++r<i;){var u=n[r];u&&t(e,u,r,o)}return e})}function Hi(t,e){return function(n,r){if(null==n)return n;if(!$u(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=hh(n);(e?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function Xi(t){return function(e,n,r){for(var i=-1,o=hh(e),a=r(e),u=a.length;u--;){var s=a[t?u:++i];if(n(o[s],s,o)===!1)break}return e}}function $i(t,e,n){function r(){var e=this&&this!==or&&this instanceof r?o:t;return e.apply(i?n:this,arguments)}var i=e&dt,o=Ki(t);return r}function Zi(t){return function(e){e=Rs(e);var n=k(e)?Q(e):et,r=n?n[0]:e.charAt(0),i=n?Ai(n,1).join(""):e.slice(1);return r[t]()+i}}function Qi(t){return function(e){return d(Al(sl(e).replace(Ln,"")),t,"")}}function Ki(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=mc(t.prototype),r=t.apply(n,e);return us(r)?r:n}}function Ji(t,e,n){function r(){for(var a=arguments.length,u=oh(a),s=a,l=Mo(r);s--;)u[s]=arguments[s];var h=a<3&&u[0]!==l&&u[a-1]!==l?[]:Y(u,l);if(a-=h.length,a<n)return ho(t,e,no,r.placeholder,et,u,h,et,et,n-a);var c=this&&this!==or&&this instanceof r?o:t;return i(c,this,u)}var o=Ki(t);return r}function to(t){return function(e,n,r){var i=hh(e);if(!$u(e)){var o=So(n,3);e=Gs(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:et}}function eo(t){return yo(function(e){var n=e.length,r=n,i=X.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new ph(ot);if(i&&!a&&"wrapper"==bo(o))var a=new X([],!0)}for(r=a?r:n;++r<n;){o=e[r];var u=bo(o),s="wrapper"==u?Dc(o):et;a=s&&ko(s[0])&&s[1]==(bt|gt|xt|Mt)&&!s[4].length&&1==s[9]?a[bo(s[0])].apply(a,s[3]):1==o.length&&ko(o)?a[u]():a.thru(o)}return function(){var t=arguments,r=t[0];if(a&&1==t.length&&_f(r)&&r.length>=rt)return a.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function no(t,e,n,r,i,o,a,u,s,l){function h(){for(var g=arguments.length,y=oh(g),x=g;x--;)y[x]=arguments[x];if(d)var _=Mo(h),b=B(y,_);if(r&&(y=Ui(y,r,i,d)),o&&(y=ki(y,o,a,d)),g-=b,d&&g<l){var M=Y(y,_);return ho(t,e,no,h.placeholder,n,y,M,u,s,l-g)}var S=f?n:this,F=p?S[t]:t;return g=y.length,u?y=Ko(y,u):v&&g>1&&y.reverse(),c&&s<g&&(y.length=s),this&&this!==or&&this instanceof h&&(F=m||Ki(F)),F.apply(S,y)}var c=e&bt,f=e&dt,p=e&vt,d=e&(gt|yt),v=e&St,m=p?et:Ki(t);return h}function ro(t,e){return function(n,r){return Ar(n,t,e(r),{})}}function io(t,e){return function(n,r){var i;if(n===et&&r===et)return e;if(n!==et&&(i=n),r!==et){if(i===et)return r;"string"==typeof n||"string"==typeof r?(n=gi(n),r=gi(r)):(n=mi(n),r=mi(r)),i=t(n,r)}return i}}function oo(t){return yo(function(e){return e=f(e,C(So())),ai(function(n){var r=this;return t(e,function(t){return i(t,r,n)})})})}function ao(t,e){e=e===et?" ":gi(e);var n=e.length;if(n<2)return n?oi(e,t):e;var r=oi(e,Lh(t/Z(e)));return k(e)?Ai(Q(r),0,t).join(""):r.slice(0,t)}function uo(t,e,n,r){function o(){for(var e=-1,s=arguments.length,l=-1,h=r.length,c=oh(h+s),f=this&&this!==or&&this instanceof o?u:t;++l<h;)c[l]=r[l];for(;s--;)c[l++]=arguments[++e];return i(f,a?n:this,c)}var a=e&dt,u=Ki(t);return o}function so(t){return function(e,n,r){return r&&"number"!=typeof r&&Bo(e,n,r)&&(n=r=et),e=Fs(e),n===et?(n=e,e=0):n=Fs(n),r=r===et?e<n?1:-1:Fs(r),ii(e,n,r,t)}}function lo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Is(e),n=Is(n)),t(e,n)}}function ho(t,e,n,r,i,o,a,u,s,l){var h=e&gt,c=h?a:et,f=h?et:a,p=h?o:et,d=h?et:o;e|=h?xt:_t,e&=~(h?_t:xt),e&mt||(e&=~(dt|vt));var v=[t,e,i,p,c,d,f,u,s,l],m=n.apply(et,v);return ko(t)&&Pc(m,v),m.placeholder=r,Jo(m,t,e)}function co(t){var e=lh[t];return function(t,n){if(t=Is(t),n=$h(ws(n),292)){var r=(Rs(t)+"e").split("e"),i=e(r[0]+"e"+(+r[1]+n));return r=(Rs(i)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return e(t)}}function fo(t){return function(e){var n=Ec(e);return n==Xt?G(e):n==ee?H(e):P(e,t(e))}}function po(t,e,n,r,i,o,a,u){var s=e&vt;if(!s&&"function"!=typeof t)throw new ph(ot);var l=r?r.length:0;if(l||(e&=~(xt|_t),r=i=et),a=a===et?a:Xh(ws(a),0),u=u===et?u:ws(u),l-=i?i.length:0,e&_t){var h=r,c=i;r=i=et}var f=s?et:Dc(t),p=[t,e,n,r,i,h,c,o,a,u];if(f&&qo(p,f),t=p[0],e=p[1],n=p[2],r=p[3],i=p[4],u=p[9]=null==p[9]?s?0:t.length:Xh(p[9]-l,0),!u&&e&(gt|yt)&&(e&=~(gt|yt)),e&&e!=dt)d=e==gt||e==yt?Ji(t,e,u):e!=xt&&e!=(dt|xt)||i.length?no.apply(et,p):uo(t,e,n,r);else var d=$i(t,e,n);var v=f?bc:Pc;return Jo(v(d,p),t,e)}function vo(t,e,n,r,i,o){var a=n&ft,u=t.length,s=e.length;if(u!=s&&!(a&&s>u))return!1;var l=o.get(t);if(l&&o.get(e))return l==e;var h=-1,c=!0,f=n&pt?new yn:et;for(o.set(t,e),o.set(e,t);++h<u;){var p=t[h],d=e[h];if(r)var v=a?r(d,p,h,e,t,o):r(p,d,h,t,e,o);if(v!==et){if(v)continue;c=!1;break}if(f){if(!m(e,function(t,e){if(!O(f,e)&&(p===t||i(p,t,n,r,o)))return f.push(e)})){c=!1;break}}else if(p!==d&&!i(p,d,n,r,o)){c=!1;break}}return o.delete(t),o.delete(e),c}function mo(t,e,n,r,i,o,a){switch(n){case se:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ue:return!(t.byteLength!=e.byteLength||!o(new Ah(t),new Ah(e)));case Wt:case Gt:case $t:return Xu(+t,+e);case Yt:return t.name==e.name&&t.message==e.message;case te:case ne:return t==e+"";case Xt:var u=G;case ee:var s=r&ft;if(u||(u=q),t.size!=e.size&&!s)return!1;var l=a.get(t);if(l)return l==e;r|=pt,a.set(t,e);var h=vo(u(t),u(e),r,i,o,a);return a.delete(t),h;case re:if(dc)return dc.call(t)==dc.call(e)}return!1}function go(t,e,n,r,i,o){var a=n&ft,u=Gs(t),s=u.length,l=Gs(e),h=l.length;if(s!=h&&!a)return!1;for(var c=s;c--;){var f=u[c];if(!(a?f in e:xh.call(e,f)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var d=!0;o.set(t,e),o.set(e,t);for(var v=a;++c<s;){f=u[c];var m=t[f],g=e[f];if(r)var y=a?r(g,m,f,e,t,o):r(m,g,f,t,e,o);if(!(y===et?m===g||i(m,g,n,r,o):y)){d=!1;break}v||(v="constructor"==f)}if(d&&!v){var x=t.constructor,_=e.constructor;x!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof x&&x instanceof x&&"function"==typeof _&&_ instanceof _)&&(d=!1)}return o.delete(t),o.delete(e),d}function yo(t){return Tc(Zo(t,et,ma),t+"")}function xo(t){return gr(t,Gs,Ic)}function _o(t){return gr(t,Vs,Ac)}function bo(t){for(var e=t.name+"",n=uc[e],r=xh.call(uc,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Mo(t){var e=xh.call(g,"placeholder")?g:t;return e.placeholder}function So(){var t=g.iteratee||Ol;return t=t===Ol?Lr:t,arguments.length?t(arguments[0],arguments[1]):t}function Fo(t,e){var n=t.__data__;return Uo(e)?n["string"==typeof e?"string":"hash"]:n.map}function wo(t){for(var e=Gs(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Go(i)]}return e}function Do(t,e){var n=U(t,e);return Br(n)?n:et}function Io(t){var e=xh.call(t,jh),n=t[jh];try{t[jh]=et;var r=!0}catch(t){}var i=Mh.call(t);return r&&(e?t[jh]=n:delete t[jh]),i}function Ao(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=$h(e,t+a);break;case"takeRight":t=Xh(t,e-a)}}return{start:t,end:e}}function Eo(t){var e=t.match(Ue);return e?e[1].split(ke):[]}function Ro(t,e,n){e=Ii(e,t);for(var r=-1,i=e.length,o=!1;++r<i;){var a=na(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:(i=null==t?0:t.length,!!i&&as(i)&&jo(a,i)&&(_f(t)||xf(t)))}function Po(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&xh.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Co(t){return"function"!=typeof t.constructor||Wo(t)?{}:mc(Rh(t))}function To(t,e,n,r){var i=t.constructor;switch(e){case ue:return Ri(t);case Wt:case Gt:return new i(+t);case se:return Pi(t,r);case le:case he:case ce:case fe:case pe:case de:case ve:case me:case ge:return ji(t,r);case Xt:return Ci(t,r,n);case $t:case ne:return new i(t);case te:return Ti(t);case ee:return Oi(t,r,n);case re:return zi(t)}}function Oo(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Ne,"{\n/* [wrapped with "+e+"] */\n")}function zo(t){return _f(t)||xf(t)||!!(Oh&&t&&t[Oh])}function jo(t,e){return e=null==e?Ct:e,!!e&&("number"==typeof t||$e.test(t))&&t>-1&&t%1==0&&t<e}function Bo(t,e,n){if(!us(n))return!1;var r=typeof e;return!!("number"==r?$u(n)&&jo(e,n.length):"string"==r&&e in n)&&Xu(n[e],t)}function No(t,e){if(_f(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!xs(t))||(Re.test(t)||!Ee.test(t)||null!=e&&t in hh(e))}function Uo(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function ko(t){var e=bo(t),n=g[e];if("function"!=typeof n||!(e in K.prototype))return!1;if(t===n)return!0;var r=Dc(n);return!!r&&t===r[0]}function Lo(t){return!!bh&&bh in t}function Wo(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||mh;return t===n}function Go(t){return t===t&&!us(t)}function Vo(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==et||t in hh(n)))}}function Yo(t){var e=Ou(t,function(t){return n.size===ut&&n.clear(),t}),n=e.cache;return e}function qo(t,e){var n=t[1],r=e[1],i=n|r,o=i<(dt|vt|bt),a=r==bt&&n==gt||r==bt&&n==Mt&&t[7].length<=e[8]||r==(bt|Mt)&&e[7].length<=e[8]&&n==gt;if(!o&&!a)return t;r&dt&&(t[2]=e[2],i|=n&dt?0:mt);var u=e[3];if(u){var s=t[3];t[3]=s?Ui(s,u,e[4]):u,t[4]=s?Y(t[3],st):e[4]}return u=e[5],u&&(s=t[5],t[5]=s?ki(s,u,e[6]):u,t[6]=s?Y(t[5],st):e[6]),u=e[7],u&&(t[7]=u),r&bt&&(t[8]=null==t[8]?e[8]:$h(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function Ho(t,e,n,r,i,o){return us(t)&&us(e)&&(o.set(e,t),Xr(t,e,et,Ho,o),o.delete(e)),t}function Xo(t){var e=[];if(null!=t)for(var n in hh(t))e.push(n);return e}function $o(t){return Mh.call(t)}function Zo(t,e,n){return e=Xh(e===et?t.length-1:e,0),function(){for(var r=arguments,o=-1,a=Xh(r.length-e,0),u=oh(a);++o<a;)u[o]=r[e+o];o=-1;for(var s=oh(e+1);++o<e;)s[o]=r[o];return s[e]=n(u),i(t,this,s)}}function Qo(t,e){return e.length<2?t:hr(t,ci(e,0,-1))}function Ko(t,e){for(var n=t.length,r=$h(e.length,n),i=Li(t);r--;){var o=e[r];t[r]=jo(o,n)?i[o]:et}return t}function Jo(t,e,n){var r=e+"";return Tc(t,Oo(r,ia(Eo(r),n)))}function ta(t){var e=0,n=0;return function(){var r=Zh(),i=It-(r-n);if(n=r,i>0){if(++e>=Dt)return arguments[0]}else e=0;return t.apply(et,arguments)}}function ea(t,e){var n=-1,r=t.length,i=r-1;for(e=e===et?r:e;++n<e;){var o=ri(n,i),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}function na(t){if("string"==typeof t||xs(t))return t;var e=t+"";return"0"==e&&1/t==-Pt?"-0":e}function ra(t){if(null!=t){try{return yh.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function ia(t,e){return a(Nt,function(n){var r="_."+n[0];e&n[1]&&!h(t,r)&&t.push(r)}),t.sort()}function oa(t){if(t instanceof K)return t.clone();var e=new X(t.__wrapped__,t.__chain__);return e.__actions__=Li(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function aa(t,e,n){e=(n?Bo(t,e,n):e===et)?1:Xh(ws(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,a=oh(Lh(r/e));i<r;)a[o++]=ci(t,i,i+=e);return a}function ua(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i}function sa(){var t=arguments.length;if(!t)return[];for(var e=oh(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return p(_f(n)?Li(n):[n],ir(e,1))}function la(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===et?1:ws(e),ci(t,e<0?0:e,r)):[]}function ha(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===et?1:ws(e),e=r-e,ci(t,0,e<0?0:e)):[]}function ca(t,e){return t&&t.length?bi(t,So(e,3),!0,!0):[]}function fa(t,e){return t&&t.length?bi(t,So(e,3),!0):[]}function pa(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Bo(t,e,n)&&(n=0,r=i),tr(t,e,n,r)):[]}function da(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ws(n);return i<0&&(i=Xh(r+i,0)),_(t,So(e,3),i)}function va(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==et&&(i=ws(n),i=n<0?Xh(r+i,0):$h(i,r-1)),_(t,So(e,3),i,!0)}function ma(t){var e=null==t?0:t.length;return e?ir(t,1):[]}function ga(t){var e=null==t?0:t.length;return e?ir(t,Pt):[]}function ya(t,e){var n=null==t?0:t.length;return n?(e=e===et?1:ws(e),ir(t,e)):[]}function xa(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function _a(t){return t&&t.length?t[0]:et}function ba(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ws(n);return i<0&&(i=Xh(r+i,0)),b(t,e,i)}function Ma(t){var e=null==t?0:t.length;return e?ci(t,0,-1):[]}function Sa(t,e){return null==t?"":qh.call(t,e)}function Fa(t){var e=null==t?0:t.length;return e?t[e-1]:et}function wa(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==et&&(i=ws(n),i=i<0?Xh(r+i,0):$h(i,r-1)),e===e?$(t,e,i):_(t,S,i,!0)}function Da(t,e){return t&&t.length?Zr(t,ws(e)):et}function Ia(t,e){return t&&t.length&&e&&e.length?ei(t,e):t}function Aa(t,e,n){return t&&t.length&&e&&e.length?ei(t,e,So(n,2)):t}function Ea(t,e,n){return t&&t.length&&e&&e.length?ei(t,e,et,n):t}function Ra(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=So(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return ni(t,i),n}function Pa(t){return null==t?t:Jh.call(t)}function Ca(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Bo(t,e,n)?(e=0,n=r):(e=null==e?0:ws(e),n=n===et?r:ws(n)),ci(t,e,n)):[]}function Ta(t,e){return pi(t,e)}function Oa(t,e,n){return di(t,e,So(n,2))}function za(t,e){var n=null==t?0:t.length;if(n){var r=pi(t,e);if(r<n&&Xu(t[r],e))return r}return-1}function ja(t,e){return pi(t,e,!0)}function Ba(t,e,n){return di(t,e,So(n,2),!0)}function Na(t,e){var n=null==t?0:t.length;if(n){var r=pi(t,e,!0)-1;if(Xu(t[r],e))return r}return-1}function Ua(t){return t&&t.length?vi(t):[]}function ka(t,e){return t&&t.length?vi(t,So(e,2)):[]}function La(t){var e=null==t?0:t.length;return e?ci(t,1,e):[]}function Wa(t,e,n){return t&&t.length?(e=n||e===et?1:ws(e),ci(t,0,e<0?0:e)):[]}function Ga(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===et?1:ws(e),e=r-e,ci(t,e<0?0:e,r)):[]}function Va(t,e){return t&&t.length?bi(t,So(e,3),!1,!0):[]}function Ya(t,e){return t&&t.length?bi(t,So(e,3)):[]}function qa(t){return t&&t.length?yi(t):[]}function Ha(t,e){return t&&t.length?yi(t,So(e,2)):[]}function Xa(t,e){return e="function"==typeof e?e:et,t&&t.length?yi(t,et,e):[]}function $a(t){if(!t||!t.length)return[];var e=0;return t=l(t,function(t){if(Zu(t))return e=Xh(t.length,e),!0}),R(e,function(e){return f(t,w(e))})}function Za(t,e){if(!t||!t.length)return[];var n=$a(t);return null==e?n:f(n,function(t){return i(e,et,t)})}function Qa(t,e){return Fi(t||[],e||[],Tn)}function Ka(t,e){return Fi(t||[],e||[],li)}function Ja(t){var e=g(t);return e.__chain__=!0,e}function tu(t,e){return e(t),t}function eu(t,e){return e(t)}function nu(){return Ja(this)}function ru(){return new X(this.value(),this.__chain__)}function iu(){this.__values__===et&&(this.__values__=Ss(this.value()));var t=this.__index__>=this.__values__.length,e=t?et:this.__values__[this.__index__++];return{done:t,value:e}}function ou(){return this}function au(t){for(var e,n=this;n instanceof D;){var r=oa(n);r.__index__=0,r.__values__=et,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e}function uu(){var t=this.__wrapped__;if(t instanceof K){var e=t;return this.__actions__.length&&(e=new K(this)),e=e.reverse(),e.__actions__.push({func:eu,args:[Pa],thisArg:et}),new X(e,this.__chain__)}return this.thru(Pa)}function su(){return Mi(this.__wrapped__,this.__actions__)}function lu(t,e,n){var r=_f(t)?s:Kn;return n&&Bo(t,e,n)&&(e=et),r(t,So(e,3))}function hu(t,e){var n=_f(t)?l:rr;return n(t,So(e,3))}function cu(t,e){return ir(gu(t,e),1)}function fu(t,e){return ir(gu(t,e),Pt)}function pu(t,e,n){return n=n===et?1:ws(n),ir(gu(t,e),n)}function du(t,e){var n=_f(t)?a:gc;return n(t,So(e,3))}function vu(t,e){var n=_f(t)?u:yc;return n(t,So(e,3))}function mu(t,e,n,r){t=$u(t)?t:nl(t),n=n&&!r?ws(n):0;var i=t.length;return n<0&&(n=Xh(i+n,0)),ys(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&b(t,e,n)>-1}function gu(t,e){var n=_f(t)?f:Yr;return n(t,So(e,3))}function yu(t,e,n,r){return null==t?[]:(_f(e)||(e=null==e?[]:[e]),n=r?et:n,_f(n)||(n=null==n?[]:[n]),Qr(t,e,n))}function xu(t,e,n){var r=_f(t)?d:I,i=arguments.length<3;return r(t,So(e,4),n,i,gc)}function _u(t,e,n){var r=_f(t)?v:I,i=arguments.length<3;return r(t,So(e,4),n,i,yc)}function bu(t,e){var n=_f(t)?l:rr;return n(t,zu(So(e,3)))}function Mu(t){var e=_f(t)?An:ui;return e(t)}function Su(t,e,n){e=(n?Bo(t,e,n):e===et)?1:ws(e);var r=_f(t)?En:si;return r(t,e)}function Fu(t){var e=_f(t)?Rn:hi;return e(t)}function wu(t){if(null==t)return 0;if($u(t))return ys(t)?Z(t):t.length;var e=Ec(t);return e==Xt||e==ee?t.size:Wr(t).length}function Du(t,e,n){var r=_f(t)?m:fi;return n&&Bo(t,e,n)&&(e=et),r(t,So(e,3))}function Iu(t,e){if("function"!=typeof e)throw new ph(ot);
return t=ws(t),function(){if(--t<1)return e.apply(this,arguments)}}function Au(t,e,n){return e=n?et:e,e=t&&null==e?t.length:e,po(t,bt,et,et,et,et,e)}function Eu(t,e){var n;if("function"!=typeof e)throw new ph(ot);return t=ws(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=et),n}}function Ru(t,e,n){e=n?et:e;var r=po(t,gt,et,et,et,et,et,e);return r.placeholder=Ru.placeholder,r}function Pu(t,e,n){e=n?et:e;var r=po(t,yt,et,et,et,et,et,e);return r.placeholder=Pu.placeholder,r}function Cu(t,e,n){function r(e){var n=f,r=p;return f=p=et,y=e,v=t.apply(r,n)}function i(t){return y=t,m=Cc(u,e),x?r(t):v}function o(t){var n=t-g,r=t-y,i=e-n;return _?$h(i,d-r):i}function a(t){var n=t-g,r=t-y;return g===et||n>=e||n<0||_&&r>=d}function u(){var t=sf();return a(t)?s(t):void(m=Cc(u,o(t)))}function s(t){return m=et,b&&f?r(t):(f=p=et,v)}function l(){m!==et&&Fc(m),y=0,f=g=p=m=et}function h(){return m===et?v:s(sf())}function c(){var t=sf(),n=a(t);if(f=arguments,p=this,g=t,n){if(m===et)return i(g);if(_)return m=Cc(u,e),r(g)}return m===et&&(m=Cc(u,e)),v}var f,p,d,v,m,g,y=0,x=!1,_=!1,b=!0;if("function"!=typeof t)throw new ph(ot);return e=Is(e)||0,us(n)&&(x=!!n.leading,_="maxWait"in n,d=_?Xh(Is(n.maxWait)||0,e):d,b="trailing"in n?!!n.trailing:b),c.cancel=l,c.flush=h,c}function Tu(t){return po(t,St)}function Ou(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new ph(ot);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Ou.Cache||fn),n}function zu(t){if("function"!=typeof t)throw new ph(ot);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function ju(t){return Eu(2,t)}function Bu(t,e){if("function"!=typeof t)throw new ph(ot);return e=e===et?e:ws(e),ai(t,e)}function Nu(t,e){if("function"!=typeof t)throw new ph(ot);return e=e===et?0:Xh(ws(e),0),ai(function(n){var r=n[e],o=Ai(n,0,e);return r&&p(o,r),i(t,this,o)})}function Uu(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new ph(ot);return us(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Cu(t,e,{leading:r,maxWait:e,trailing:i})}function ku(t){return Au(t,1)}function Lu(t,e){return df(Di(e),t)}function Wu(){if(!arguments.length)return[];var t=arguments[0];return _f(t)?t:[t]}function Gu(t){return Gn(t,ct)}function Vu(t,e){return e="function"==typeof e?e:et,Gn(t,ct,e)}function Yu(t){return Gn(t,lt|ct)}function qu(t,e){return e="function"==typeof e?e:et,Gn(t,lt|ct,e)}function Hu(t,e){return null==e||Yn(t,e,Gs(e))}function Xu(t,e){return t===e||t!==t&&e!==e}function $u(t){return null!=t&&as(t.length)&&!is(t)}function Zu(t){return ss(t)&&$u(t)}function Qu(t){return t===!0||t===!1||ss(t)&&br(t)==Wt}function Ku(t){return ss(t)&&1===t.nodeType&&!ms(t)}function Ju(t){if(null==t)return!0;if($u(t)&&(_f(t)||"string"==typeof t||"function"==typeof t.splice||Mf(t)||If(t)||xf(t)))return!t.length;var e=Ec(t);if(e==Xt||e==ee)return!t.size;if(Wo(t))return!Wr(t).length;for(var n in t)if(xh.call(t,n))return!1;return!0}function ts(t,e){return Tr(t,e)}function es(t,e,n){n="function"==typeof n?n:et;var r=n?n(t,e):et;return r===et?Tr(t,e,et,n):!!r}function ns(t){if(!ss(t))return!1;var e=br(t);return e==Yt||e==Vt||"string"==typeof t.message&&"string"==typeof t.name&&!ms(t)}function rs(t){return"number"==typeof t&&Yh(t)}function is(t){if(!us(t))return!1;var e=br(t);return e==qt||e==Ht||e==Lt||e==Jt}function os(t){return"number"==typeof t&&t==ws(t)}function as(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Ct}function us(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ss(t){return null!=t&&"object"==typeof t}function ls(t,e){return t===e||jr(t,e,wo(e))}function hs(t,e,n){return n="function"==typeof n?n:et,jr(t,e,wo(e),n)}function cs(t){return vs(t)&&t!=+t}function fs(t){if(Rc(t))throw new uh(it);return Br(t)}function ps(t){return null===t}function ds(t){return null==t}function vs(t){return"number"==typeof t||ss(t)&&br(t)==$t}function ms(t){if(!ss(t)||br(t)!=Qt)return!1;var e=Rh(t);if(null===e)return!0;var n=xh.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&yh.call(n)==Sh}function gs(t){return os(t)&&t>=-Ct&&t<=Ct}function ys(t){return"string"==typeof t||!_f(t)&&ss(t)&&br(t)==ne}function xs(t){return"symbol"==typeof t||ss(t)&&br(t)==re}function _s(t){return t===et}function bs(t){return ss(t)&&Ec(t)==oe}function Ms(t){return ss(t)&&br(t)==ae}function Ss(t){if(!t)return[];if($u(t))return ys(t)?Q(t):Li(t);if(zh&&t[zh])return W(t[zh]());var e=Ec(t),n=e==Xt?G:e==ee?q:nl;return n(t)}function Fs(t){if(!t)return 0===t?t:0;if(t=Is(t),t===Pt||t===-Pt){var e=t<0?-1:1;return e*Tt}return t===t?t:0}function ws(t){var e=Fs(t),n=e%1;return e===e?n?e-n:e:0}function Ds(t){return t?kn(ws(t),0,zt):0}function Is(t){if("number"==typeof t)return t;if(xs(t))return Ot;if(us(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=us(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ze,"");var n=qe.test(t);return n||Xe.test(t)?nr(t.slice(2),n?2:8):Ye.test(t)?Ot:+t}function As(t){return Wi(t,Vs(t))}function Es(t){return kn(ws(t),-Ct,Ct)}function Rs(t){return null==t?"":gi(t)}function Ps(t,e){var n=mc(t);return null==e?n:jn(n,e)}function Cs(t,e){return x(t,So(e,3),ar)}function Ts(t,e){return x(t,So(e,3),ur)}function Os(t,e){return null==t?t:xc(t,So(e,3),Vs)}function zs(t,e){return null==t?t:_c(t,So(e,3),Vs)}function js(t,e){return t&&ar(t,So(e,3))}function Bs(t,e){return t&&ur(t,So(e,3))}function Ns(t){return null==t?[]:lr(t,Gs(t))}function Us(t){return null==t?[]:lr(t,Vs(t))}function ks(t,e,n){var r=null==t?et:hr(t,e);return r===et?n:r}function Ls(t,e){return null!=t&&Ro(t,e,Fr)}function Ws(t,e){return null!=t&&Ro(t,e,wr)}function Gs(t){return $u(t)?In(t):Wr(t)}function Vs(t){return $u(t)?In(t,!0):Gr(t)}function Ys(t,e){var n={};return e=So(e,3),ar(t,function(t,r,i){Nn(n,e(t,r,i),t)}),n}function qs(t,e){var n={};return e=So(e,3),ar(t,function(t,r,i){Nn(n,r,e(t,r,i))}),n}function Hs(t,e){return Xs(t,zu(So(e)))}function Xs(t,e){if(null==t)return{};var n=f(_o(t),function(t){return[t]});return e=So(e),Jr(t,n,function(t,n){return e(t,n[0])})}function $s(t,e,n){e=Ii(e,t);var r=-1,i=e.length;for(i||(i=1,t=et);++r<i;){var o=null==t?et:t[na(e[r])];o===et&&(r=i,o=n),t=is(o)?o.call(t):o}return t}function Zs(t,e,n){return null==t?t:li(t,e,n)}function Qs(t,e,n,r){return r="function"==typeof r?r:et,null==t?t:li(t,e,n,r)}function Ks(t,e,n){var r=_f(t),i=r||Mf(t)||If(t);if(e=So(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:us(t)&&is(o)?mc(Rh(t)):{}}return(i?a:ar)(t,function(t,r,i){return e(n,t,r,i)}),n}function Js(t,e){return null==t||xi(t,e)}function tl(t,e,n){return null==t?t:_i(t,e,Di(n))}function el(t,e,n,r){return r="function"==typeof r?r:et,null==t?t:_i(t,e,Di(n),r)}function nl(t){return null==t?[]:T(t,Gs(t))}function rl(t){return null==t?[]:T(t,Vs(t))}function il(t,e,n){return n===et&&(n=e,e=et),n!==et&&(n=Is(n),n=n===n?n:0),e!==et&&(e=Is(e),e=e===e?e:0),kn(Is(t),e,n)}function ol(t,e,n){return e=Fs(e),n===et?(n=e,e=0):n=Fs(n),t=Is(t),Dr(t,e,n)}function al(t,e,n){if(n&&"boolean"!=typeof n&&Bo(t,e,n)&&(e=n=et),n===et&&("boolean"==typeof e?(n=e,e=et):"boolean"==typeof t&&(n=t,t=et)),t===et&&e===et?(t=0,e=1):(t=Fs(t),e===et?(e=t,t=0):e=Fs(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Kh();return $h(t+i*(e-t+er("1e-"+((i+"").length-1))),e)}return ri(t,e)}function ul(t){return Jf(Rs(t).toLowerCase())}function sl(t){return t=Rs(t),t&&t.replace(Ze,yr).replace(Wn,"")}function ll(t,e,n){t=Rs(t),e=gi(e);var r=t.length;n=n===et?r:kn(ws(n),0,r);var i=n;return n-=e.length,n>=0&&t.slice(n,i)==e}function hl(t){return t=Rs(t),t&&Fe.test(t)?t.replace(Me,xr):t}function cl(t){return t=Rs(t),t&&Oe.test(t)?t.replace(Te,"\\$&"):t}function fl(t,e,n){t=Rs(t),e=ws(e);var r=e?Z(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return ao(Wh(i),n)+t+ao(Lh(i),n)}function pl(t,e,n){t=Rs(t),e=ws(e);var r=e?Z(t):0;return e&&r<e?t+ao(e-r,n):t}function dl(t,e,n){t=Rs(t),e=ws(e);var r=e?Z(t):0;return e&&r<e?ao(e-r,n)+t:t}function vl(t,e,n){return n||null==e?e=0:e&&(e=+e),Qh(Rs(t).replace(je,""),e||0)}function ml(t,e,n){return e=(n?Bo(t,e,n):e===et)?1:ws(e),oi(Rs(t),e)}function gl(){var t=arguments,e=Rs(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function yl(t,e,n){return n&&"number"!=typeof n&&Bo(t,e,n)&&(e=n=et),(n=n===et?zt:n>>>0)?(t=Rs(t),t&&("string"==typeof e||null!=e&&!wf(e))&&(e=gi(e),!e&&k(t))?Ai(Q(t),0,n):t.split(e,n)):[]}function xl(t,e,n){return t=Rs(t),n=kn(ws(n),0,t.length),e=gi(e),t.slice(n,n+e.length)==e}function _l(t,e,n){var r=g.templateSettings;n&&Bo(t,e,n)&&(e=et),t=Rs(t),e=Cf({},e,r,Pn);var i,o,a=Cf({},e.imports,r.imports,Pn),u=Gs(a),s=T(a,u),l=0,h=e.interpolate||Qe,c="__p += '",f=ch((e.escape||Qe).source+"|"+h.source+"|"+(h===Ae?Ge:Qe).source+"|"+(e.evaluate||Qe).source+"|$","g"),p="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++Xn+"]")+"\n";t.replace(f,function(e,n,r,a,u,s){return r||(r=a),c+=t.slice(l,s).replace(Ke,N),n&&(i=!0,c+="' +\n__e("+n+") +\n'"),u&&(o=!0,c+="';\n"+u+";\n__p += '"),r&&(c+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=s+e.length,e}),c+="';\n";var d=e.variable;d||(c="with (obj) {\n"+c+"\n}\n"),c=(o?c.replace(ye,""):c).replace(xe,"$1").replace(_e,"$1;"),c="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+c+"return __p\n}";var v=tp(function(){return sh(u,p+"return "+c).apply(et,s)});if(v.source=c,ns(v))throw v;return v}function bl(t){return Rs(t).toLowerCase()}function Ml(t){return Rs(t).toUpperCase()}function Sl(t,e,n){if(t=Rs(t),t&&(n||e===et))return t.replace(ze,"");if(!t||!(e=gi(e)))return t;var r=Q(t),i=Q(e),o=z(r,i),a=j(r,i)+1;return Ai(r,o,a).join("")}function Fl(t,e,n){if(t=Rs(t),t&&(n||e===et))return t.replace(Be,"");if(!t||!(e=gi(e)))return t;var r=Q(t),i=j(r,Q(e))+1;return Ai(r,0,i).join("")}function wl(t,e,n){if(t=Rs(t),t&&(n||e===et))return t.replace(je,"");if(!t||!(e=gi(e)))return t;var r=Q(t),i=z(r,Q(e));return Ai(r,i).join("")}function Dl(t,e){var n=Ft,r=wt;if(us(e)){var i="separator"in e?e.separator:i;n="length"in e?ws(e.length):n,r="omission"in e?gi(e.omission):r}t=Rs(t);var o=t.length;if(k(t)){var a=Q(t);o=a.length}if(n>=o)return t;var u=n-Z(r);if(u<1)return r;var s=a?Ai(a,0,u).join(""):t.slice(0,u);if(i===et)return s+r;if(a&&(u+=s.length-u),wf(i)){if(t.slice(u).search(i)){var l,h=s;for(i.global||(i=ch(i.source,Rs(Ve.exec(i))+"g")),i.lastIndex=0;l=i.exec(h);)var c=l.index;s=s.slice(0,c===et?u:c)}}else if(t.indexOf(gi(i),u)!=u){var f=s.lastIndexOf(i);f>-1&&(s=s.slice(0,f))}return s+r}function Il(t){return t=Rs(t),t&&Se.test(t)?t.replace(be,_r):t}function Al(t,e,n){return t=Rs(t),e=n?et:e,e===et?L(t)?tt(t):y(t):t.match(e)||[]}function El(t){var e=null==t?0:t.length,n=So();return t=e?f(t,function(t){if("function"!=typeof t[1])throw new ph(ot);return[n(t[0]),t[1]]}):[],ai(function(n){for(var r=-1;++r<e;){var o=t[r];if(i(o[0],this,n))return i(o[1],this,n)}})}function Rl(t){return Vn(Gn(t,lt))}function Pl(t){return function(){return t}}function Cl(t,e){return null==t||t!==t?e:t}function Tl(t){return t}function Ol(t){return Lr("function"==typeof t?t:Gn(t,lt))}function zl(t){return qr(Gn(t,lt))}function jl(t,e){return Hr(t,Gn(e,lt))}function Bl(t,e,n){var r=Gs(e),i=lr(e,r);null!=n||us(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=lr(e,Gs(e)));var o=!(us(n)&&"chain"in n&&!n.chain),u=is(t);return a(i,function(n){var r=e[n];t[n]=r,u&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=Li(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,p([this.value()],arguments))})}),t}function Nl(){return or._===this&&(or._=Fh),this}function Ul(){}function kl(t){return t=ws(t),ai(function(e){return Zr(e,t)})}function Ll(t){return No(t)?w(na(t)):ti(t)}function Wl(t){return function(e){return null==t?et:hr(t,e)}}function Gl(){return[]}function Vl(){return!1}function Yl(){return{}}function ql(){return""}function Hl(){return!0}function Xl(t,e){if(t=ws(t),t<1||t>Ct)return[];var n=zt,r=$h(t,zt);e=So(e),t-=zt;for(var i=R(r,e);++n<t;)e(n);return i}function $l(t){return _f(t)?f(t,na):xs(t)?[t]:Li(Oc(Rs(t)))}function Zl(t){var e=++_h;return Rs(t)+e}function Ql(t){return t&&t.length?Jn(t,Tl,Sr):et}function Kl(t,e){return t&&t.length?Jn(t,So(e,2),Sr):et}function Jl(t){return F(t,Tl)}function th(t,e){return F(t,So(e,2))}function eh(t){return t&&t.length?Jn(t,Tl,Vr):et}function nh(t,e){return t&&t.length?Jn(t,So(e,2),Vr):et}function rh(t){return t&&t.length?E(t,Tl):0}function ih(t,e){return t&&t.length?E(t,So(e,2)):0}e=null==e?or:Mr.defaults(or.Object(),e,Mr.pick(or,Hn));var oh=e.Array,ah=e.Date,uh=e.Error,sh=e.Function,lh=e.Math,hh=e.Object,ch=e.RegExp,fh=e.String,ph=e.TypeError,dh=oh.prototype,vh=sh.prototype,mh=hh.prototype,gh=e["__core-js_shared__"],yh=vh.toString,xh=mh.hasOwnProperty,_h=0,bh=function(){var t=/[^.]+$/.exec(gh&&gh.keys&&gh.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Mh=mh.toString,Sh=yh.call(hh),Fh=or._,wh=ch("^"+yh.call(xh).replace(Te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Dh=sr?e.Buffer:et,Ih=e.Symbol,Ah=e.Uint8Array,Eh=Dh?Dh.allocUnsafe:et,Rh=V(hh.getPrototypeOf,hh),Ph=hh.create,Ch=mh.propertyIsEnumerable,Th=dh.splice,Oh=Ih?Ih.isConcatSpreadable:et,zh=Ih?Ih.iterator:et,jh=Ih?Ih.toStringTag:et,Bh=function(){try{var t=Do(hh,"defineProperty");return t({},"",{}),t}catch(t){}}(),Nh=e.clearTimeout!==or.clearTimeout&&e.clearTimeout,Uh=ah&&ah.now!==or.Date.now&&ah.now,kh=e.setTimeout!==or.setTimeout&&e.setTimeout,Lh=lh.ceil,Wh=lh.floor,Gh=hh.getOwnPropertySymbols,Vh=Dh?Dh.isBuffer:et,Yh=e.isFinite,qh=dh.join,Hh=V(hh.keys,hh),Xh=lh.max,$h=lh.min,Zh=ah.now,Qh=e.parseInt,Kh=lh.random,Jh=dh.reverse,tc=Do(e,"DataView"),ec=Do(e,"Map"),nc=Do(e,"Promise"),rc=Do(e,"Set"),ic=Do(e,"WeakMap"),oc=Do(hh,"create"),ac=ic&&new ic,uc={},sc=ra(tc),lc=ra(ec),hc=ra(nc),cc=ra(rc),fc=ra(ic),pc=Ih?Ih.prototype:et,dc=pc?pc.valueOf:et,vc=pc?pc.toString:et,mc=function(){function t(){}return function(e){if(!us(e))return{};if(Ph)return Ph(e);t.prototype=e;var n=new t;return t.prototype=et,n}}();g.templateSettings={escape:we,evaluate:Ie,interpolate:Ae,variable:"",imports:{_:g}},g.prototype=D.prototype,g.prototype.constructor=g,X.prototype=mc(D.prototype),X.prototype.constructor=X,K.prototype=mc(D.prototype),K.prototype.constructor=K,Je.prototype.clear=tn,Je.prototype.delete=en,Je.prototype.get=nn,Je.prototype.has=rn,Je.prototype.set=on,an.prototype.clear=un,an.prototype.delete=sn,an.prototype.get=ln,an.prototype.has=hn,an.prototype.set=cn,fn.prototype.clear=pn,fn.prototype.delete=dn,fn.prototype.get=vn,fn.prototype.has=mn,fn.prototype.set=gn,yn.prototype.add=yn.prototype.push=xn,yn.prototype.has=_n,bn.prototype.clear=Mn,bn.prototype.delete=Sn,bn.prototype.get=Fn,bn.prototype.has=wn,bn.prototype.set=Dn;var gc=Hi(ar),yc=Hi(ur,!0),xc=Xi(),_c=Xi(!0),bc=ac?function(t,e){return ac.set(t,e),t}:Tl,Mc=Bh?function(t,e){return Bh(t,"toString",{configurable:!0,enumerable:!1,value:Pl(e),writable:!0})}:Tl,Sc=ai,Fc=Nh||function(t){return or.clearTimeout(t)},wc=rc&&1/q(new rc([,-0]))[1]==Pt?function(t){return new rc(t)}:Ul,Dc=ac?function(t){return ac.get(t)}:Ul,Ic=Gh?V(Gh,hh):Gl,Ac=Gh?function(t){for(var e=[];t;)p(e,Ic(t)),t=Rh(t);return e}:Gl,Ec=br;(tc&&Ec(new tc(new ArrayBuffer(1)))!=se||ec&&Ec(new ec)!=Xt||nc&&Ec(nc.resolve())!=Kt||rc&&Ec(new rc)!=ee||ic&&Ec(new ic)!=oe)&&(Ec=function(t){var e=br(t),n=e==Qt?t.constructor:et,r=n?ra(n):"";if(r)switch(r){case sc:return se;case lc:return Xt;case hc:return Kt;case cc:return ee;case fc:return oe}return e});var Rc=gh?is:Vl,Pc=ta(bc),Cc=kh||function(t,e){return or.setTimeout(t,e)},Tc=ta(Mc),Oc=Yo(function(t){var e=[];return Pe.test(t)&&e.push(""),t.replace(Ce,function(t,n,r,i){e.push(r?i.replace(We,"$1"):n||t)}),e}),zc=ai(function(t,e){return Zu(t)?Qn(t,ir(e,1,Zu,!0)):[]}),jc=ai(function(t,e){var n=Fa(e);return Zu(n)&&(n=et),Zu(t)?Qn(t,ir(e,1,Zu,!0),So(n,2)):[]}),Bc=ai(function(t,e){var n=Fa(e);return Zu(n)&&(n=et),Zu(t)?Qn(t,ir(e,1,Zu,!0),et,n):[]}),Nc=ai(function(t){var e=f(t,wi);return e.length&&e[0]===t[0]?Ir(e):[]}),Uc=ai(function(t){var e=Fa(t),n=f(t,wi);return e===Fa(n)?e=et:n.pop(),n.length&&n[0]===t[0]?Ir(n,So(e,2)):[]}),kc=ai(function(t){var e=Fa(t),n=f(t,wi);return e="function"==typeof e?e:et,e&&n.pop(),n.length&&n[0]===t[0]?Ir(n,et,e):[]}),Lc=ai(Ia),Wc=yo(function(t,e){var n=null==t?0:t.length,r=Un(t,e);return ni(t,f(e,function(t){return jo(t,n)?+t:t}).sort(Bi)),r}),Gc=ai(function(t){return yi(ir(t,1,Zu,!0))}),Vc=ai(function(t){var e=Fa(t);return Zu(e)&&(e=et),yi(ir(t,1,Zu,!0),So(e,2))}),Yc=ai(function(t){var e=Fa(t);return e="function"==typeof e?e:et,yi(ir(t,1,Zu,!0),et,e)}),qc=ai(function(t,e){return Zu(t)?Qn(t,e):[]}),Hc=ai(function(t){return Si(l(t,Zu))}),Xc=ai(function(t){var e=Fa(t);return Zu(e)&&(e=et),Si(l(t,Zu),So(e,2))}),$c=ai(function(t){var e=Fa(t);return e="function"==typeof e?e:et,Si(l(t,Zu),et,e)}),Zc=ai($a),Qc=ai(function(t){var e=t.length,n=e>1?t[e-1]:et;return n="function"==typeof n?(t.pop(),n):et,Za(t,n)}),Kc=yo(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return Un(e,t)};return!(e>1||this.__actions__.length)&&r instanceof K&&jo(n)?(r=r.slice(n,+n+(e?1:0)),r.__actions__.push({func:eu,args:[i],thisArg:et}),new X(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(et),t})):this.thru(i)}),Jc=Yi(function(t,e,n){xh.call(t,n)?++t[n]:Nn(t,n,1)}),tf=to(da),ef=to(va),nf=Yi(function(t,e,n){xh.call(t,n)?t[n].push(e):Nn(t,n,[e])}),rf=ai(function(t,e,n){var r=-1,o="function"==typeof e,a=$u(t)?oh(t.length):[];return gc(t,function(t){a[++r]=o?i(e,t,n):Er(t,e,n)}),a}),of=Yi(function(t,e,n){Nn(t,n,e)}),af=Yi(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),uf=ai(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Bo(t,e[0],e[1])?e=[]:n>2&&Bo(e[0],e[1],e[2])&&(e=[e[0]]),Qr(t,ir(e,1),[])}),sf=Uh||function(){return or.Date.now()},lf=ai(function(t,e,n){var r=dt;if(n.length){var i=Y(n,Mo(lf));r|=xt}return po(t,r,e,n,i)}),hf=ai(function(t,e,n){var r=dt|vt;if(n.length){var i=Y(n,Mo(hf));r|=xt}return po(e,r,t,n,i)}),cf=ai(function(t,e){return qn(t,1,e)}),ff=ai(function(t,e,n){return qn(t,Is(e)||0,n)});Ou.Cache=fn;var pf=Sc(function(t,e){e=1==e.length&&_f(e[0])?f(e[0],C(So())):f(ir(e,1),C(So()));var n=e.length;return ai(function(r){for(var o=-1,a=$h(r.length,n);++o<a;)r[o]=e[o].call(this,r[o]);return i(t,this,r)})}),df=ai(function(t,e){var n=Y(e,Mo(df));return po(t,xt,et,e,n)}),vf=ai(function(t,e){var n=Y(e,Mo(vf));return po(t,_t,et,e,n)}),mf=yo(function(t,e){return po(t,Mt,et,et,et,e)}),gf=lo(Sr),yf=lo(function(t,e){return t>=e}),xf=Rr(function(){return arguments}())?Rr:function(t){return ss(t)&&xh.call(t,"callee")&&!Ch.call(t,"callee")},_f=oh.isArray,bf=cr?C(cr):Pr,Mf=Vh||Vl,Sf=fr?C(fr):Cr,Ff=pr?C(pr):zr,wf=dr?C(dr):Nr,Df=vr?C(vr):Ur,If=mr?C(mr):kr,Af=lo(Vr),Ef=lo(function(t,e){return t<=e}),Rf=qi(function(t,e){if(Wo(e)||$u(e))return void Wi(e,Gs(e),t);for(var n in e)xh.call(e,n)&&Tn(t,n,e[n])}),Pf=qi(function(t,e){Wi(e,Vs(e),t)}),Cf=qi(function(t,e,n,r){Wi(e,Vs(e),t,r)}),Tf=qi(function(t,e,n,r){Wi(e,Gs(e),t,r)}),Of=yo(Un),zf=ai(function(t){return t.push(et,Pn),i(Cf,et,t)}),jf=ai(function(t){return t.push(et,Ho),i(Lf,et,t)}),Bf=ro(function(t,e,n){t[e]=n},Pl(Tl)),Nf=ro(function(t,e,n){xh.call(t,e)?t[e].push(n):t[e]=[n]},So),Uf=ai(Er),kf=qi(function(t,e,n){Xr(t,e,n)}),Lf=qi(function(t,e,n,r){Xr(t,e,n,r)}),Wf=yo(function(t,e){var n={};if(null==t)return n;var r=!1;e=f(e,function(e){return e=Ii(e,t),r||(r=e.length>1),e}),Wi(t,_o(t),n),r&&(n=Gn(n,lt|ht|ct));for(var i=e.length;i--;)xi(n,e[i]);return n}),Gf=yo(function(t,e){return null==t?{}:Kr(t,e)}),Vf=fo(Gs),Yf=fo(Vs),qf=Qi(function(t,e,n){return e=e.toLowerCase(),t+(n?ul(e):e)}),Hf=Qi(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Xf=Qi(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),$f=Zi("toLowerCase"),Zf=Qi(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Qf=Qi(function(t,e,n){return t+(n?" ":"")+Jf(e)}),Kf=Qi(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Jf=Zi("toUpperCase"),tp=ai(function(t,e){try{return i(t,et,e)}catch(t){return ns(t)?t:new uh(t)}}),ep=yo(function(t,e){return a(e,function(e){e=na(e),Nn(t,e,lf(t[e],t))}),t}),np=eo(),rp=eo(!0),ip=ai(function(t,e){return function(n){return Er(n,t,e)}}),op=ai(function(t,e){return function(n){return Er(t,n,e)}}),ap=oo(f),up=oo(s),sp=oo(m),lp=so(),hp=so(!0),cp=io(function(t,e){return t+e},0),fp=co("ceil"),pp=io(function(t,e){return t/e},1),dp=co("floor"),vp=io(function(t,e){return t*e},1),mp=co("round"),gp=io(function(t,e){return t-e},0);return g.after=Iu,g.ary=Au,g.assign=Rf,g.assignIn=Pf,g.assignInWith=Cf,g.assignWith=Tf,g.at=Of,g.before=Eu,g.bind=lf,g.bindAll=ep,g.bindKey=hf,g.castArray=Wu,g.chain=Ja,g.chunk=aa,g.compact=ua,g.concat=sa,g.cond=El,g.conforms=Rl,g.constant=Pl,g.countBy=Jc,g.create=Ps,g.curry=Ru,g.curryRight=Pu,g.debounce=Cu,g.defaults=zf,g.defaultsDeep=jf,g.defer=cf,g.delay=ff,g.difference=zc,g.differenceBy=jc,g.differenceWith=Bc,g.drop=la,g.dropRight=ha,g.dropRightWhile=ca,g.dropWhile=fa,g.fill=pa,g.filter=hu,g.flatMap=cu,g.flatMapDeep=fu,g.flatMapDepth=pu,g.flatten=ma,g.flattenDeep=ga,g.flattenDepth=ya,g.flip=Tu,g.flow=np,g.flowRight=rp,g.fromPairs=xa,g.functions=Ns,g.functionsIn=Us,g.groupBy=nf,g.initial=Ma,g.intersection=Nc,g.intersectionBy=Uc,g.intersectionWith=kc,g.invert=Bf,g.invertBy=Nf,g.invokeMap=rf,g.iteratee=Ol,g.keyBy=of,g.keys=Gs,g.keysIn=Vs,g.map=gu,g.mapKeys=Ys,g.mapValues=qs,g.matches=zl,g.matchesProperty=jl,g.memoize=Ou,g.merge=kf,g.mergeWith=Lf,g.method=ip,g.methodOf=op,g.mixin=Bl,g.negate=zu,g.nthArg=kl,g.omit=Wf,g.omitBy=Hs,g.once=ju,g.orderBy=yu,g.over=ap,g.overArgs=pf,g.overEvery=up,g.overSome=sp,g.partial=df,g.partialRight=vf,g.partition=af,g.pick=Gf,g.pickBy=Xs,g.property=Ll,g.propertyOf=Wl,g.pull=Lc,g.pullAll=Ia,g.pullAllBy=Aa,g.pullAllWith=Ea,g.pullAt=Wc,g.range=lp,g.rangeRight=hp,g.rearg=mf,g.reject=bu,g.remove=Ra,g.rest=Bu,g.reverse=Pa,g.sampleSize=Su,g.set=Zs,g.setWith=Qs,g.shuffle=Fu,g.slice=Ca,g.sortBy=uf,g.sortedUniq=Ua,g.sortedUniqBy=ka,g.split=yl,g.spread=Nu,g.tail=La,g.take=Wa,g.takeRight=Ga,g.takeRightWhile=Va,g.takeWhile=Ya,g.tap=tu,g.throttle=Uu,g.thru=eu,g.toArray=Ss,g.toPairs=Vf,g.toPairsIn=Yf,g.toPath=$l,g.toPlainObject=As,g.transform=Ks,g.unary=ku,g.union=Gc,g.unionBy=Vc,g.unionWith=Yc,g.uniq=qa,g.uniqBy=Ha,g.uniqWith=Xa,g.unset=Js,g.unzip=$a,g.unzipWith=Za,g.update=tl,g.updateWith=el,g.values=nl,g.valuesIn=rl,g.without=qc,g.words=Al,g.wrap=Lu,g.xor=Hc,g.xorBy=Xc,g.xorWith=$c,g.zip=Zc,g.zipObject=Qa,g.zipObjectDeep=Ka,g.zipWith=Qc,g.entries=Vf,g.entriesIn=Yf,g.extend=Pf,g.extendWith=Cf,Bl(g,g),g.add=cp,g.attempt=tp,g.camelCase=qf,g.capitalize=ul,g.ceil=fp,g.clamp=il,g.clone=Gu,g.cloneDeep=Yu,g.cloneDeepWith=qu,g.cloneWith=Vu,g.conformsTo=Hu,g.deburr=sl,g.defaultTo=Cl,g.divide=pp,g.endsWith=ll,g.eq=Xu,g.escape=hl,g.escapeRegExp=cl,g.every=lu,g.find=tf,g.findIndex=da,g.findKey=Cs,g.findLast=ef,g.findLastIndex=va,g.findLastKey=Ts,g.floor=dp,g.forEach=du,g.forEachRight=vu,g.forIn=Os,g.forInRight=zs,g.forOwn=js,g.forOwnRight=Bs,g.get=ks,g.gt=gf,g.gte=yf,g.has=Ls,g.hasIn=Ws,g.head=_a,g.identity=Tl,g.includes=mu,g.indexOf=ba,g.inRange=ol,g.invoke=Uf,g.isArguments=xf,g.isArray=_f,g.isArrayBuffer=bf,g.isArrayLike=$u,g.isArrayLikeObject=Zu,g.isBoolean=Qu,g.isBuffer=Mf,g.isDate=Sf,g.isElement=Ku,g.isEmpty=Ju,g.isEqual=ts,g.isEqualWith=es,g.isError=ns,g.isFinite=rs,g.isFunction=is,g.isInteger=os,g.isLength=as,g.isMap=Ff,g.isMatch=ls,g.isMatchWith=hs,g.isNaN=cs,g.isNative=fs,g.isNil=ds,g.isNull=ps,g.isNumber=vs,g.isObject=us,g.isObjectLike=ss,g.isPlainObject=ms,g.isRegExp=wf,g.isSafeInteger=gs,g.isSet=Df,g.isString=ys,g.isSymbol=xs,g.isTypedArray=If,g.isUndefined=_s,g.isWeakMap=bs,g.isWeakSet=Ms,g.join=Sa,g.kebabCase=Hf,g.last=Fa,g.lastIndexOf=wa,g.lowerCase=Xf,g.lowerFirst=$f,g.lt=Af,g.lte=Ef,g.max=Ql,g.maxBy=Kl,g.mean=Jl,g.meanBy=th,g.min=eh,g.minBy=nh,g.stubArray=Gl,g.stubFalse=Vl,g.stubObject=Yl,g.stubString=ql,g.stubTrue=Hl,g.multiply=vp,g.nth=Da,g.noConflict=Nl,g.noop=Ul,g.now=sf,g.pad=fl,g.padEnd=pl,g.padStart=dl,g.parseInt=vl,g.random=al,g.reduce=xu,g.reduceRight=_u,g.repeat=ml,g.replace=gl,g.result=$s,g.round=mp,g.runInContext=t,g.sample=Mu,g.size=wu,g.snakeCase=Zf,g.some=Du,g.sortedIndex=Ta,g.sortedIndexBy=Oa,g.sortedIndexOf=za,g.sortedLastIndex=ja,g.sortedLastIndexBy=Ba,g.sortedLastIndexOf=Na,g.startCase=Qf,g.startsWith=xl,g.subtract=gp,g.sum=rh,g.sumBy=ih,g.template=_l,g.times=Xl,g.toFinite=Fs,g.toInteger=ws,g.toLength=Ds,g.toLower=bl,g.toNumber=Is,g.toSafeInteger=Es,g.toString=Rs,g.toUpper=Ml,g.trim=Sl,g.trimEnd=Fl,g.trimStart=wl,g.truncate=Dl,g.unescape=Il,g.uniqueId=Zl,g.upperCase=Kf,g.upperFirst=Jf,g.each=du,g.eachRight=vu,g.first=_a,Bl(g,function(){var t={};return ar(g,function(e,n){xh.call(g.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),g.VERSION=nt,a(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){g[t].placeholder=g}),a(["drop","take"],function(t,e){K.prototype[t]=function(n){var r=this.__filtered__;if(r&&!e)return new K(this);n=n===et?1:Xh(ws(n),0);var i=this.clone();return r?i.__takeCount__=$h(n,i.__takeCount__):i.__views__.push({size:$h(n,zt),type:t+(i.__dir__<0?"Right":"")}),i},K.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),a(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==At||n==Rt;K.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:So(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),a(["head","last"],function(t,e){var n="take"+(e?"Right":"");K.prototype[t]=function(){return this[n](1).value()[0]}}),a(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");K.prototype[t]=function(){return this.__filtered__?new K(this):this[n](1)}}),K.prototype.compact=function(){return this.filter(Tl)},K.prototype.find=function(t){return this.filter(t).head()},K.prototype.findLast=function(t){return this.reverse().find(t)},K.prototype.invokeMap=ai(function(t,e){return"function"==typeof t?new K(this):this.map(function(n){return Er(n,t,e)})}),K.prototype.reject=function(t){return this.filter(zu(So(t)))},K.prototype.slice=function(t,e){t=ws(t);var n=this;return n.__filtered__&&(t>0||e<0)?new K(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==et&&(e=ws(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},K.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},K.prototype.toArray=function(){return this.take(zt)},ar(K.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=g[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(g.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,u=e instanceof K,s=a[0],l=u||_f(e),h=function(t){var e=i.apply(g,p([t],a));return r&&c?e[0]:e};l&&n&&"function"==typeof s&&1!=s.length&&(u=l=!1);var c=this.__chain__,f=!!this.__actions__.length,d=o&&!c,v=u&&!f;if(!o&&l){e=v?e:new K(this);var m=t.apply(e,a);return m.__actions__.push({func:eu,args:[h],thisArg:et}),new X(m,c)}return d&&v?t.apply(this,a):(m=this.thru(h),d?r?m.value()[0]:m.value():m)})}),a(["pop","push","shift","sort","splice","unshift"],function(t){var e=dh[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);g.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(_f(i)?i:[],t)}return this[n](function(n){return e.apply(_f(n)?n:[],t)})}}),ar(K.prototype,function(t,e){var n=g[e];if(n){var r=n.name+"",i=uc[r]||(uc[r]=[]);i.push({name:e,func:n})}}),uc[no(et,vt).name]=[{name:"wrapper",func:et}],K.prototype.clone=J,K.prototype.reverse=De,K.prototype.value=Le,g.prototype.at=Kc,g.prototype.chain=nu,g.prototype.commit=ru,g.prototype.next=iu,g.prototype.plant=au,g.prototype.reverse=uu,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=su,g.prototype.first=g.prototype.head,zh&&(g.prototype[zh]=ou),g},Mr=br();"function"==typeof et&&"object"==typeof et.amd&&et.amd?(or._=Mr,et(function(){return Mr})):ur?((ur.exports=Mr)._=Mr,ar._=Mr):or._=Mr}).call(De)}),Je=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Ee(this,t),e<n?(this.min_x=e,this.max_x=n):(this.min_x=n,this.max_x=e),r<i?(this.min_y=r,this.max_y=i):(this.min_y=i,this.max_y=r),Object.seal(this)}return t.prototype.addPoint=function(t,e){t<this.min_x?this.min_x=t:t>this.max_x&&(this.max_x=t),e<this.min_y?this.min_y=e:e>this.max_y&&(this.max_y=e)},t.prototype.isInside=function(t,e){return t>=this.min_x&&t<=this.max_x&&e>=this.min_y&&e<=this.max_y},t.prototype.isIntersection=function(t){return!(t.max_x<this.min_x||t.min_x>this.max_x||t.max_y<this.min_y||t.min_y>this.max_y)},Re(t,[{key:"width",get:function(){return this.max_x-this.min_x+1}},{key:"height",get:function(){return this.max_y-this.min_y+1}},{key:"center_x",get:function(){return(this.max_x-this.min_x)/2}},{key:"center_y",get:function(){return(this.max_y-this.min_y)/2}}]),t}(),tn=function(t){function e(n,r,i,o){Ee(this,e);var a=parseInt(n,10),u=parseInt(r,10);return Ce(this,t.call(this,a,a+parseInt(i,10)-1,u,u+parseInt(o,10)-1))}return Pe(e,t),Re(e,[{key:"x",get:function(){return this.min_x},set:function(t){var e=this.width;this.min_x=t,this.max_x=t+e-1}},{key:"y",get:function(){return this.min_y},set:function(t){var e=this.height;this.min_y=t,this.max_y=t+e-1}},{key:"width",get:function(){return this.max_x-this.min_x+1},set:function(t){this.max_x=this.min_x+t-1}},{key:"height",get:function(){return this.max_y-this.min_y+1},set:function(t){this.max_y=this.min_y+t-1}}]),e}(Je),en=function(){function t(e,n){Ee(this,t),h(this,"app",e),Ze(this),D(this),this.url=null,this.domElement=n,this.image=null,Object.seal(this)}return t.prototype.load=function(t){var e=document.createElement("img");return this.domElement=e,this.url=this.app.getAssetUrl(t),e.src=this.url,this},Re(t,[{key:"domElement",get:function(){return this._domElement},set:function(t){if(t instanceof HTMLCanvasElement)E(this,t);else if(t instanceof HTMLImageElement)if(0===t.width&&0===t.height){this._domElement=t,this.ready=!1;var e=this;t.onload=function(){e.image=R(t),e.ready=!0}}else E(this,t);else E(this,null)}},{key:"width",get:function(){return this.image?this.image.width:0}},{key:"height",get:function(){return this.image?this.image.height:0}}]),t}(),nn=function(){function t(e,n){Ee(this,t),we(this),h(this,"app",e),Ze(this),D(this),this.ready=!1,this.url=null,this._data=null,n&&Object.defineProperty(this,n,{get:function(){return this.data},set:function(t){this.data=t},enumerable:!0})}return t.prototype.load=function(t){var e=this;this.url=this.app.getAssetUrl(t);var n=new XMLHttpRequest;return n.open("GET",this.url,!0),n.onreadystatechange=function(){4===n.readyState&&n.status>=200&&n.status<300&&(e.data=n.responseText)},n.send(),this},Re(t,[{key:"data",get:function(){return this._data},set:function(t){if(t){var e=this.emitReduce("incomingData",t);e&&(this._data=e,this.emit("data",e))}else this._data=t;this.ready=!!this._data}}]),t}(),rn=function(){function t(e,n,r,i,o){Ee(this,t),this._parent=e,this._image=null,this._width=i,this._height=o,this.x=null!=n?n:0,this.y=null!=r?r:0}return t.prototype.setTexCoords=function(t){var e=this.min_s,n=this.min_t,r=this.max_s,i=this.max_t;t.setTexCoords(e,n,r,n,r,i,e,i)},t.fromCanvas=function(e){var n=new t;return n.image=e,n},Re(t,[{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t}},{key:"root",get:function(){return this._parent?this._parent:this}},{key:"image",get:function(){
return this._image?this._image:this._parent?this._parent.image:null},set:function(t){this._image=t}},{key:"root_width",get:function(){var t=this.root;return this===t?null!=this._width?this._width:this._image?this._image.width:0:t.root_width}},{key:"root_height",get:function(){var t=this.root;return this===t?null!=this._height?this._height:this._image?this._image.height:0:t.root_height}},{key:"width",get:function(){return null!=this._width?this._width:this.root_width},set:function(t){this._width=t}},{key:"height",get:function(){return null!=this._height?this._height:this.root_height},set:function(t){this._height=t}},{key:"min_s",get:function(){for(var t=this.x,e=this;null!=(e=e.parent);)t+=e.x;return t/this.root_width}},{key:"min_t",get:function(){for(var t=this.y,e=this;null!=(e=e.parent);)t+=e.y;return t/this.root_height}},{key:"max_s",get:function(){for(var t=this.x+this.width,e=this;null!=(e=e.parent);)t+=e.x;return t/this.root_width}},{key:"max_t",get:function(){for(var t=this.y+this.height,e=this;null!=(e=e.parent);)t+=e.y;return t/this.root_height}}]),t}(),on=function(t){function e(n,r,i){Ee(this,e);var o=Ce(this,t.call(this,n,"conf"));return o.on("incomingData",P),o.on("data",T),o.conf=i,o.texture=null,o.frames=null,o.frameNames=null,o.imageUrl=r,Object.seal(o),o}return Pe(e,t),e.prototype.getTexture=function(t){if(this.frames)return this.frames.get(t)},e.prototype.getRandomTexture=function(){if(this.frames)return this.frames.get(this.frameNames[parseInt(this.frameNames.length*Math.random(),10)])},e}(nn),an=function(){function t(e,n,r){Ee(this,t),this.descriptor=e,this.capacity=n,this.vertices=void 0!==r?r:new Float32Array(n*e.vertexCount*e.vertexAttrCount)}return t.prototype.copy=function(t,e){var n=0;void 0===e&&(n=e*this.descriptor.vertexCount*this.descriptor.vertexAttrCount),this.vertices.set(t.vertices,n)},t.prototype.subarray=function(e,n){void 0===n&&(n=1);var r=this.vertices.subarray(e*this.descriptor.vertexCount*this.descriptor.vertexAttrCount,(e+n)*this.descriptor.vertexCount*this.descriptor.vertexAttrCount);return new t(this.descriptor,n,r)},t}(),un=function(){function t(e,n){Ee(this,t);var r=e*n;p(this,{vertexObjectCount:e,objectIndexCount:n,size:r,indices:new Uint32Array(r)})}return t.Generate=function(e,n,r,i){var o,a,u=new t(e,n.length);for(void 0===i&&(i=4),void 0===r&&(r=0),o=0;o<e;++o)for(a=0;a<n.length;++a)u.indices[o*u.objectIndexCount+a]=n[a]+(o+r)*i;return u},t}();Object.defineProperties(O.prototype,{vertices:{get:function(){return this.vertexArray.vertices}}}),z.prototype.createVertexArray=function(t){return new an(this,void 0===t?1:t)},z.prototype.create=function(t){var e=Object.create(this.vertexObjectPrototype);return O.call(e,this,t),O!==this.vertexObjectConstructor&&this.vertexObjectConstructor.call(e),e},z.prototype.hasAttribute=function(t,e){var n=this.attr[t];return n&&n.size===(e||1)},Object.defineProperties(z.prototype,{proto:{get:function(){return this.vertexObjectConstructor.prototype},enumerable:!0}}),B.prototype.getAttrPostfix=function(t,e){if(this.attrNames){var n=this.attrNames[e];if(void 0!==n)return n}return t+"_"+e},B.prototype.defineProperties=function(t,e,n){var r,i;if(1===this.size)if(this.uniform)e[t]={get:k(this.offset),set:W(n.vertexCount,n.vertexAttrCount,this.offset),enumerable:!0};else for(e["set"+G(t)]={value:L(1,n.vertexCount,n.vertexAttrCount,this.offset),enumerable:!0},r=0;r<n.vertexCount;++r)e[t+r]={get:k(this.offset+r*n.vertexAttrCount),set:L(1,1,0,this.offset+r*n.vertexAttrCount),enumerable:!0};else if(this.size>=2)if(this.uniform)for(e["get"+G(t)]={value:N(this.offset),enumerable:!0},e["set"+G(t)]={value:U(this.size,n.vertexCount,n.vertexAttrCount,this.offset),enumerable:!0},r=0;r<this.size;++r)e[this.getAttrPostfix(t,r)]={get:k(this.offset+r),set:W(n.vertexCount,n.vertexAttrCount,this.offset+r),enumerable:!0};else for(e["set"+G(t)]={value:L(this.size,n.vertexCount,n.vertexAttrCount,this.offset),enumerable:!0},r=0;r<n.vertexCount;++r)for(i=0;i<this.size;++i)e[this.getAttrPostfix(t,i)+r]={get:k(this.offset+r*n.vertexAttrCount+i),set:L(1,1,0,this.offset+r*n.vertexAttrCount+i),enumerable:!0}},Object.defineProperties(V.prototype,{usedCount:{get:function(){return this.usedVOs.length},enumerable:!0},availableCount:{get:function(){return this.availableVOs.length},enumerable:!0}}),V.prototype.alloc=function(){var t=this.availableVOs.shift();if(void 0===t)throw new Error("VertexObjectPool capacity(="+this.capacity+") reached!");return this.usedVOs.push(t),t.vertexArray.copy(this.NEW.vertexArray),t},V.prototype.free=function(t){var e=this.usedVOs.indexOf(t);if(e!==-1){var n=this.usedVOs.length-1;if(e!==n){var r=this.usedVOs[n];t.vertexArray.copy(r.vertexArray);var i=r.vertexArray;r.vertexArray=t.vertexArray,t.vertexArray=i,this.usedVOs.splice(e,1,r)}this.usedVOs.pop(),this.availableVOs.unshift(t),t.vertexArray.copy(this.ZERO.vertexArray)}};var sn=Object.freeze({AABB2:Je,Viewport:tn,PowerOfTwoImage:en,Resource:nn,Texture:rn,TextureAtlas:on,VertexArray:an,VertexIndexArray:un,VertexObject:O,VertexObjectDescriptor:z,VertexObjectPool:V}),ln=function(t){function e(n,r,i,o){Ee(this,e);var a=Ce(this,t.call(this,n,"source"));return a.shaderType=r,a.name=i,a.source=o,a}return Pe(e,t),e.prototype.compile=function(t){if(this.ready){var e=t.gl,n=e.createShader(e[this.shaderType]);if("string"!=typeof this.source&&(this.source=q({shaderSource:this,glx:t},this.source)),e.shaderSource(n,this.source),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw console.error(e.getShaderInfoLog(n)),console.group("shader-info"),console.debug("shaderSource",this),console.log(this.source),console.groupEnd(),new Error("ShaderSource compile error");return n}},e}(nn);ln.VERTEX_SHADER="VERTEX_SHADER",ln.FRAGMENT_SHADER="FRAGMENT_SHADER";var hn=function(){function t(e){Ee(this,t),d(this,{app:e,vertexShaders:new Map,fragmentShaders:new Map,programs:new Map})}return t.prototype.addProgram=function(t,e,n){return this.programs.set(t,new Qe(t,e,n)),this},t.prototype.getProgram=function(t){return this.programs.get(t)},t.prototype.addShader=function(t){return t.shaderType===ln.VERTEX_SHADER?this.vertexShaders.set(t.name,t):t.shaderType===ln.FRAGMENT_SHADER&&this.fragmentShaders.set(t.name,t),this},t.prototype.defineVertexShader=function(t,e){return this.addShader(new ln(this.app,ln.VERTEX_SHADER,t,e))},t.prototype.defineFragmentShader=function(t,e){return this.addShader(new ln(this.app,ln.FRAGMENT_SHADER,t,e))},t.prototype.loadVertexShader=function(t,e){var n=new ln(this.app,ln.VERTEX_SHADER,t).load(e);return this.addShader(n),n.promise},t.prototype.loadFragmentShader=function(t,e){var n=new ln(this.app,ln.FRAGMENT_SHADER,t).load(e);return this.addShader(n),n},t.prototype.getVertexShader=function(t){return this.vertexShaders.get(t)},t.prototype.getFragmentShader=function(t){return this.fragmentShaders.get(t)},t}();Object.defineProperties(H.prototype,{isRepeatable:{get:function(){return this._isRepeatable},set:function(t){var e=!!t;this._isRepeatable!==e&&(this._isRepeatable=e,this.needsConf=!0)}},width:{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.needsConf=!0)}},height:{get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this.needsConf=!0)}},image:{get:function(){return this._image},set:function(t){this._image!==t&&(this._image=t,this.needsUpload=!0,t?(this.width=t.width,this.height=t.height):(this.width=0,this.height=0))}},canConf:{get:function(){return this.width>0&&this.height>0}},canUpload:{get:function(){return this.image&&this.width>0&&this.height>0}}}),H.prototype.bind=function(){return this.glId||$(this),this.glx.app.textureManager.bindWebGlTexture(this)},H.prototype.upload=function(){if(Z(this),this.needsUpload&&this.canUpload){this.bind();var t=this.glx.gl;t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),this.needsUpload=!1}return this},H.prototype.destroy=function(){X(this)};var cn=function(){function t(e){Ee(this,t),h(this,"app",e);var n=e.glx.MAX_TEXTURE_IMAGE_UNITS;d(this,{textureCache:new Map,boundTextures:new Array(n)});for(var r=0;r<n;++r)this.boundTextures[r]=null;c(this,"lastBoundTexUnit",0)}return t.prototype.bindWebGlTexture=function(t){var e=this.boundTextures.indexOf(t);if(e<0){for(var n=0;n<this.boundTextures.length;++n)if(!this.boundTextures[n]){e=n,this.boundTextures[n]=t;break}var r=this.app.glx;if(e<0){e=this.lastBoundTexUnit;var i=this.boundTextures[e];i&&(i.texUnit=-1),this.lastBoundTexUnit=(this.lastBoundTexUnit+1)%r.MAX_TEXTURE_IMAGE_UNITS}r.activeTexture(e),r.bindTexture2d(t.glId),t.texUnit=e}return e},t.prototype.findOrCreateWebGlTexture=function(t){var e=t.texture?t.texture:t,n=e.image.domElement?e.image.domElement:e.image,r=e.image.uid?e.image.uid:n,i=this.textureCache.get(r);return i||(i=new H(this.app.glx),i.image=n,this.textureCache.set(r,i)),i},t}(),fn=function(){function t(e){if(Ee(this,t),!e)throw new Error("[new Picimo.render.WebGlContext] gl is undefined!");h(this,"gl",e),d(this,{_boundBuffers:new Map,_shaders:new Map,_programs:new Map}),K(this),Q(this),this.app=null,this.activeProgram=null,this.activeTexture(0),this._boundTextures=[];for(var n=0;n<this.MAX_TEXTURE_IMAGE_UNITS;n++)this._boundTextures[n]={TEXTURE_2D:null};Object.seal(this)}return t.prototype.activeTexture=function(t){var e=this.gl,n=e.TEXTURE0+t;this.activeTexUnit!==n&&(this.activeTexUnit=n,e.activeTexture(this.activeTexUnit))},t.prototype.bindTexture2d=function(t){var e=this.gl,n=this._boundTextures[this.activeTexUnit-e.TEXTURE0];n.TEXTURE_2D!==t&&(n.TEXTURE_2D=t,e.bindTexture(e.TEXTURE_2D,t))},t.prototype.bindBuffer=function(t,e){this._boundBuffers.get(t)!==e&&(this._boundBuffers.set(t,e),this.gl.bindBuffer(t,e))},t.prototype.bindArrayBuffer=function(t){this.bindBuffer(this.gl.ARRAY_BUFFER,t)},t.prototype.bindElementArrayBuffer=function(t){this.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t)},t.prototype.glShader=function t(e){if(e){var t=this._shaders.get(e.uid);return t||(t=e.compile(this),t&&this._shaders.set(e.uid,t)),t}},t.prototype.glProgram=function t(e){if(e){var t=this._programs.get(e.uid);return t||(t=e.linkProgram(this.app),t&&this._programs.set(e.uid,t)),t}},t}(),pn=function(){function t(){Ee(this,t),this.length=0,h(this,"entries",[])}return t.prototype.push=function(t){var e=void 0;this.length<this.entries.length?this.entries[this.length].value=t:(e=Object.create(null),e.value=t,this.entries.push(e)),++this.length},t.prototype.pop=function(){var t=void 0,e=void 0;if(this.length>0)return--this.length,t=this.entries[this.length],e=t.value,t.value=null,e},t.prototype.clear=function(t){for(var e=this.length;e--;)this.entries[e].value=null;this.length=0,t&&(this.entries.length=0)},t.prototype.forEach=function(t,e){var n=this.length,r=void 0,i=void 0;for(i=0;i<n;i++)r=this.entries[i].value,r&&t.call(e||r,r)},t}(),dn=function(){function t(){Ee(this,t),this.value=null,this.commands=[]}return t.prototype.exec=function(t){var e;if(null!=t){if(t.isUniformValueCmd)e=t.getValue(this.value),t.isRestorable&&(t.prevValue=this.value,this.commands.push(t));else if(t.isUniformValueRestoreCmd){for(var n=0;n<this.commands.length;n++)if(this.commands[n].uid===t.uid){e=this.commands[n].prevValue,this.commands.splice(n,this.commands.length-n);break}void 0===e&&(e=this.value)}else e=t;this.value=e}},t}(),vn=function(){function t(e){Ee(this,t),h(this,"app",e),it(this),ot(this)}return t.prototype.filterPipelineByInstanceof=function(t){return Ke.filter(this.pipelines,function(e){return e instanceof t})},t.prototype.onInitGl=function(){},t.prototype.onResize=function(){var t=this.app;t.gl.viewport(0,0,t.width,t.height)},t.prototype.onStartFrame=function(){rt(this),lt(this,"reset"),nt(this),this.activateBlendMode(this.defaultBlendMode)},t.prototype.activateBlendMode=function(t){this.currentBlendMode!==t&&(this.currentBlendMode=t,t&&t.activate(this.app.gl))},t.prototype.onEndFrame=function(){at(this)},t.prototype.addPipeline=function(t,e){return t&&!e&&(e=t,t="pipe_"+this.pipelines.length),this.pipeline[t]=e,this.pipelines.push(e),e},t.prototype.activatePipeline=function(t){return t!==this.currentPipeline&&(this.flush(),this.currentPipeline=t),this},t.prototype.addRenderCommand=function(t,e){void 0!==e&&this.activatePipeline(e),t.renderToTexture&&this.flush(),this.cmdQueue.push(t)},t.prototype.flush=function(){this.currentPipeline&&this.currentPipeline.flush&&this.currentPipeline.flush()},t.prototype.dumpCommandQueue=function(){this.debugOutFrame=!0},t}(),mn=function(){function t(e,n){Ee(this,t);var r=e.gl;d(this,{glx:e,glBuffer:r.createBuffer(),drawType:n.drawType||r.DYNAMIC_DRAW,bufferType:n.bufferType||r.ARRAY_BUFFER,itemType:n.itemType||(this.bufferType===r.ARRAY_BUFFER?r.FLOAT:r.UNSIGNED_SHORT),arrType:n.arrType||(this.itemType===r.FLOAT?Float32Array:Uint16Array),itemSize:n.itemSize}),this.numItems=n.numItems||0,this.dataArray=n.dataArray,Object.seal(this)}return t.prototype.bindBuffer=function(){return this.glx.bindBuffer(this.bufferType,this.glBuffer),this},t.prototype.bufferData=function(t){return this.numItems=t.length/this.itemSize|0,this.dataArray=t instanceof this.arrType?t:new this.arrType(t),this.bindBuffer(),this.glx.gl.bufferData(this.bufferType,this.dataArray,this.drawType),this},t.prototype.bufferSubData=function(t,e,n){return this.bindBuffer(),t||(t=this.dataArray),"number"==typeof e&&(void 0===n&&(n=0),t=new this.arrType(t.buffer,n*this.arrType.BYTES_PER_ELEMENT,e)),this.glx.gl.bufferSubData(this.bufferType,0,t),this},t.prototype.vertexAttribPointer=function(t,e,n,r,i){var o=this.glx.gl;return o.vertexAttribPointer(t,e||this.itemSize,this.itemType,i?o.TRUE:o.FALSE,(n||0)*this.arrType.BYTES_PER_ELEMENT,(r||0)*this.arrType.BYTES_PER_ELEMENT),this},t.prototype.drawElements=function(t,e,n){var r=this.glx.gl;r.drawElements(t||r.TRIANGLES,(e||this.numItems)*this.itemSize,this.itemType,(n||0)*this.arrType.BYTES_PER_ELEMENT)},t.prototype.destroy=function(){this.glx&&(this.glBuffer&&(this.glx.gl.deleteBuffer(this.glBuffer),this.glBuffer=null),this.glx=null)},t.fromVertexArray=function(e,n,r){var i={drawType:r&&r.drawType?r.drawType:e.gl.DYNAMIC_DRAW,bufferType:e.gl.ARRAY_BUFFER,itemType:e.gl.FLOAT,arrType:Float32Array,itemSize:n.vertexAttrCount},o=new t(e,i);return r&&r.vertexArray&&o.bufferData(r.vertexArray.vertices),o},t.fromVertexIndexArray=function(e,n){var r={drawType:e.gl.STATIC_DRAW,bufferType:e.gl.ELEMENT_ARRAY_BUFFER,itemType:e.gl.UNSIGNED_SHORT,arrType:Uint16Array,itemSize:n.objectIndexCount,numItems:n.vertexObjectCount},i=new t(e,r);return i.bufferData(n.indices),i},t}(),gn=Object.freeze({Program:Qe,ShaderSource:ln,ShaderManager:hn,TextureManager:cn,WebGlContext:fn,WebGlRenderer:vn,WebGlProgram:F,WebGlTexture:H,WebGlBuffer:mn}),yn=function(t){var e=new hn(t);f(t,"shaderManager",e),m(e,t,["loadFragmentShader","loadVertexShader","getVertexShader","getFragmentShader","getProgram"]),t.addProgram=function(){return e.addProgram.apply(e,arguments),t},t.defineVertexShader=function(){return e.defineVertexShader.apply(e,arguments),t},t.defineFragmentShader=function(){return e.defineFragmentShader.apply(e,arguments),t};var n="picimo.complexSprite";t.defineVertexShader(n,Ge),t.defineFragmentShader(n,Ve),t.addProgram(n,n,n);var r="picimo.sprite";t.defineVertexShader(r,Ye),t.defineFragmentShader(r,qe),t.addProgram(r,r,r)},xn=function(t){var e=void 0;try{e=t.canvas.getContext("webgl",t.glCtxAttrs)||t.canvas.getContext("experimental-webgl",t.glCtxAttrs)}catch(t){console.error(t)}if(!e)throw new Error("Could not initialize the WebGL context!");var n=new fn(e);return n.app=t,n},_n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Ee(this,t),this.registry=new Map,this.parentFactory=e}return t.prototype.createDescriptor=function(t){if(this.getDescriptor(t))throw new Error("oops.. VertexObjectDescriptor '"+t+"' already exists!");for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=new(Function.prototype.bind.apply(z,[null].concat(n)));return this.registry.set(t,i),i},t.prototype.getDescriptor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if(t instanceof z)return t;var e=this.registry.get(t);return!e&&this.parentFactory?this.parentFactory.getDescriptor(t):e},t.prototype.createSprite=function(t){var e=this.getDescriptor(t);if(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.create.apply(e,r)}},t.prototype.createSubFactory=function(){return new t(this)},t}(),bn=function(){return new _n}(),Mn=function(t){var e=t.getDescriptor("default");return e?e:(e=t.createDescriptor("default",function(){this.setAnchor(0,0),this.setRgb(1,1,1)},4,16,[{name:"xwyh",size:2,attrNames:["xw","yh"]},{name:"size",size:2,attrNames:["width","height"],uniform:!0},{name:"scale",size:2,attrNames:["sx","sy"],uniform:!0},{name:"pos",size:2,attrNames:["x","y"],uniform:!0},{name:"texCoords",size:2,attrNames:["s","t"]},{name:"rotate",size:1,uniform:!0},{name:"texUnit",size:1,uniform:!0},{name:"rgb",size:3,attrNames:["r","g","b"],uniform:!0},{name:"opacity",size:1,uniform:!0}],{rot_texUnit:{size:2,offset:10,uniform:!0},color:{size:4,offset:12,uniform:!0}}),e.proto.setAnchor=function(t,e){this.setXwyh(-.5-t,.5-e,.5-t,.5-e,.5-t,-.5-e,-.5-t,-.5-e)},e)},Sn=function(t){t.setTexCoordsByViewport=function(t,e,n,r){var i=0===t.x?0:t.x/e,o=(t.x+t.width)/e,a=1-(t.y+t.height)/n,u=0===t.y?1:1-t.y/n;void 0!==r&&(i*=r,o*=r,a*=r,u*=r),this.setTexCoords(i,a,o,a,o,u,i,u)},t.setSize=function(t,e){var n=.5*t,r=.5*(null==e?t:e);this.setPos2d(-n,r,n,r,n,-r,-n,-r)},Object.defineProperty(t,"rotateDegree",{get:function(){return 180*this.rotate/Math.PI},set:function(t){this.rotate=t*(Math.PI/180)},enumerable:!0}),Object.defineProperty(t,"z",{get:function(){return this.z0},set:function(t){this.z0=t,this.z1=t,this.z2=t,this.z3=t},enumerable:!0})},Fn=function(t){var e=t.getDescriptor("simple");return e?e:(e=t.createDescriptor("simple",null,4,12,[{name:"position",size:3,attrNames:["x","y","z"]},{name:"rotate",size:1,uniform:!0},{name:"texCoords",size:2,attrNames:["s","t"]},{name:"translate",size:2,uniform:!0,attrNames:["tx","ty"]},{name:"scale",size:1,uniform:!0},{name:"opacity",size:1,uniform:!0}],{pos2d:{size:2,offset:0},posZ:{size:1,offset:2,uniform:!0},uv:"texCoords"}),Sn(e.proto),e)},wn=function(){return Mn(bn),Fn(bn),bn.createSubFactory()},Dn=function(t){var e=wn();f(t,"spriteFactory",e),h(t,"defineSprite",function(t,n,r){return ht(t,n,r,e)}),m(e,t,{createSprite:"createSprite",getDescriptor:"getSpriteDescriptor"})},In=function(){this.now=window.performance.now()/1e3,++this.frameNo,this.frameTime=null==this.frameLastTime?0:this.frameLastTime-this.now,this.frameLastTime=this.now,this.resize(),this.ready||(Object.defineProperty(this,"ready",{value:!0,configurable:!0,enumerable:!0}),this.emit("ready"),this.emit("resize")),this.emit("frameBegin"),this.renderer.onStartFrame(),this.emit("frame"),this.scene&&this.scene.renderFrame(),this.emit("renderFrame"),this.renderer.onEndFrame(),this.emit("frameEnd"),requestAnimationFrame(this.onAnimationFrame)},An=function(){var t=void 0,e=void 0,n=void 0,r=void 0,i=void 0;this.canvasIsPredefined?(t=this.canvas,e=Math.round(this.canvas.clientWidth*this.devicePixelRatio),n=Math.round(this.canvas.clientHeight*this.devicePixelRatio)):(t=this.canvas.parentNode.parentNode,r=t.clientWidth,i=t.clientHeight,e=Math.round(r*this.devicePixelRatio),n=Math.round(i*this.devicePixelRatio),this.canvas.style.width=r+"px",this.canvas.style.height=i+"px"),this.canvas.width===e&&this.canvas.height===n||(this.canvas.width=e,this.canvas.height=n),this.width===e&&this.height===n||(this.width=e,this.height=n,this.renderer&&this.renderer.onResize(),this.ready&&this.emit("resize"))},En=0,Rn=1,Pn=2,Cn=function(){function t(e){Ee(this,t),this.picimo=e,this.mouseBtnDown=[!1,!1,!1],this.mouseBtnMove=[!1,!1,!1],this.isDrag=!1,ft(this),we(this)}return t.prototype.mouseDown=function(t){this.mouseBtnDown[t.button]=!0,this.mouseBtnMove[t.button]=!1},t.prototype.mouseMove=function(t){this.mouseBtnMove[En]=this.mouseBtnDown[En],this.mouseBtnMove[Rn]=this.mouseBtnDown[Rn],this.mouseBtnMove[Pn]=this.mouseBtnDown[Pn],this.isDrag=this.isSomeBtnDown;var e=this.picimo.devicePixelRatio,n=ct(t,this.isDrag,e);this.emit("mouseMove",n,this),this.mouseBtnDown[En]&&this.emit("mouseDragLeft",n,this),this.mouseBtnDown[Rn]&&this.emit("mouseDragMiddle",n,this),this.mouseBtnDown[Pn]&&this.emit("mouseDragRight",n,this)},t.prototype.mouseUp=function(t){var e=t.button;this.mouseBtnDown[e]=!1,this.isDrag=this.isSomeBtnDown,this.mouseBtnMove[e]?this.mouseBtnMove[e]=!1:(e===En&&this.emit("mouseClickLeft",t,this),e===Rn&&this.emit("mouseClickMiddle",t,this),e===Pn&&this.emit("mouseClickRight",t,this))},t.prototype.mouseWheel=function(t){this.emit("mouseWheel",t.wheelDeltaX,t.wheelDeltaY,this)},Re(t,[{key:"isBtnLeftDown",get:function(){return this.mouseBtnDown[En]}},{key:"isBtnMiddleDown",get:function(){return this.mouseBtnDown[Rn]}},{key:"isBtnRightDown",get:function(){return this.mouseBtnDown[Pn]}},{key:"isSomeBtnDown",get:function(){return this.mouseBtnDown[En]||this.mouseBtnDown[Rn]||this.mouseBtnDown[Pn]}}]),t}();dt.prototype.is=function(t){return(this.value&(0|t))>0},dt.prototype.isNot=function(t){return!this.is(t)},dt.prototype.set=function(t){return this.value=0|t,this},dt.prototype.toString=function(){var t=[];return this.is(dt.CREATE)&&t.push("CREATE"),this.is(dt.INIT)&&t.push("INIT"),this.is(dt.READY)&&t.push("READY"),this.is(dt.ERROR)&&t.push("ERROR"),this.is(dt.DESTROYED)&&t.push("DESTROYED"),"["+t.join(",")+"]"},p(dt,{CREATE:1,INIT:2,READY:4,ERROR:8,DESTROYED:16}),Object.freeze(dt);var Tn=0;Object.defineProperties(It.prototype,{isRootNode:{get:function(){return!this.parentNode},enumerable:!0}}),It.prototype.renderFrame=bt,It.prototype.destroy=_t,It.prototype.appendChild=function(t){return this.children.indexOf(t)!==-1?t:(this.children.push(t),At(t,this),this.emit("childrenUpdated"),t)},It.prototype.removeChild=function(t){var e=this.children.indexOf(t);return e===-1?t:(this.children.splice(e,1),At(t,null),this.emit("childrenUpdated"),t)},It.prototype.findNode=function(t){if(t){if(this.name===t)return this;var e=void 0,n=void 0,r=void 0;for(n=0,r=this.children.length;n<r;++n)if(e=this.children[n].findNode(t))return e}};var On=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ee(this,t),this.picture=e,this.picture.verticesNeedsUpdate=!0,this._top=n.top,this._bottom=n.bottom,this._left=n.left,this._right=n.right,this._width=n.width,this._height=n.height,this._zoom=n.zoom,this._anchorX=n.anchorX,this._anchorY=n.anchorY,Object.seal(this)}return Re(t,[{key:"top",get:function(){return this._top},set:function(t){this._top!==t&&(this._top=t,this.picture.verticesNeedsUpdate=!0)}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom!==t&&(this._bottom=t,this.picture.verticesNeedsUpdate=!0)}},{key:"left",get:function(){return this._left},set:function(t){this._left!==t&&(this._left=t,this.picture.verticesNeedsUpdate=!0)}},{key:"right",get:function(){return this._right},set:function(t){this._right!==t&&(this._right=t,this.picture.verticesNeedsUpdate=!0)}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.picture.verticesNeedsUpdate=!0)}},{key:"height",get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this.picture.verticesNeedsUpdate=!0)}},{key:"zoom",get:function(){return this._zoom},set:function(t){this._zoom!==t&&(this._zoom=t,this.picture.verticesNeedsUpdate=!0)}},{key:"anchorX",get:function(){return this._anchorX},set:function(t){this._anchorX!==t&&(this._anchorX=t,this.picture.verticesNeedsUpdate=!0)}},{key:"anchorY",get:function(){return this._anchorY},set:function(t){this._anchorY!==t&&(this._anchorY=t,this.picture.verticesNeedsUpdate=!0)}}]),t}(),zn=function(t,e,n,r,i,o){if("string"==typeof t){var a=t.trim();if(a.endsWith("px"))return parseFloat(a);if(void 0!==e&&a.endsWith("%"))return e*parseFloat(a)/100;if(void 0!==n&&a.endsWith("iw"))return n*parseFloat(a)/100;if(void 0!==r&&a.endsWith("ih"))return r*parseFloat(a)/100;if(void 0!==i&&a.endsWith("sw"))return i*parseFloat(a)/100;if(void 0!==o&&a.endsWith("sh"))return o*parseFloat(a)/100}else if("number"==typeof t)return t;return null!=t?parseFloat(t):null},jn=function(t){if(t.verticesNeedsUpdate){t.verticesNeedsUpdate=!1;var e=void 0,n=void 0,r=t.displayPosition;if(r){var i=t.parentNode.width,o=t.parentNode.height,a=t.texture.width,u=t.texture.height,s=zn(r.left,i,a,u,i,o),l=zn(r.right,i,a,u,i,o),h=zn(r.top,o,a,u,i,o),c=zn(r.bottom,o,a,u,i,o),f="number"==typeof s?s:null,p="number"==typeof l?i-l:null,d="number"==typeof h?h:null,v="number"==typeof c?o-c:null,m=void 0;m="number"==typeof f&&"number"==typeof p?p-f:zn(r.width,a,a,u,i,o),"number"==typeof r.zoom&&(m=(null===m?t.texture.width:m)*r.zoom);var g=void 0;g="number"==typeof d&&"number"==typeof v?v-d:zn(r.height,u,a,u,i,o),"number"==typeof r.zoom&&(g=(null===g?t.texture.height:g)*r.zoom),null===f&&"number"==typeof p?f=p-m:null===p&&"number"==typeof f&&(p=f+m),null===d&&"number"==typeof v?d=v-g:null===v&&"number"==typeof d&&(v=d+g),e=.5*i,n=.5*o;var y=r.anchorX||0,x=r.anchorY||0,_=y*(p-f),b=x*(v-d);f-=e-_,p-=e-_,d=o-d-n+b,v=o-v-n+b;var M=f+(p-f)/2,S=d+(v-d)/2;f-=M,p-=M,d-=S,v-=S,Pt(t,M,S),t.setVertexPositions(f,v,p,v,p,d,f,d)}else{var F=t.parentNode.width,w=t.parentNode.height,D=w/F,I=t.texture.height/t.texture.width;if(1===I)n=e="cover"===t.sceneFit?.5*(D>1?w:F):.5*(D<1?w:F);else{var A=void 0;A="cover"===t.sceneFit?I>D?F/t.texture.width:w/t.texture.height:I<D?F/t.texture.width:w/t.texture.height,e=.5*A*t.texture.width,n=.5*A*t.texture.height}Pt(t,0,0),t.setVertexPositions(-e,-n,e,-n,e,n,-e,n)}}},Bn=function(){function t(e){Ee(this,t),this.objects=[],this.inUseCount=0,this.setFactory(e)}return t.prototype.setFactory=function(t){this.factory=t?t:function(){return{}}},t.prototype.create=function(){var t=void 0;return this.inUseCount<this.objects.length?t=this.objects[this.inUseCount]:(t=this.factory(),this.objects.push(t)),++this.inUseCount,t},t.prototype.releaseAll=function(){this.inUseCount=0},t.prototype.destroyAll=function(){this.inUseCount=0,this.objects.length=0},t}(),Nn=function(){function t(e,n,r,i){Ee(this,t),this.indexArray=null,this.webGlBuffer=null,this.webGlIndexBuffer=null,this.renderCmd=null,d(this,{app:e,pool:n,texture:r,program:i}),this.reset(),Object.seal(this)}return t.prototype.onInitGl=function(){Ct(this),Tt(this)},t.prototype.reset=function(){this.currentSpriteCount=0,this.currentSpriteOffset=0,this.totalSpritesCount=0,this.renderCmd&&this.renderCmd.releaseAll()},t.prototype.flush=function(){if(this.currentSpriteCount){var t=this.renderCmd.create();t.drawElements.count=this.currentSpriteCount,t.drawElements.offset=this.currentSpriteOffset,this.app.renderer.addRenderCommand(t,this),this.currentSpriteOffset+=this.currentSpriteCount,this.currentSpriteCount=0}},t.prototype.render=function(t){this.app.renderer.activatePipeline(this),this.pool.vertexArray.copy(t,this.totalSpritesCount),++this.currentSpriteCount,++this.totalSpritesCount},t.prototype.finish=function(){this.totalSpritesCount&&(this.flush(),this.webGlBuffer.bufferSubData(null,this.totalSpritesCount*this.pool.descriptor.vertexAttrCount*this.pool.descriptor.vertexCount))},Re(t,[{key:"webGlTexture",get:function(){return this.app.textureManager.findOrCreateWebGlTexture(this.texture)}}]),t}();Nn.DEFAULT_CAPACITY=100;var Un=function(){function t(e,n,r,i){Ee(this,t),this.indexArray=null,this.webGlBuffer=null,this.webGlIndexBuffer=null,this.renderCmd=null,d(this,{app:e,program:n,pool:r,texture:i}),Object.seal(this)}return t.prototype.onInitGl=function(){Ot(this),zt(this)},t.prototype.render=function(){this.app.renderer.addRenderCommand(this.renderCmd,this)},t.prototype.finish=function(){this.webGlBuffer.bufferSubData()},t}(),kn="picimo.sprite",Ln="simple",Wn="contain",Gn=function(t){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ee(this,e);var i=Ce(this,t.call(this,n,r));return Ut(i,r.texture),i.program=r.program||kn,i.sprite=n.spriteFactory.createSprite(r.spriteType||Ln),i.sprite.scale=mt(r.scale,1),i.sprite.opacity=mt(r.opacity,1),i.posX=r.posX,i.posY=r.posY,i.pipeline=null,i.pipelineSprite=null,i.verticesNeedsUpdate=!0,r.displayPosition?i.displayPosition=r.displayPosition:i.sceneFit=r.sceneFit||Wn,i.on("initGl",jt.bind(i,i)),i.on("renderFrame",Nt.bind(i,i)),i.parentNode.on("resize",function(){i.verticesNeedsUpdate=!0}),i}return Pe(e,t),e.prototype.setVertexPositions=function(t,e,n,r,i,o,a,u){return this.sprite.setPos2d(t,o,n,u,i,e,a,r),this},e.prototype.setPos=function(t,e){return this.posX=t,this.posY=e,this},Re(e,[{key:"scale",get:function(){return this.sprite.scale},set:function(t){this.sprite.scale=mt(t,1)}},{key:"opacity",get:function(){return this.sprite.opacity},set:function(t){return this.sprite.opacity=mt(t,1)}},{key:"posX",get:function(){return this._posX},set:function(t){this._posX=mt(t,0),this.verticesNeedsUpdate=!0}},{key:"posY",get:function(){return this._posY},set:function(t){this._posY=mt(t,0),this.verticesNeedsUpdate=!0}},{key:"posZ",get:function(){return this.sprite.posZ},set:function(t){this.sprite.posZ=mt(t,0)}},{key:"rotate",get:function(){return this.sprite.rotate},set:function(t){this.sprite.rotate=mt(t,0)}},{key:"rotateDegree",get:function(){return 180*this.sprite.rotate/Math.PI},set:function(t){this.sprite.rotate=t*(Math.PI/180)}},{key:"sceneFit",get:function(){return this._sceneFit},set:function(t){this._sceneFit=t,this._displayPosition=null,this.verticesNeedsUpdate=!0}},{key:"displayPosition",get:function(){return this._displayPosition},set:function(t){this._displayPosition=null!=t?new On(this,t):null,this._sceneFit=null,this.verticesNeedsUpdate=!0}}]),e}(It),Vn={};Vn.EPSILON=1e-6,Vn.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,Vn.RANDOM=Math.random,Vn.ENABLE_SIMD=!1,Vn.SIMD_AVAILABLE=Vn.ARRAY_TYPE===Float32Array&&"SIMD"in De,Vn.USE_SIMD=Vn.ENABLE_SIMD&&Vn.SIMD_AVAILABLE,Vn.setMatrixArrayType=function(t){Vn.ARRAY_TYPE=t};var Yn=Math.PI/180;Vn.toRadian=function(t){return t*Yn},Vn.equals=function(t,e){return Math.abs(t-e)<=Vn.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))};var qn=Vn,Hn=qn,Xn={};Xn.create=function(){var t=new Hn.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Xn.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},Xn.clone=function(t){var e=new Hn.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Xn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Xn.fromValues=function(t,e,n,r,i,o,a,u,s){var l=new Hn.ARRAY_TYPE(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=r,l[4]=i,l[5]=o,l[6]=a,l[7]=u,l[8]=s,l},Xn.set=function(t,e,n,r,i,o,a,u,s,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=l,t},Xn.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Xn.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},Xn.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],h=e[8],c=h*a-u*l,f=-h*o+u*s,p=l*o-a*s,d=n*c+r*f+i*p;return d?(d=1/d,t[0]=c*d,t[1]=(-h*r+i*l)*d,t[2]=(u*r-i*a)*d,t[3]=f*d,t[4]=(h*n-i*s)*d,t[5]=(-u*n+i*o)*d,t[6]=p*d,t[7]=(-l*n+r*s)*d,t[8]=(a*n-r*o)*d,t):null},Xn.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],h=e[8];return t[0]=a*h-u*l,t[1]=i*l-r*h,t[2]=r*u-i*a,t[3]=u*s-o*h,t[4]=n*h-i*s,t[5]=i*o-n*u,t[6]=o*l-a*s,t[7]=r*s-n*l,t[8]=n*a-r*o,t},Xn.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],l=t[8];
return e*(l*o-a*s)+n*(-l*i+a*u)+r*(s*i-o*u)},Xn.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],h=e[7],c=e[8],f=n[0],p=n[1],d=n[2],v=n[3],m=n[4],g=n[5],y=n[6],x=n[7],_=n[8];return t[0]=f*r+p*a+d*l,t[1]=f*i+p*u+d*h,t[2]=f*o+p*s+d*c,t[3]=v*r+m*a+g*l,t[4]=v*i+m*u+g*h,t[5]=v*o+m*s+g*c,t[6]=y*r+x*a+_*l,t[7]=y*i+x*u+_*h,t[8]=y*o+x*s+_*c,t},Xn.mul=Xn.multiply,Xn.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],h=e[7],c=e[8],f=n[0],p=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=f*r+p*a+l,t[7]=f*i+p*u+h,t[8]=f*o+p*s+c,t},Xn.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],h=e[7],c=e[8],f=Math.sin(n),p=Math.cos(n);return t[0]=p*r+f*a,t[1]=p*i+f*u,t[2]=p*o+f*s,t[3]=p*a-f*r,t[4]=p*u-f*i,t[5]=p*s-f*o,t[6]=l,t[7]=h,t[8]=c,t},Xn.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Xn.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},Xn.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Xn.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Xn.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},Xn.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,l=n*a,h=r*a,c=r*u,f=i*a,p=i*u,d=i*s,v=o*a,m=o*u,g=o*s;return t[0]=1-c-d,t[3]=h-g,t[6]=f+m,t[1]=h+g,t[4]=1-l-d,t[7]=p-v,t[2]=f-m,t[5]=p+v,t[8]=1-l-c,t},Xn.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],h=e[8],c=e[9],f=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*a,x=n*s-i*a,_=n*l-o*a,b=r*s-i*u,M=r*l-o*u,S=i*l-o*s,F=h*v-c*d,w=h*m-f*d,D=h*g-p*d,I=c*m-f*v,A=c*g-p*v,E=f*g-p*m,R=y*E-x*A+_*I+b*D-M*w+S*F;return R?(R=1/R,t[0]=(u*E-s*A+l*I)*R,t[1]=(s*D-a*E-l*w)*R,t[2]=(a*A-u*D+l*F)*R,t[3]=(i*A-r*E-o*I)*R,t[4]=(n*E-i*D+o*w)*R,t[5]=(r*D-n*A-o*F)*R,t[6]=(v*S-m*M+g*b)*R,t[7]=(m*_-d*S-g*x)*R,t[8]=(d*M-v*_+g*y)*R,t):null},Xn.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},Xn.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},Xn.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},Xn.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},Xn.sub=Xn.subtract,Xn.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},Xn.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},Xn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},Xn.equals=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],h=t[8],c=e[0],f=e[1],p=e[2],d=e[3],v=e[4],m=e[5],g=t[6],y=e[7],x=e[8];return Math.abs(n-c)<=Hn.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-f)<=Hn.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-p)<=Hn.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-d)<=Hn.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-v)<=Hn.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-m)<=Hn.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(s-g)<=Hn.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-y)<=Hn.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(h-x)<=Hn.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))};var $n=Xn,Zn=qn,Qn={scalar:{},SIMD:{}};Qn.create=function(){var t=new Zn.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.clone=function(t){var e=new Zn.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Qn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Qn.fromValues=function(t,e,n,r,i,o,a,u,s,l,h,c,f,p,d,v){var m=new Zn.ARRAY_TYPE(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=a,m[7]=u,m[8]=s,m[9]=l,m[10]=h,m[11]=c,m[12]=f,m[13]=p,m[14]=d,m[15]=v,m},Qn.set=function(t,e,n,r,i,o,a,u,s,l,h,c,f,p,d,v,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=l,t[9]=h,t[10]=c,t[11]=f,t[12]=p,t[13]=d,t[14]=v,t[15]=m,t},Qn.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.scalar.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},Qn.SIMD.transpose=function(t,e){var n,r,i,o,a,u,s,l,h,c;return n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.shuffle(n,r,0,1,4,5),u=SIMD.Float32x4.shuffle(i,o,0,1,4,5),s=SIMD.Float32x4.shuffle(a,u,0,2,4,6),l=SIMD.Float32x4.shuffle(a,u,1,3,5,7),SIMD.Float32x4.store(t,0,s),SIMD.Float32x4.store(t,4,l),a=SIMD.Float32x4.shuffle(n,r,2,3,6,7),u=SIMD.Float32x4.shuffle(i,o,2,3,6,7),h=SIMD.Float32x4.shuffle(a,u,0,2,4,6),c=SIMD.Float32x4.shuffle(a,u,1,3,5,7),SIMD.Float32x4.store(t,8,h),SIMD.Float32x4.store(t,12,c),t},Qn.transpose=Zn.USE_SIMD?Qn.SIMD.transpose:Qn.scalar.transpose,Qn.scalar.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],h=e[8],c=e[9],f=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*a,x=n*s-i*a,_=n*l-o*a,b=r*s-i*u,M=r*l-o*u,S=i*l-o*s,F=h*v-c*d,w=h*m-f*d,D=h*g-p*d,I=c*m-f*v,A=c*g-p*v,E=f*g-p*m,R=y*E-x*A+_*I+b*D-M*w+S*F;return R?(R=1/R,t[0]=(u*E-s*A+l*I)*R,t[1]=(i*A-r*E-o*I)*R,t[2]=(v*S-m*M+g*b)*R,t[3]=(f*M-c*S-p*b)*R,t[4]=(s*D-a*E-l*w)*R,t[5]=(n*E-i*D+o*w)*R,t[6]=(m*_-d*S-g*x)*R,t[7]=(h*S-f*_+p*x)*R,t[8]=(a*A-u*D+l*F)*R,t[9]=(r*D-n*A-o*F)*R,t[10]=(d*M-v*_+g*y)*R,t[11]=(c*_-h*M-p*y)*R,t[12]=(u*w-a*I-s*F)*R,t[13]=(n*I-r*w+i*F)*R,t[14]=(v*x-d*b-m*y)*R,t[15]=(h*b-c*x+f*y)*R,t):null},Qn.SIMD.invert=function(t,e){var n,r,i,o,a,u,s,l,h,c,f=SIMD.Float32x4.load(e,0),p=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),v=SIMD.Float32x4.load(e,12);return a=SIMD.Float32x4.shuffle(f,p,0,1,4,5),r=SIMD.Float32x4.shuffle(d,v,0,1,4,5),n=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.shuffle(f,p,2,3,6,7),o=SIMD.Float32x4.shuffle(d,v,2,3,6,7),i=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.mul(r,a),s=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),u),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),a=SIMD.Float32x4.mul(r,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),h=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,a)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),u),l=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,a)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),h),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),l),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,a)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),s),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(n,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),h),c=SIMD.Float32x4.mul(n,u),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),a=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(a,a))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,s)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,h)),t):null},Qn.invert=Zn.USE_SIMD?Qn.SIMD.invert:Qn.scalar.invert,Qn.scalar.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],h=e[8],c=e[9],f=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15];return t[0]=u*(f*g-p*m)-c*(s*g-l*m)+v*(s*p-l*f),t[1]=-(r*(f*g-p*m)-c*(i*g-o*m)+v*(i*p-o*f)),t[2]=r*(s*g-l*m)-u*(i*g-o*m)+v*(i*l-o*s),t[3]=-(r*(s*p-l*f)-u*(i*p-o*f)+c*(i*l-o*s)),t[4]=-(a*(f*g-p*m)-h*(s*g-l*m)+d*(s*p-l*f)),t[5]=n*(f*g-p*m)-h*(i*g-o*m)+d*(i*p-o*f),t[6]=-(n*(s*g-l*m)-a*(i*g-o*m)+d*(i*l-o*s)),t[7]=n*(s*p-l*f)-a*(i*p-o*f)+h*(i*l-o*s),t[8]=a*(c*g-p*v)-h*(u*g-l*v)+d*(u*p-l*c),t[9]=-(n*(c*g-p*v)-h*(r*g-o*v)+d*(r*p-o*c)),t[10]=n*(u*g-l*v)-a*(r*g-o*v)+d*(r*l-o*u),t[11]=-(n*(u*p-l*c)-a*(r*p-o*c)+h*(r*l-o*u)),t[12]=-(a*(c*m-f*v)-h*(u*m-s*v)+d*(u*f-s*c)),t[13]=n*(c*m-f*v)-h*(r*m-i*v)+d*(r*f-i*c),t[14]=-(n*(u*m-s*v)-a*(r*m-i*v)+d*(r*s-i*u)),t[15]=n*(u*f-s*c)-a*(r*f-i*c)+h*(r*s-i*u),t},Qn.SIMD.adjoint=function(t,e){var n,r,i,o,a,u,s,l,h,c,f,p,d,n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return h=SIMD.Float32x4.shuffle(n,r,0,1,4,5),u=SIMD.Float32x4.shuffle(i,o,0,1,4,5),a=SIMD.Float32x4.shuffle(h,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,h,1,3,5,7),h=SIMD.Float32x4.shuffle(n,r,2,3,6,7),l=SIMD.Float32x4.shuffle(i,o,2,3,6,7),s=SIMD.Float32x4.shuffle(h,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,h,1,3,5,7),h=SIMD.Float32x4.mul(s,l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),c=SIMD.Float32x4.mul(u,h),f=SIMD.Float32x4.mul(a,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,h),c),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,h),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),h=SIMD.Float32x4.mul(u,s),h=SIMD.Float32x4.swizzle(h,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),c),d=SIMD.Float32x4.mul(a,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(l,h)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,h),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),s=SIMD.Float32x4.swizzle(s,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,h),c),p=SIMD.Float32x4.mul(a,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(s,h)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,h),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),h=SIMD.Float32x4.mul(a,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),p),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,h),d),h=SIMD.Float32x4.swizzle(h,2,3,0,1),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,h),p),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,h)),h=SIMD.Float32x4.mul(a,l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,h)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),p),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,h),f),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,h)),h=SIMD.Float32x4.mul(a,s),h=SIMD.Float32x4.swizzle(h,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,h)),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,h)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),d),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,p),SIMD.Float32x4.store(t,12,d),t},Qn.adjoint=Zn.USE_SIMD?Qn.SIMD.adjoint:Qn.scalar.adjoint,Qn.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],l=t[8],h=t[9],c=t[10],f=t[11],p=t[12],d=t[13],v=t[14],m=t[15],g=e*a-n*o,y=e*u-r*o,x=e*s-i*o,_=n*u-r*a,b=n*s-i*a,M=r*s-i*u,S=l*d-h*p,F=l*v-c*p,w=l*m-f*p,D=h*v-c*d,I=h*m-f*d,A=c*m-f*v;return g*A-y*I+x*D+_*w-b*F+M*S},Qn.SIMD.multiply=function(t,e,n){var r=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),a))));SIMD.Float32x4.store(t,0,s);var l=SIMD.Float32x4.load(n,4),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),a))));SIMD.Float32x4.store(t,4,h);var c=SIMD.Float32x4.load(n,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),a))));SIMD.Float32x4.store(t,8,f);var p=SIMD.Float32x4.load(n,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(p,3,3,3,3),a))));return SIMD.Float32x4.store(t,12,d),t},Qn.scalar.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],h=e[7],c=e[8],f=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],x=n[0],_=n[1],b=n[2],M=n[3];return t[0]=x*r+_*u+b*c+M*v,t[1]=x*i+_*s+b*f+M*m,t[2]=x*o+_*l+b*p+M*g,t[3]=x*a+_*h+b*d+M*y,x=n[4],_=n[5],b=n[6],M=n[7],t[4]=x*r+_*u+b*c+M*v,t[5]=x*i+_*s+b*f+M*m,t[6]=x*o+_*l+b*p+M*g,t[7]=x*a+_*h+b*d+M*y,x=n[8],_=n[9],b=n[10],M=n[11],t[8]=x*r+_*u+b*c+M*v,t[9]=x*i+_*s+b*f+M*m,t[10]=x*o+_*l+b*p+M*g,t[11]=x*a+_*h+b*d+M*y,x=n[12],_=n[13],b=n[14],M=n[15],t[12]=x*r+_*u+b*c+M*v,t[13]=x*i+_*s+b*f+M*m,t[14]=x*o+_*l+b*p+M*g,t[15]=x*a+_*h+b*d+M*y,t},Qn.multiply=Zn.USE_SIMD?Qn.SIMD.multiply:Qn.scalar.multiply,Qn.mul=Qn.multiply,Qn.scalar.translate=function(t,e,n){var r,i,o,a,u,s,l,h,c,f,p,d,v=n[0],m=n[1],g=n[2];return e===t?(t[12]=e[0]*v+e[4]*m+e[8]*g+e[12],t[13]=e[1]*v+e[5]*m+e[9]*g+e[13],t[14]=e[2]*v+e[6]*m+e[10]*g+e[14],t[15]=e[3]*v+e[7]*m+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],l=e[6],h=e[7],c=e[8],f=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=l,t[7]=h,t[8]=c,t[9]=f,t[10]=p,t[11]=d,t[12]=r*v+u*m+c*g+e[12],t[13]=i*v+s*m+f*g+e[13],t[14]=o*v+l*m+p*g+e[14],t[15]=a*v+h*m+d*g+e[15]),t},Qn.SIMD.translate=function(t,e,n){var r=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(u,0,0,0,0)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var s=SIMD.Float32x4.add(r,SIMD.Float32x4.add(i,SIMD.Float32x4.add(o,a)));return SIMD.Float32x4.store(t,12,s),t},Qn.translate=Zn.USE_SIMD?Qn.SIMD.translate:Qn.scalar.translate,Qn.scalar.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Qn.SIMD.scale=function(t,e,n){var r,i,o,a=SIMD.Float32x4(n[0],n[1],n[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,0,0,0,0))),i=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(a,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Qn.scale=Zn.USE_SIMD?Qn.SIMD.scale:Qn.scalar.scale,Qn.rotate=function(t,e,n,r){var i,o,a,u,s,l,h,c,f,p,d,v,m,g,y,x,_,b,M,S,F,w,D,I,A=r[0],E=r[1],R=r[2],P=Math.sqrt(A*A+E*E+R*R);return Math.abs(P)<Zn.EPSILON?null:(P=1/P,A*=P,E*=P,R*=P,i=Math.sin(n),o=Math.cos(n),a=1-o,u=e[0],s=e[1],l=e[2],h=e[3],c=e[4],f=e[5],p=e[6],d=e[7],v=e[8],m=e[9],g=e[10],y=e[11],x=A*A*a+o,_=E*A*a+R*i,b=R*A*a-E*i,M=A*E*a-R*i,S=E*E*a+o,F=R*E*a+A*i,w=A*R*a+E*i,D=E*R*a-A*i,I=R*R*a+o,t[0]=u*x+c*_+v*b,t[1]=s*x+f*_+m*b,t[2]=l*x+p*_+g*b,t[3]=h*x+d*_+y*b,t[4]=u*M+c*S+v*F,t[5]=s*M+f*S+m*F,t[6]=l*M+p*S+g*F,t[7]=h*M+d*S+y*F,t[8]=u*w+c*D+v*I,t[9]=s*w+f*D+m*I,t[10]=l*w+p*D+g*I,t[11]=h*w+d*D+y*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},Qn.scalar.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],u=e[6],s=e[7],l=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+l*r,t[5]=a*i+h*r,t[6]=u*i+c*r,t[7]=s*i+f*r,t[8]=l*i-o*r,t[9]=h*i-a*r,t[10]=c*i-u*r,t[11]=f*i-s*r,t},Qn.SIMD.rotateX=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,r))),t},Qn.rotateX=Zn.USE_SIMD?Qn.SIMD.rotateX:Qn.scalar.rotateX,Qn.scalar.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],l=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-l*r,t[1]=a*i-h*r,t[2]=u*i-c*r,t[3]=s*i-f*r,t[8]=o*r+l*i,t[9]=a*r+h*i,t[10]=u*r+c*i,t[11]=s*r+f*i,t},Qn.SIMD.rotateY=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,i))),t},Qn.rotateY=Zn.USE_SIMD?Qn.SIMD.rotateY:Qn.scalar.rotateY,Qn.scalar.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],l=e[4],h=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+l*r,t[1]=a*i+h*r,t[2]=u*i+c*r,t[3]=s*i+f*r,t[4]=l*i-o*r,t[5]=h*i-a*r,t[6]=c*i-u*r,t[7]=f*i-s*r,t},Qn.SIMD.rotateZ=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,r))),t},Qn.rotateZ=Zn.USE_SIMD?Qn.SIMD.rotateZ:Qn.scalar.rotateZ,Qn.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Qn.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.fromRotation=function(t,e,n){var r,i,o,a=n[0],u=n[1],s=n[2],l=Math.sqrt(a*a+u*u+s*s);return Math.abs(l)<Zn.EPSILON?null:(l=1/l,a*=l,u*=l,s*=l,r=Math.sin(e),i=Math.cos(e),o=1-i,t[0]=a*a*o+i,t[1]=u*a*o+s*r,t[2]=s*a*o-u*r,t[3]=0,t[4]=a*u*o-s*r,t[5]=u*u*o+i,t[6]=s*u*o+a*r,t[7]=0,t[8]=a*s*o+u*r,t[9]=u*s*o-a*r,t[10]=s*s*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},Qn.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.fromRotationTranslation=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=r+r,s=i+i,l=o+o,h=r*u,c=r*s,f=r*l,p=i*s,d=i*l,v=o*l,m=a*u,g=a*s,y=a*l;return t[0]=1-(p+v),t[1]=c+y,t[2]=f-g,t[3]=0,t[4]=c-y,t[5]=1-(h+v),t[6]=d+m,t[7]=0,t[8]=f+g,t[9]=d-m,t[10]=1-(h+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},Qn.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},Qn.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},Qn.fromRotationTranslationScale=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3],s=i+i,l=o+o,h=a+a,c=i*s,f=i*l,p=i*h,d=o*l,v=o*h,m=a*h,g=u*s,y=u*l,x=u*h,_=r[0],b=r[1],M=r[2];return t[0]=(1-(d+m))*_,t[1]=(f+x)*_,t[2]=(p-y)*_,t[3]=0,t[4]=(f-x)*b,t[5]=(1-(c+m))*b,t[6]=(v+g)*b,t[7]=0,t[8]=(p+y)*M,t[9]=(v-g)*M,t[10]=(1-(c+d))*M,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},Qn.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){var o=e[0],a=e[1],u=e[2],s=e[3],l=o+o,h=a+a,c=u+u,f=o*l,p=o*h,d=o*c,v=a*h,m=a*c,g=u*c,y=s*l,x=s*h,_=s*c,b=r[0],M=r[1],S=r[2],F=i[0],w=i[1],D=i[2];return t[0]=(1-(v+g))*b,t[1]=(p+_)*b,t[2]=(d-x)*b,t[3]=0,t[4]=(p-_)*M,t[5]=(1-(f+g))*M,t[6]=(m+y)*M,t[7]=0,t[8]=(d+x)*S,t[9]=(m-y)*S,t[10]=(1-(f+v))*S,t[11]=0,t[12]=n[0]+F-(t[0]*F+t[4]*w+t[8]*D),t[13]=n[1]+w-(t[1]*F+t[5]*w+t[9]*D),t[14]=n[2]+D-(t[2]*F+t[6]*w+t[10]*D),t[15]=1,t},Qn.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,l=n*a,h=r*a,c=r*u,f=i*a,p=i*u,d=i*s,v=o*a,m=o*u,g=o*s;return t[0]=1-c-d,t[1]=h+g,t[2]=f-m,t[3]=0,t[4]=h-g,t[5]=1-l-d,t[6]=p+v,t[7]=0,t[8]=f+m,t[9]=p-v,t[10]=1-l-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qn.frustum=function(t,e,n,r,i,o,a){var u=1/(n-e),s=1/(i-r),l=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*s,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t},Qn.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},Qn.perspectiveFromFieldOfView=function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(a+u),l=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((a-u)*s*.5),t[9]=(i-o)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},Qn.ortho=function(t,e,n,r,i,o,a){var u=1/(e-n),s=1/(r-i),l=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=(a+o)*l,t[15]=1,t},Qn.lookAt=function(t,e,n,r){var i,o,a,u,s,l,h,c,f,p,d=e[0],v=e[1],m=e[2],g=r[0],y=r[1],x=r[2],_=n[0],b=n[1],M=n[2];return Math.abs(d-_)<Zn.EPSILON&&Math.abs(v-b)<Zn.EPSILON&&Math.abs(m-M)<Zn.EPSILON?Qn.identity(t):(h=d-_,c=v-b,f=m-M,p=1/Math.sqrt(h*h+c*c+f*f),h*=p,c*=p,f*=p,i=y*f-x*c,o=x*h-g*f,a=g*c-y*h,p=Math.sqrt(i*i+o*o+a*a),p?(p=1/p,i*=p,o*=p,a*=p):(i=0,o=0,a=0),u=c*a-f*o,s=f*i-h*a,l=h*o-c*i,p=Math.sqrt(u*u+s*s+l*l),p?(p=1/p,u*=p,s*=p,l*=p):(u=0,s=0,l=0),t[0]=i,t[1]=u,t[2]=h,t[3]=0,t[4]=o,t[5]=s,t[6]=c,t[7]=0,t[8]=a,t[9]=l,t[10]=f,t[11]=0,t[12]=-(i*d+o*v+a*m),t[13]=-(u*d+s*v+l*m),t[14]=-(h*d+c*v+f*m),t[15]=1,t)},Qn.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},Qn.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},Qn.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},Qn.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},Qn.sub=Qn.subtract,Qn.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},Qn.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},Qn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},Qn.equals=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],h=t[8],c=t[9],f=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=e[0],x=e[1],_=e[2],b=e[3],M=e[4],S=e[5],F=e[6],w=e[7],D=e[8],I=e[9],A=e[10],E=e[11],R=e[12],P=e[13],C=e[14],T=e[15];return Math.abs(n-y)<=Zn.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-x)<=Zn.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-_)<=Zn.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-b)<=Zn.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-M)<=Zn.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(u-S)<=Zn.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(s-F)<=Zn.EPSILON*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(l-w)<=Zn.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(h-D)<=Zn.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(c-I)<=Zn.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(f-A)<=Zn.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(p-E)<=Zn.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(d-R)<=Zn.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(v-P)<=Zn.EPSILON*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(m-C)<=Zn.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-T)<=Zn.EPSILON*Math.max(1,Math.abs(g),Math.abs(T))};var Kn=Qn,Jn=qn,tr={};tr.create=function(){var t=new Jn.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},tr.clone=function(t){var e=new Jn.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},tr.fromValues=function(t,e,n){var r=new Jn.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r},tr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},tr.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},tr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},tr.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},tr.sub=tr.subtract,tr.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},tr.mul=tr.multiply,tr.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},tr.div=tr.divide,tr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},tr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},tr.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},tr.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},tr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},tr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},tr.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},tr.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},tr.dist=tr.distance,tr.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i},tr.sqrDist=tr.squaredDistance,tr.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},tr.len=tr.length,tr.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},tr.sqrLen=tr.squaredLength,tr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},tr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},tr.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},tr.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},tr.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2];return t[0]=i*s-o*u,t[1]=o*a-r*s,t[2]=r*u-i*a,t},tr.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t},tr.hermite=function(t,e,n,r,i,o){var a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,l=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*u+n[0]*s+r[0]*l+i[0]*h,t[1]=e[1]*u+n[1]*s+r[1]*l+i[1]*h,t[2]=e[2]*u+n[2]*s+r[2]*l+i[2]*h,t},tr.bezier=function(t,e,n,r,i,o){var a=1-o,u=a*a,s=o*o,l=u*a,h=3*o*u,c=3*s*a,f=s*o;return t[0]=e[0]*l+n[0]*h+r[0]*c+i[0]*f,t[1]=e[1]*l+n[1]*h+r[1]*c+i[1]*f,t[2]=e[2]*l+n[2]*h+r[2]*c+i[2]*f,
t},tr.random=function(t,e){e=e||1;var n=2*Jn.RANDOM()*Math.PI,r=2*Jn.RANDOM()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t},tr.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t},tr.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},tr.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2],l=n[3],h=l*r+u*o-s*i,c=l*i+s*r-a*o,f=l*o+a*i-u*r,p=-a*r-u*i-s*o;return t[0]=h*l+p*-a+c*-s-f*-u,t[1]=c*l+p*-u+f*-a-h*-s,t[2]=f*l+p*-s+h*-u-c*-a,t},tr.rotateX=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},tr.rotateY=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},tr.rotateZ=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},tr.forEach=function(){var t=tr.create();return function(e,n,r,i,o,a){var u,s;for(n||(n=3),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),tr.angle=function(t,e){var n=tr.fromValues(t[0],t[1],t[2]),r=tr.fromValues(e[0],e[1],e[2]);tr.normalize(n,n),tr.normalize(r,r);var i=tr.dot(n,r);return i>1?0:Math.acos(i)},tr.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},tr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},tr.equals=function(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],u=e[2];return Math.abs(n-o)<=Jn.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=Jn.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=Jn.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))};var er=tr,nr=qn,rr={};rr.create=function(){var t=new nr.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},rr.clone=function(t){var e=new nr.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},rr.fromValues=function(t,e,n,r){var i=new nr.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},rr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},rr.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},rr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},rr.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},rr.sub=rr.subtract,rr.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},rr.mul=rr.multiply,rr.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},rr.div=rr.divide,rr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},rr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},rr.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},rr.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},rr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},rr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},rr.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},rr.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)},rr.dist=rr.distance,rr.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o},rr.sqrDist=rr.squaredDistance,rr.length=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)},rr.len=rr.length,rr.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i},rr.sqrLen=rr.squaredLength,rr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},rr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},rr.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t},rr.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},rr.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=u+r*(n[3]-u),t},rr.random=function(t,e){return e=e||1,t[0]=nr.RANDOM(),t[1]=nr.RANDOM(),t[2]=nr.RANDOM(),t[3]=nr.RANDOM(),rr.normalize(t,t),rr.scale(t,t,e),t},rr.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t},rr.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2],l=n[3],h=l*r+u*o-s*i,c=l*i+s*r-a*o,f=l*o+a*i-u*r,p=-a*r-u*i-s*o;return t[0]=h*l+p*-a+c*-s-f*-u,t[1]=c*l+p*-u+f*-a-h*-s,t[2]=f*l+p*-s+h*-u-c*-a,t[3]=e[3],t},rr.forEach=function(){var t=rr.create();return function(e,n,r,i,o,a){var u,s;for(n||(n=4),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),rr.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},rr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},rr.equals=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],u=e[1],s=e[2],l=e[3];return Math.abs(n-a)<=nr.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=nr.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=nr.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-l)<=nr.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))};var ir=rr,or=qn,ar=$n,ur=er,sr=ir,lr={};lr.create=function(){var t=new or.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},lr.rotationTo=function(){var t=ur.create(),e=ur.fromValues(1,0,0),n=ur.fromValues(0,1,0);return function(r,i,o){var a=ur.dot(i,o);return a<-.999999?(ur.cross(t,e,i),ur.length(t)<1e-6&&ur.cross(t,n,i),ur.normalize(t,t),lr.setAxisAngle(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(ur.cross(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,lr.normalize(r,r))}}(),lr.setAxes=function(){var t=ar.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],lr.normalize(e,lr.fromMat3(e,t))}}(),lr.clone=sr.clone,lr.fromValues=sr.fromValues,lr.copy=sr.copy,lr.set=sr.set,lr.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},lr.setAxisAngle=function(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},lr.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},lr.add=sr.add,lr.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1],l=n[2],h=n[3];return t[0]=r*h+a*u+i*l-o*s,t[1]=i*h+a*s+o*u-r*l,t[2]=o*h+a*l+r*s-i*u,t[3]=a*h-r*u-i*s-o*l,t},lr.mul=lr.multiply,lr.scale=sr.scale,lr.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-r*u,t},lr.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s-o*u,t[1]=i*s+a*u,t[2]=o*s+r*u,t[3]=a*s-i*u,t},lr.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t},lr.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},lr.dot=sr.dot,lr.lerp=sr.lerp,lr.slerp=function(t,e,n,r){var i,o,a,u,s,l=e[0],h=e[1],c=e[2],f=e[3],p=n[0],d=n[1],v=n[2],m=n[3];return o=l*p+h*d+c*v+f*m,o<0&&(o=-o,p=-p,d=-d,v=-v,m=-m),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,s=Math.sin(r*i)/a):(u=1-r,s=r),t[0]=u*l+s*p,t[1]=u*h+s*d,t[2]=u*c+s*v,t[3]=u*f+s*m,t},lr.sqlerp=function(){var t=lr.create(),e=lr.create();return function(n,r,i,o,a,u){return lr.slerp(t,r,a,u),lr.slerp(e,i,o,u),lr.slerp(n,t,e,2*u*(1-u)),n}}(),lr.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=o*u,t},lr.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},lr.length=sr.length,lr.len=lr.length,lr.squaredLength=sr.squaredLength,lr.sqrLen=lr.squaredLength,lr.normalize=sr.normalize,lr.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t},lr.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},lr.exactEquals=sr.exactEquals,lr.equals=sr.equals;var hr=qn,cr={};cr.create=function(){var t=new hr.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},cr.clone=function(t){var e=new hr.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},cr.fromValues=function(t,e){var n=new hr.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},cr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},cr.set=function(t,e,n){return t[0]=e,t[1]=n,t},cr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},cr.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},cr.sub=cr.subtract,cr.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},cr.mul=cr.multiply,cr.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},cr.div=cr.divide,cr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},cr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},cr.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},cr.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},cr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},cr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},cr.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},cr.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},cr.dist=cr.distance,cr.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},cr.sqrDist=cr.squaredDistance,cr.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},cr.len=cr.length,cr.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},cr.sqrLen=cr.squaredLength,cr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},cr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},cr.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},cr.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},cr.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},cr.lerp=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t},cr.random=function(t,e){e=e||1;var n=2*hr.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},cr.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},cr.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},cr.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},cr.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},cr.forEach=function(){var t=cr.create();return function(e,n,r,i,o,a){var u,s;for(n||(n=2),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,a),e[u]=t[0],e[u+1]=t[1];return e}}(),cr.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},cr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},cr.equals=function(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=hr.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=hr.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))};var fr=Kn,pr=function(){function t(){Ee(this,t),this.serial=1,h(this,"mat4",fr.create()),Object.seal(this)}return t.prototype.identity=function(){fr.identity(this.mat4),++this.serial},t.prototype.ortho=function(t,e,n){var r=t>>1,i=e>>1,o=(n?n:Math.pow(2,14))>>1;fr.ortho(this.mat4,-r,r,-i,i,-o,o),++this.serial},t.prototype.translate=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;fr.translate(this.mat4,this.mat4,[t,e,n]),++this.serial},t.prototype.scale=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;fr.scale(this.mat4,this.mat4,[t,e,n]),++this.serial},t.prototype.rotateX=function(t){fr.rotateX(this.mat4,this.mat4,t*Math.PI/180),++this.serial},t.prototype.rotateY=function(t){fr.rotateY(this.mat4,this.mat4,t*Math.PI/180),++this.serial},t.prototype.rotateZ=function(t){fr.rotateZ(this.mat4,this.mat4,t*Math.PI/180),++this.serial},t.prototype.multiply=function(t,e){fr.multiply(this.mat4,t.mat4,e.mat4),++this.serial},t.prototype.copy=function(t){fr.copy(this.mat4,t.mat4),++this.serial},t.prototype.clone=function(){var e=new t;return e.copy(this),e},Re(t,[{key:"x",get:function(){return this.mat4[12]},set:function(t){this.mat4[12]=t,++this.serial}},{key:"y",get:function(){return this.mat4[13]},set:function(t){this.mat4[13]=t,++this.serial}},{key:"z",get:function(){return this.mat4[14]},set:function(t){this.mat4[14]=t,++this.serial}},{key:"sx",get:function(){return this.mat4[0]},set:function(t){this.mat4[0]=t,++this.serial}},{key:"sy",get:function(){return this.mat4[5]},set:function(t){this.mat4[5]=t,++this.serial}},{key:"sz",get:function(){return this.mat4[10]},set:function(t){this.mat4[10]=t,++this.serial}}]),t}(),dr=function(t){function e(n,r){Ee(this,e);var i=Wt(r),o=void 0;if(r.canvas){if(o=r.canvas,!A(o.width)||!A(o.height))throw new Error("Picimo.graph.Canvas panic: width and height of predefined canvas needs to be power of two! but is ["+o.width+", "+o.height+"]")}else o=Gt(i);var a=Vt(o,i),u=Object.assign({},r,{texture:a}),s=Ce(this,t.call(this,n,u));return Lt(s,a.image,gt(r.alpha,!0)),s.dimension=i,s.clearColor=r.clearColor,s.autoClear=r.autoClear,s.autoUpdate=r.autoUpdate,s}return Pe(e,t),e.prototype.update=function(){var t=this.webGlTexture;t&&(t.needsUpload=!0)},Re(e,[{key:"autoClear",set:function(t){this._autoClear=gt(t,!1),this._autoClear?this._clearCanvas||(this._clearCanvas=this.on("renderFrame",we.PRIO_MAX,kt.bind(this,this))):this._clearCanvas&&(this.off(this._clearCanvas),this._clearCanvas=0)},get:function(){return this._autoClear}},{key:"autoUpdate",set:function(t){this._autoUpdate=gt(t,!1),this._autoUpdate?this._updateTexture||(this._updateTexture=this.on("renderFrame",this.update.bind(this))):this._updateTexture&&(this.off(this._updateTexture),this._updateTexture=0)},get:function(){return this._autoUpdate}},{key:"webGlTexture",get:function(){return this.pipeline&&this.pipeline.webGlTexture}},{key:"alpha",get:function(){return this.ctx.getContextAttributes().alpha}}]),e}(Gn);Yt.prototype=Object.create(It.prototype),Yt.prototype.constructor=Yt,Yt.prototype.createSprite=function(t,e,n){var r=this.pool.alloc(),i="string"==typeof t?this.textureAtlas.getTexture(t):null==t?this.textureAtlas.getRandomTexture():t;if(i.setTexCoords(r),void 0===e){if(this.hasDefaultSpriteSize||!i)return r;e=i.width,n=i.height}else void 0===n&&(n=e);return r.setSize(e,n),r},Yt.prototype.createSprites=function(t){var e=t.length;if(!e||e%3)console.error("SpriteGroup.createSprites(): wrong array size: ",e,t);else for(var n=0;n<e;)this.createSprite(t[n]).setTranslate(t[n+1],t[n+2]),n+=3},Yt.prototype.setDefaultSpriteSize=function(t,e){this.defaultSpriteWidth=t||0,this.defaultSpriteHeight=e||t,Ht(this)},Object.defineProperties(Yt.prototype,{textureAtlas:{get:function(){return this._textureAtlas},set:function(t){if(this._textureAtlas=t,t instanceof on)this.ready=!0;else if(this.ready=!1,t&&t.then){var e=this;t.then(function(t){e.textureAtlas=t})}}},hasDefaultSpriteSize:{get:function(){return this.defaultSpriteWidth>0&&this.defaultSpriteHeight>0}}});var vr=function(t){t.prototype.appendSpriteGroup=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.parentNode=this,e.textureAtlas=t,Qt(new Yt(this.app,e),this,n)},t.prototype.appendPicture=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.parentNode=this,e.texture=this.app.loadTexture(t),Qt(new Gn(this.app,e),this,n)},t.prototype.appendCanvas=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.parentNode=this;var r=Object.assign({},e);return"number"==typeof t||Array.isArray(t)?r.canvasSize=t:"object"===("undefined"==typeof t?"undefined":Ae(t))&&(r.canvas=t),Qt(new dr(this.app,r),this,n)},t.prototype.appendScene=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.parentNode=this,Qt(new t(this.app,e),this,n)}},mr=function(){function t(e,n){Ee(this,t),Ze(this),p(this,{isRestorable:!!e,isUniformValueCmd:!0,restoreCmd:Object.freeze({isUniformValueRestoreCmd:!0,uid:this.uid})}),this.value=null,this.prevValue=null,void 0!==n&&this.setValue(n)}return t.prototype.getValue=function(t){return"function"==typeof this.value?this.value(t):this.value?this.value:t},t.prototype.setValue=function(t){return this.value=t,this},t}();he.prototype=Object.create(It.prototype),he.prototype.constructor=he,vr(he),Object.defineProperties(he.prototype,{scene:{get:function(){if(!this.isRootNode)for(var t=this.parentNode;t;){if("width"in t&&"height"in t&&"pixelRatio"in t&&"devicePixelRatio"in t)return t;t=t.parentNode}},enumerable:!0},blendMode:{enumerable:!0,get:function(){return this._blendMode},set:function(t){var e=null!=t?t:null;this._blendMode=e,e?(this.renderCmd.blendMode=e,this.renderPostCmd.blendMode=!1):(delete this.renderCmd.blendMode,delete this.renderPostCmd.blendMode)}}}),he.prototype.setBlendMode=function(t,e,n,r,i,o){return 0===arguments.length||null==arguments[0]?this.blendMode=void 0:1===arguments.length&&"string"==typeof arguments[0]?this.blendMode=this.app.getBlendMode(arguments[0]):this.blendMode=new Te(t,e,n,r,i,o),this.blendMode},he.prototype.setSize=function(t,e,n){var r=parseFloat(t),i=parseFloat(e);return r&&!i?i=r:i&&!r&&(r=i),(r&&i&&this._desiredWidth!==r||this._desiredHeight!==i||this.sizeFit!==n)&&(this._desiredWidth=r,this._desiredHeight=i,this._desiredPixelRatio=0,this.sizeFit=n,this.projectionNeedsUpdate=!0,le(this)),this},he.prototype.computeViewMatrix=function(t){if(t||(t=new pr),this.hasOwnProjection)t.multiply(this.projection,this.transform);else{var e=this.scene;e?t.multiply(e.computeViewMatrix(),this.transform):t.copy(this.transform)}return t};var gr=Object.freeze({Node:It,NodeState:dt,Scene:he,Picture:Gn,SpriteGroup:Yt}),yr=new RegExp("^(https?:)?//","i"),xr=new RegExp("^(https?:)?/","i"),_r=new RegExp("^(.*/)[^/]+$","i"),br=function t(e,n){Ee(this,t),we(this),this.resize=An,this.renderFrame=In,this.getAssetUrl=fe,this.joinAssetUrl=pe,this.loadTextureAtlas=de,this.loadTexture=ve,"undefined"!=typeof window&&h(this,"devicePixelRatio",window.devicePixelRatio||1),h(this,"ready",!1),this.now=window.performance.now()/1e3,"object"!==("undefined"==typeof e?"undefined":Ae(e))||"nodeName"in e?null==n&&(n={}):(n=e,e=n.canvas),je(this,e,n.appendTo),f(this,"mouseController",new Cn(this)),this.mouseController.connect(this),ze(this),f(this,"glCtxAttrs",{alpha:n.alpha===!0,antialias:n.antialias===!0}),this.glx=xn(this),this.backgroundColor=new Ie(void 0!==n.bgColor?n.bgColor:this.glCtxAttrs.alpha?"transparent":"#000000"),Oe(this),yn(this),f(this,"textureManager",new cn(this)),f(this,"renderer",new vn(this)),Dn(this),this.assetBaseUrl=window.PICIMO_ASSET_BASE_URL||n.assetBaseUrl||ce(new URL(window.location.href).origin+"/"),this.frameNo=0,h(this,"scene",new he(this,{pixelRatio:1,projection:!0,blendMode:this.getBlendMode("default")}));var r=t.emitReduce("create",this,n);return r.emit("init"),r.renderer.onInitGl(),r.resize(),this.onAnimationFrame||(this.onAnimationFrame=r.renderFrame.bind(r)),requestAnimationFrame(r.onAnimationFrame),r};we(br);var Mr="0.0.24";t.VERSION=Mr,t.App=br,t.graph=gr,t.render=gn,t.core=sn,t.defineSprite=ht,t.SpriteFactory=bn,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=picimo-min.umd.js.map
